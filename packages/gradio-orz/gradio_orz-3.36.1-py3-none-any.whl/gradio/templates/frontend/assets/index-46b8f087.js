import{S as ie,i as se,s as te,C as V,D as d,h as C,F as O,G as H,r as v,am as zt,H as F,M as J,u as we,b as L,I as U,T as Ve,ao as It,q as p,n as $,t as A,p as x,O as Bt,v as Ct,a3 as ke,af as St,ak as xe,E as Rt,N as E,K as q,R as Et,W as vt,z as Q,e as T,m as z,o as B,al as Ne,at as Dt,f as ce,a as K,l as Z,a6 as Lt,a8 as jt,a9 as Ut,aa as qt,y as Ht,ab as Ft,j as Nt,k as Wt}from"./index-4a731cdb.js";import{f as et,B as Ot}from"./DropdownArrow.svelte_svelte_type_style_lang-25b2145a.js";import{B as Mt}from"./BlockLabel-5f2d5dd2.js";import{I as We}from"./Image-8dee79e5.js";import{C as Xt,i as Yt,U as Pt,W as Jt}from"./StaticImage.svelte_svelte_type_style_lang-7c9e063d.js";import{I as Ae,C as Gt,M as Oe}from"./ModifyUpload-0662b573.js";import{U as Qt}from"./Upload-42bf873d.js";import{u as Vt,S as Kt}from"./ShareButton-792925e9.js";import{E as Zt}from"./Empty-e6410b38.js";import{D as $t}from"./Download-16f08d4f.js";import"./Blocks-0428e75b.js";import{U as xt}from"./UploadText-67097d3b.js";import{E as ml}from"./Image-5192d38d.js";import"./ModifyUpload.svelte_svelte_type_style_lang-d2acacf0.js";function en(t){let e,n,l;return{c(){e=V("svg"),n=V("path"),l=V("path"),d(n,"d","M28.828 3.172a4.094 4.094 0 0 0-5.656 0L4.05 22.292A6.954 6.954 0 0 0 2 27.242V30h2.756a6.952 6.952 0 0 0 4.95-2.05L28.828 8.829a3.999 3.999 0 0 0 0-5.657zM10.91 18.26l2.829 2.829l-2.122 2.121l-2.828-2.828zm-2.619 8.276A4.966 4.966 0 0 1 4.756 28H4v-.759a4.967 4.967 0 0 1 1.464-3.535l1.91-1.91l2.829 2.828zM27.415 7.414l-12.261 12.26l-2.829-2.828l12.262-12.26a2.047 2.047 0 0 1 2.828 0a2 2 0 0 1 0 2.828z"),d(n,"fill","currentColor"),d(l,"d","M6.5 15a3.5 3.5 0 0 1-2.475-5.974l3.5-3.5a1.502 1.502 0 0 0 0-2.121a1.537 1.537 0 0 0-2.121 0L3.415 5.394L2 3.98l1.99-1.988a3.585 3.585 0 0 1 4.95 0a3.504 3.504 0 0 1 0 4.949L5.439 10.44a1.502 1.502 0 0 0 0 2.121a1.537 1.537 0 0 0 2.122 0l4.024-4.024L13 9.95l-4.025 4.024A3.475 3.475 0 0 1 6.5 15z"),d(l,"fill","currentColor"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(r,a){C(r,e,a),O(e,n),O(e,l)},p:H,i:H,o:H,d(r){r&&v(e)}}}class tn extends ie{constructor(e){super(),se(this,e,null,en,te,{})}}function nn(t){let e,n,l,r,a,s,u;return{c(){e=V("svg"),n=V("circle"),l=V("circle"),r=V("circle"),a=V("circle"),s=V("circle"),u=V("path"),d(n,"cx","10"),d(n,"cy","12"),d(n,"r","2"),d(n,"fill","currentColor"),d(l,"cx","16"),d(l,"cy","9"),d(l,"r","2"),d(l,"fill","currentColor"),d(r,"cx","22"),d(r,"cy","12"),d(r,"r","2"),d(r,"fill","currentColor"),d(a,"cx","23"),d(a,"cy","18"),d(a,"r","2"),d(a,"fill","currentColor"),d(s,"cx","19"),d(s,"cy","23"),d(s,"r","2"),d(s,"fill","currentColor"),d(u,"fill","currentColor"),d(u,"d","M16.54 2A14 14 0 0 0 2 16a4.82 4.82 0 0 0 6.09 4.65l1.12-.31a3 3 0 0 1 3.79 2.9V27a3 3 0 0 0 3 3a14 14 0 0 0 14-14.54A14.05 14.05 0 0 0 16.54 2Zm8.11 22.31A11.93 11.93 0 0 1 16 28a1 1 0 0 1-1-1v-3.76a5 5 0 0 0-5-5a5.07 5.07 0 0 0-1.33.18l-1.12.31A2.82 2.82 0 0 1 4 16A12 12 0 0 1 16.47 4A12.18 12.18 0 0 1 28 15.53a11.89 11.89 0 0 1-3.35 8.79Z"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(i,_){C(i,e,_),O(e,n),O(e,l),O(e,r),O(e,a),O(e,s),O(e,u)},p:H,i:H,o:H,d(i){i&&v(e)}}}class ln extends ie{constructor(e){super(),se(this,e,null,nn,te,{})}}function sn(t){let e,n;return{c(){e=V("svg"),n=V("path"),d(n,"fill","currentColor"),d(n,"d","M7 27h23v2H7zm20.38-16.49l-7.93-7.92a2 2 0 0 0-2.83 0l-14 14a2 2 0 0 0 0 2.83L7.13 24h9.59l10.66-10.66a2 2 0 0 0 0-2.83zM15.89 22H8l-4-4l6.31-6.31l7.93 7.92zm3.76-3.76l-7.92-7.93L18 4l8 7.93z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(l,r){C(l,e,r),O(e,n)},p:H,i:H,o:H,d(l){l&&v(e)}}}class rn extends ie{constructor(e){super(),se(this,e,null,sn,te,{})}}function an(t){let e,n;return{c(){e=V("svg"),n=V("path"),d(n,"d","M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 24 24"),d(e,"fill","none"),d(e,"stroke","currentColor"),d(e,"stroke-width","1.5"),d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round"),d(e,"class","feather feather-edit-2")},m(l,r){C(l,e,r),O(e,n)},p:H,i:H,o:H,d(l){l&&v(e)}}}let tt=class extends ie{constructor(e){super(),se(this,e,null,an,te,{})}};const yt=t=>{let e=t.currentTarget;const n=e.getBoundingClientRect(),l=e.naturalWidth/n.width,r=e.naturalHeight/n.height;if(l>r){n.width;const u=e.naturalHeight/l,i=(n.height-u)/2;var a=Math.round((t.clientX-n.left)*l),s=Math.round((t.clientY-n.top-i)*l)}else{const u=e.naturalWidth/r;n.height;const i=(n.width-u)/2;var a=Math.round((t.clientX-n.left-i)*r),s=Math.round((t.clientY-n.top)*r)}return a<0||a>=e.naturalWidth||s<0||s>=e.naturalHeight?null:[a,s]};function un(t){let e,n;return{c(){e=F("img"),J(e.src,n=t[0])||d(e,"src",n),d(e,"alt","")},m(l,r){C(l,e,r),t[4](e)},p(l,[r]){r&1&&!J(e.src,n=l[0])&&d(e,"src",n)},i:H,o:H,d(l){l&&v(e),t[4](null)}}}function on(t,e,n){let{image:l}=e,r;const a=we();let s;function u(){s.destroy()}function i(){s&&u(),s=new Xt(r,{autoCropArea:1,cropend(){const h=s.getCroppedCanvas().toDataURL();a("crop",h)}}),a("crop",l)}function _(h){L[h?"unshift":"push"](()=>{r=h,n(1,r)})}return t.$$set=h=>{"image"in h&&n(0,l=h.image)},[l,r,u,i,_]}class Tt extends ie{constructor(e){super(),se(this,e,on,un,te,{image:0,destroy:2,create:3})}get image(){return this.$$.ctx[0]}set image(e){this.$$set({image:e}),zt()}get destroy(){return this.$$.ctx[2]}get create(){return this.$$.ctx[3]}}class nt{constructor(e,n){this.x=e,this.y=n}}class lt extends nt{update(e){this.x=e.x,this.y=e.y}moveByAngle(e,n){const l=e+Math.PI/2;this.x=this.x+Math.sin(l)*n,this.y=this.y-Math.cos(l)*n}equalsTo(e){return this.x===e.x&&this.y===e.y}getDifferenceTo(e){return new nt(this.x-e.x,this.y-e.y)}getDistanceTo(e){const n=this.getDifferenceTo(e);return Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2))}getAngleTo(e){const n=this.getDifferenceTo(e);return Math.atan2(n.y,n.x)}toObject(){return{x:this.x,y:this.y}}}const fn=30;class _n{constructor({radius:e=fn,enabled:n=!0,initialPoint:l={x:0,y:0}}={}){this.radius=e,this._isEnabled=n,this.pointer=new lt(l.x,l.y),this.brush=new lt(l.x,l.y),this.angle=0,this.distance=0,this._hasMoved=!1}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}isEnabled(){return this._isEnabled}setRadius(e){this.radius=e}getRadius(){return this.radius}getBrushCoordinates(){return this.brush.toObject()}getPointerCoordinates(){return this.pointer.toObject()}getBrush(){return this.brush}getPointer(){return this.pointer}getAngle(){return this.angle}getDistance(){return this.distance}brushHasMoved(){return this._hasMoved}update(e,{both:n=!1}={}){return this._hasMoved=!1,this.pointer.equalsTo(e)&&!n?!1:(this.pointer.update(e),n?(this._hasMoved=!0,this.brush.update(e),!0):(this._isEnabled?(this.distance=this.pointer.getDistanceTo(this.brush),this.angle=this.pointer.getAngleTo(this.brush),this.distance>this.radius&&(this.brush.moveByAngle(this.angle,this.distance-this.radius),this._hasMoved=!0)):(this.distance=0,this.angle=0,this.brush.update(e),this._hasMoved=!0),!0))}}function it(t,e,n){const l=t.slice();return l[61]=e[n].name,l[62]=e[n].zIndex,l[63]=e,l[64]=n,l}function st(t){let e,n,l;return{c(){e=F("div"),e.textContent="Start drawing",d(e,"class","start-prompt svelte-yigbas")},m(r,a){C(r,e,a),l=!0},i(r){l||(Ve(()=>{l&&(n||(n=xe(e,et,{duration:50},!0)),n.run(1))}),l=!0)},o(r){n||(n=xe(e,et,{duration:50},!1)),n.run(0),l=!1},d(r){r&&v(e),r&&n&&n.end()}}}function rt(t){let e,n=t[61],l,r;const a=()=>t[30](e,n),s=()=>t[30](null,n);return{c(){e=F("canvas"),d(e,"key",t[61]),Rt(e,"z-index",t[62]),d(e,"class","svelte-yigbas"),E(e,"lr",t[5]),E(e,"tb",!t[5])},m(u,i){C(u,e,i),a(),l||(r=[q(e,"mousedown",t[61]==="interface"?t[7]:void 0),q(e,"mousemove",t[61]==="interface"?t[8]:void 0),q(e,"mouseup",t[61]==="interface"?t[9]:void 0),q(e,"mouseout",t[61]==="interface"?t[9]:void 0),q(e,"blur",t[61]==="interface"?t[9]:void 0),q(e,"touchstart",t[61]==="interface"?t[7]:void 0),q(e,"touchmove",t[61]==="interface"?t[8]:void 0),q(e,"touchend",t[61]==="interface"?t[9]:void 0),q(e,"touchcancel",t[61]==="interface"?t[9]:void 0),q(e,"click",Et(t[29]))],l=!0)},p(u,i){t=u,n!==t[61]&&(s(),n=t[61],a()),i[0]&32&&E(e,"lr",t[5]),i[0]&32&&E(e,"tb",!t[5])},d(u){u&&v(e),s(),l=!1,vt(r)}}}function hn(t){let e,n,l,r,a=t[4]===0&&st(),s=t[6],u=[];for(let i=0;i<s.length;i+=1)u[i]=rt(it(t,s,i));return{c(){e=F("div"),a&&a.c(),n=U();for(let i=0;i<u.length;i+=1)u[i].c();d(e,"class","wrap svelte-yigbas"),Ve(()=>t[32].call(e))},m(i,_){C(i,e,_),a&&a.m(e,null),O(e,n);for(let h=0;h<u.length;h+=1)u[h]&&u[h].m(e,null);t[31](e),l=It(e,t[32].bind(e)),r=!0},p(i,_){if(i[4]===0?a?_[0]&16&&p(a,1):(a=st(),a.c(),p(a,1),a.m(e,n)):a&&($(),A(a,1,1,()=>{a=null}),x()),_[0]&993){s=i[6];let h;for(h=0;h<s.length;h+=1){const m=it(i,s,h);u[h]?u[h].p(m,_):(u[h]=rt(m),u[h].c(),u[h].m(e,null))}for(;h<u.length;h+=1)u[h].d(1);u.length=s.length}},i(i){r||(p(a),r=!0)},o(i){A(a),r=!1},d(i){i&&v(e),a&&a.d(),Bt(u,i),t[31](null),l()}}}let cn="#aaa";function at(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}}function mn(t,e,n){let l;const r=we();let{value:a}=e,{value_img:s}=e,{mode:u="sketch"}=e,{brush_color:i="#0b0f19"}=e,{brush_radius:_}=e,{source:h}=e,{width:m=400}=e,{height:o=200}=e,{container_height:f=200}=e,{shape:b}=e,I,D=m,N=o,P;const me=[{name:"interface",zIndex:15},{name:"drawing",zIndex:11},{name:"temp",zIndex:12},{name:"mask",zIndex:-1},{name:"temp_fake",zIndex:-2}];let R={},k={},j=[],X=[],re=!0,ae=!0,oe=!1,fe=!1,Y=null,ne=null,W=null,ee=0;function ue(){if(!b){k.temp.drawImage(s,0,0,m,o);return}let g=s.naturalWidth,M=s.naturalHeight;const y=b[0]/b[1],c=g/M;let S=0,G=0;y<c?(g=b[1]*c,M=b[1],S=(b[0]-g)/2):y>c?(g=b[0],M=b[0]/c,G=(b[1]-M)/2):(S=0,G=0,g=b[0],M=b[1]),k.temp.drawImage(s,S,G,g,M)}Ct(async()=>{Object.keys(R).forEach(g=>{n(26,k[g]=R[g].getContext("2d"),k)}),await ke(),s&&(s.addEventListener("load",g=>{h==="webcam"?(k.temp.save(),k.temp.translate(m,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):ue(),k.drawing.drawImage(R.temp,0,0,m,o),_e()}),setTimeout(()=>{h==="webcam"?(k.temp.save(),k.temp.translate(m,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):ue(),k.drawing.drawImage(R.temp,0,0,m,o),ge({lines:X.slice()}),_e()},100)),n(28,Y=new _n({radius:_*.05,enabled:!0,initialPoint:{x:m/2,y:o/2}})),W=new Yt((g,M,...y)=>{Re()}),W.observe(ne),Me(),n(24,I=!0),requestAnimationFrame(()=>{he(),requestAnimationFrame(()=>{be()})})});function he(){const g=m/2,M=o/2;Y.update({x:g,y:M},{both:!0}),Y.update({x:g,y:M},{both:!1}),re=!0,ae=!0}St(()=>{n(24,I=!1),W.unobserve(ne)});function le(g){He(),s&&(h==="webcam"?(k.temp.save(),k.temp.translate(m,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):ue(),(!X||!X.length)&&k.drawing.drawImage(R.temp,0,0,m,o)),ge({lines:g}),n(4,ee=g.length),n(27,X=g),k.drawing.drawImage(R.temp,0,0,m,o),u==="mask"&&k.mask.drawImage(R.temp_fake,0,0,m,o),X.length==0&&r("clear")}function Ie(){le([]),_e()}function Ce(){const g=X.slice(0,-1);le(g),_e()}let ge=({lines:g})=>{g.forEach(M=>{const{points:y,brush_color:c,brush_radius:S}=M;Le({points:y,brush_color:c,brush_radius:S}),u==="mask"&&je({points:y,brush_color:c,brush_radius:S})}),qe(),u==="mask"&&Ue()},ve=g=>{g.preventDefault(),fe=!0;const{x:M,y}=Ee(g);g.touches&&g.touches.length>0&&Y.update({x:M,y},{both:!0}),De(M,y),n(4,ee+=1)},pe=g=>{g.preventDefault();const{x:M,y}=Ee(g);De(M,y)},w=g=>{g.preventDefault(),pe(g),oe=!1,fe=!1,qe(),u==="mask"&&Ue()},Te=0,ze=0,Be=0,Se=!1,Re=async()=>{if(b&&ne){const y=ne?.getBoundingClientRect(),c=b[0]/b[1],S=y.width/y.height;n(5,Se=c<S)}if(m===Te&&o===ze&&Be===f)return;const g={width:m,height:o},M={height:f,width:f*(g.width/g.height)};await Promise.all([de(R.interface,g,M),de(R.drawing,g,M),de(R.temp,g,M),de(R.temp_fake,g,M),de(R.mask,g,M,!1)]),_||n(10,_=20*(g.width/M.width)),Me({once:!0}),setTimeout(()=>{ze=o,Te=m,Be=f},10),await ke(),be()},de=async(g,M,y,c=!0)=>{if(!I)return;await ke();const S=window.devicePixelRatio||1;g.width=M.width*(c?S:1),g.height=M.height*(c?S:1);const G=g.getContext("2d");c&&G.scale(S,S),g.style.width=`${y.width}px`,g.style.height=`${y.height}px`},Ee=g=>{const M=R.interface.getBoundingClientRect();let y=g.clientX,c=g.clientY;return g.changedTouches&&g.changedTouches.length>0&&(y=g.changedTouches[0].clientX,c=g.changedTouches[0].clientY),{x:(y-M.left)/M.width*m,y:(c-M.top)/M.height*o}},De=(g,M)=>{Y.update({x:g,y:M});const y=!Y.isEnabled();(fe&&!oe||y&&fe)&&(oe=!0,j.push(Y.brush.toObject())),oe&&(j.push(Y.brush.toObject()),Le({points:j,brush_color:i,brush_radius:_}),u==="mask"&&je({points:j,brush_color:i,brush_radius:_})),re=!0},Le=({points:g,brush_color:M,brush_radius:y})=>{if(!g||g.length<2||(n(26,k.temp.lineJoin="round",k),n(26,k.temp.lineCap="round",k),n(26,k.temp.strokeStyle=M,k),n(26,k.temp.lineWidth=y,k),!g||g.length<2))return;let c=g[0],S=g[1];k.temp.moveTo(S.x,S.y),k.temp.beginPath();for(var G=1,Qe=g.length;G<Qe;G++){var ye=at(c,S);k.temp.quadraticCurveTo(c.x,c.y,ye.x,ye.y),c=g[G],S=g[G+1]}k.temp.lineTo(c.x,c.y),k.temp.stroke()},je=({points:g,brush_color:M,brush_radius:y})=>{if(!g||g.length<2)return;n(26,k.temp_fake.lineJoin="round",k),n(26,k.temp_fake.lineCap="round",k),n(26,k.temp_fake.strokeStyle="#fff",k),n(26,k.temp_fake.lineWidth=y,k);let c=g[0],S=g[1];k.temp_fake.moveTo(S.x,S.y),k.temp_fake.beginPath();for(var G=1,Qe=g.length;G<Qe;G++){var ye=at(c,S);k.temp_fake.quadraticCurveTo(c.x,c.y,ye.x,ye.y),c=g[G],S=g[G+1]}k.temp_fake.lineTo(c.x,c.y),k.temp_fake.stroke()},Ue=()=>{j.length<1||(j.length=0,k.mask.drawImage(R.temp_fake,0,0,m,o),_e())},qe=()=>{j.length<1||(X.push({points:j.slice(),brush_color:i,brush_radius:_}),u!=="mask"&&(j.length=0),k.drawing.drawImage(R.temp,0,0,m,o),_e())},_e=()=>{const g=Fe();r("change",g)};function be(){return n(27,X=[]),He(),n(4,ee=0),!0}function He(){ae=!0,k.temp.clearRect(0,0,m,o),n(26,k.temp.fillStyle=u==="mask"?"transparent":"#FFFFFF",k),k.temp.fillRect(0,0,m,o),u==="mask"&&(k.temp_fake.clearRect(0,0,R.temp_fake.width,R.temp_fake.height),k.mask.clearRect(0,0,m,o),n(26,k.mask.fillStyle="#000",k),k.mask.fillRect(0,0,m,o))}let Me=({once:g=!1}={})=>{if(re||ae){const M=Y.getPointerCoordinates(),y=Y.getBrushCoordinates();Xe(k.interface,M,y),re=!1,ae=!1}g||window.requestAnimationFrame(()=>{Me()})},Xe=(g,M,y)=>{g.clearRect(0,0,m,o),g.beginPath(),g.fillStyle=i,g.arc(y.x,y.y,_/2,0,Math.PI*2,!0),g.fill(),g.beginPath(),g.fillStyle=cn,g.arc(y.x,y.y,l,0,Math.PI*2,!0),g.fill()};function Fe(){return u==="mask"?R.mask.toDataURL("image/jpg"):R.drawing.toDataURL("image/jpg")}function Ye(g){Q.call(this,t,g)}function Pe(g,M){L[g?"unshift":"push"](()=>{R[M]=g,n(0,R)})}function Je(g){L[g?"unshift":"push"](()=>{ne=g,n(3,ne)})}function Ge(){D=this.offsetWidth,N=this.offsetHeight,n(1,D),n(2,N)}return t.$$set=g=>{"value"in g&&n(13,a=g.value),"value_img"in g&&n(14,s=g.value_img),"mode"in g&&n(15,u=g.mode),"brush_color"in g&&n(16,i=g.brush_color),"brush_radius"in g&&n(10,_=g.brush_radius),"source"in g&&n(17,h=g.source),"width"in g&&n(11,m=g.width),"height"in g&&n(12,o=g.height),"container_height"in g&&n(18,f=g.container_height),"shape"in g&&n(19,b=g.shape)},t.$$.update=()=>{t.$$.dirty[0]&530432&&b&&(m||o)&&(n(11,m=b[0]),n(12,o=b[1])),t.$$.dirty[0]&16785408&&I&&!a&&be(),t.$$.dirty[0]&251811841&&I&&s!==P&&(n(25,P=s),be(),setTimeout(()=>{h==="webcam"?(k.temp.save(),k.temp.translate(m,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):ue(),k.drawing.drawImage(R.temp,0,0,m,o),ge({lines:X.slice()}),_e()},50)),t.$$.dirty[0]&268436480&&Y&&(he(),Y.setRadius(_*.05)),t.$$.dirty[0]&6144&&(m||o)&&Re(),t.$$.dirty[0]&1024&&(l=_*.075)},[R,D,N,ne,ee,Se,me,ve,pe,w,_,m,o,a,s,u,i,h,f,b,Ie,Ce,be,Fe,I,P,k,X,Y,Ye,Pe,Je,Ge]}class Ke extends ie{constructor(e){super(),se(this,e,mn,hn,te,{value:13,value_img:14,mode:15,brush_color:16,brush_radius:10,source:17,width:11,height:12,container_height:18,shape:19,clear_mask:20,undo:21,clear:22,get_image_data:23},null,[-1,-1,-1])}get clear_mask(){return this.$$.ctx[20]}get undo(){return this.$$.ctx[21]}get clear(){return this.$$.ctx[22]}get get_image_data(){return this.$$.ctx[23]}}function ut(t){let e,n;return e=new Ae({props:{Icon:rn,label:"Clear"}}),e.$on("click",t[3]),{c(){T(e.$$.fragment)},m(l,r){z(e,l,r),n=!0},p:H,i(l){n||(p(e.$$.fragment,l),n=!0)},o(l){A(e.$$.fragment,l),n=!1},d(l){B(e,l)}}}function gn(t){let e,n,l,r,a,s;n=new Ae({props:{Icon:Pt,label:"Undo"}}),n.$on("click",t[2]);let u=t[0]&&ut(t);return a=new Ae({props:{Icon:Gt,label:"Remove Image"}}),a.$on("click",t[4]),{c(){e=F("div"),T(n.$$.fragment),l=U(),u&&u.c(),r=U(),T(a.$$.fragment),d(e,"class","svelte-s6ybro")},m(i,_){C(i,e,_),z(n,e,null),O(e,l),u&&u.m(e,null),O(e,r),z(a,e,null),s=!0},p(i,[_]){i[0]?u?(u.p(i,_),_&1&&p(u,1)):(u=ut(i),u.c(),p(u,1),u.m(e,r)):u&&($(),A(u,1,1,()=>{u=null}),x())},i(i){s||(p(n.$$.fragment,i),p(u),p(a.$$.fragment,i),s=!0)},o(i){A(n.$$.fragment,i),A(u),A(a.$$.fragment,i),s=!1},d(i){i&&v(e),B(n),u&&u.d(),B(a)}}}function dn(t,e,n){const l=we();let{show_eraser:r=!1}=e;const a=()=>l("undo"),s=i=>{l("clear_mask"),i.stopPropagation()},u=i=>{l("remove_image"),i.stopPropagation()};return t.$$set=i=>{"show_eraser"in i&&n(0,r=i.show_eraser)},[r,l,a,s,u]}class Ze extends ie{constructor(e){super(),se(this,e,dn,gn,te,{show_eraser:0})}}function ot(t){let e,n,l,r,a;return{c(){e=F("input"),d(e,"aria-label","Brush radius"),d(e,"type","range"),d(e,"min",n=.5*(t[2]/t[6])),d(e,"max",l=75*(t[2]/t[6])),d(e,"class","svelte-p4aq0j")},m(s,u){C(s,e,u),Ne(e,t[0]),r||(a=[q(e,"change",t[10]),q(e,"input",t[10])],r=!0)},p(s,u){u&68&&n!==(n=.5*(s[2]/s[6]))&&d(e,"min",n),u&68&&l!==(l=75*(s[2]/s[6]))&&d(e,"max",l),u&1&&Ne(e,s[0])},d(s){s&&v(e),r=!1,vt(a)}}}function ft(t){let e,n,l,r;n=new Ae({props:{Icon:ln,label:"Select brush color"}}),n.$on("click",t[11]);let a=t[5]&&_t(t);return{c(){e=F("span"),T(n.$$.fragment),l=U(),a&&a.c(),d(e,"class","col svelte-p4aq0j")},m(s,u){C(s,e,u),z(n,e,null),O(e,l),a&&a.m(e,null),r=!0},p(s,u){s[5]?a?a.p(s,u):(a=_t(s),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},i(s){r||(p(n.$$.fragment,s),r=!0)},o(s){A(n.$$.fragment,s),r=!1},d(s){s&&v(e),B(n),a&&a.d()}}}function _t(t){let e,n,l;return{c(){e=F("input"),d(e,"aria-label","Brush color"),d(e,"type","color"),d(e,"class","svelte-p4aq0j")},m(r,a){C(r,e,a),Ne(e,t[1]),n||(l=q(e,"input",t[12]),n=!0)},p(r,a){a&2&&Ne(e,r[1])},d(r){r&&v(e),n=!1,l()}}}function bn(t){let e,n,l,r,a,s;l=new Ae({props:{Icon:tn,label:"Use brush"}}),l.$on("click",t[9]);let u=t[4]&&ot(t),i=t[3]!=="mask"&&ft(t);return{c(){e=F("div"),n=F("span"),T(l.$$.fragment),r=U(),u&&u.c(),a=U(),i&&i.c(),d(n,"class","brush svelte-p4aq0j"),d(e,"class","wrap svelte-p4aq0j")},m(_,h){C(_,e,h),O(e,n),z(l,n,null),O(n,r),u&&u.m(n,null),O(e,a),i&&i.m(e,null),s=!0},p(_,[h]){_[4]?u?u.p(_,h):(u=ot(_),u.c(),u.m(n,null)):u&&(u.d(1),u=null),_[3]!=="mask"?i?(i.p(_,h),h&8&&p(i,1)):(i=ft(_),i.c(),p(i,1),i.m(e,null)):i&&($(),A(i,1,1,()=>{i=null}),x())},i(_){s||(p(l.$$.fragment,_),p(i),s=!0)},o(_){A(l.$$.fragment,_),A(i),s=!1},d(_){_&&v(e),B(l),u&&u.d(),i&&i.d()}}}function kn(t,e,n){let l;we();let r=!1,a=!1,{brush_radius:s=20}=e,{brush_color:u="#000"}=e,{container_height:i}=e,{img_width:_}=e,{img_height:h}=e,{mode:m="other"}=e;const o=()=>n(4,r=!r);function f(){s=Dt(this.value),n(0,s)}const b=()=>n(5,a=!a);function I(){u=this.value,n(1,u)}return t.$$set=D=>{"brush_radius"in D&&n(0,s=D.brush_radius),"brush_color"in D&&n(1,u=D.brush_color),"container_height"in D&&n(7,i=D.container_height),"img_width"in D&&n(2,_=D.img_width),"img_height"in D&&n(8,h=D.img_height),"mode"in D&&n(3,m=D.mode)},t.$$.update=()=>{t.$$.dirty&388&&n(6,l=i*(_/h))},[s,u,_,m,r,a,l,i,h,o,f,b,I]}class $e extends ie{constructor(e){super(),se(this,e,kn,bn,te,{brush_radius:0,brush_color:1,container_height:7,img_width:2,img_height:8,mode:3})}}function wn(t){let e,n,l,r;return{c(){e=F("img"),J(e.src,n=t[0].image||t[0])||d(e,"src",n),d(e,"alt",""),d(e,"class","svelte-p3y7hu"),E(e,"webcam",t[5]==="webcam"&&t[9]),E(e,"selectable",t[10])},m(a,s){C(a,e,s),l||(r=q(e,"click",t[29]),l=!0)},p(a,s){s[0]&1&&!J(e.src,n=a[0].image||a[0])&&d(e,"src",n),s[0]&544&&E(e,"webcam",a[5]==="webcam"&&a[9]),s[0]&1024&&E(e,"selectable",a[10])},i:H,o:H,d(a){a&&v(e),l=!1,r()}}}function pn(t){let e=t[21],n,l,r,a=ht(t),s=t[16]>0&&ct(t);return{c(){a.c(),n=U(),s&&s.c(),l=ce()},m(u,i){a.m(u,i),C(u,n,i),s&&s.m(u,i),C(u,l,i),r=!0},p(u,i){i[0]&2097152&&te(e,e=u[21])?(a.d(1),a=ht(u),a.c(),a.m(n.parentNode,n)):a.p(u,i),u[16]>0?s?(s.p(u,i),i[0]&65536&&p(s,1)):(s=ct(u),s.c(),p(s,1),s.m(l.parentNode,l)):s&&($(),A(s,1,1,()=>{s=null}),x())},i(u){r||(p(s),r=!0)},o(u){A(s),r=!1},d(u){a.d(u),u&&v(n),s&&s.d(u),u&&v(l)}}}function An(t){let e,n,l,r,a,s,u;return e=new Oe({props:{editable:!0}}),e.$on("edit",t[52]),e.$on("clear",t[24]),{c(){T(e.$$.fragment),n=U(),l=F("img"),J(l.src,r=t[0])||d(l,"src",r),d(l,"alt",""),d(l,"class","svelte-p3y7hu"),E(l,"selectable",t[10]),E(l,"webcam",t[5]==="webcam"&&t[9])},m(i,_){z(e,i,_),C(i,n,_),C(i,l,_),a=!0,s||(u=q(l,"click",t[29]),s=!0)},p(i,_){(!a||_[0]&1&&!J(l.src,r=i[0]))&&d(l,"src",r),(!a||_[0]&1024)&&E(l,"selectable",i[10]),(!a||_[0]&544)&&E(l,"webcam",i[5]==="webcam"&&i[9])},i(i){a||(p(e.$$.fragment,i),a=!0)},o(i){A(e.$$.fragment,i),a=!1},d(i){B(e,i),i&&v(n),i&&v(l),s=!1,u()}}}function In(t){let e,n,l,r,a={image:t[0]};return e=new Tt({props:a}),t[50](e),e.$on("crop",t[25]),l=new Oe({}),l.$on("clear",t[51]),{c(){T(e.$$.fragment),n=U(),T(l.$$.fragment)},m(s,u){z(e,s,u),C(s,n,u),z(l,s,u),r=!0},p(s,u){const i={};u[0]&1&&(i.image=s[0]),e.$set(i)},i(s){r||(p(e.$$.fragment,s),p(l.$$.fragment,s),r=!0)},o(s){A(e.$$.fragment,s),A(l.$$.fragment,s),r=!1},d(s){t[50](null),B(e,s),s&&v(n),B(l,s)}}}function Cn(t){let e,n,l=t[5]==="webcam"&&!t[21]&&gt(t);return{c(){l&&l.c(),e=ce()},m(r,a){l&&l.m(r,a),C(r,e,a),n=!0},p(r,a){r[5]==="webcam"&&!r[21]?l?(l.p(r,a),a[0]&2097184&&p(l,1)):(l=gt(r),l.c(),p(l,1),l.m(e.parentNode,e)):l&&($(),A(l,1,1,()=>{l=null}),x())},i(r){n||(p(l),n=!0)},o(r){A(l),n=!1},d(r){l&&l.d(r),r&&v(e)}}}function vn(t){let e,n,l,r,a,s,u;e=new Ze({}),e.$on("undo",t[42]),e.$on("remove_image",t[27]);let i=t[1]==="color-sketch"&&dt(t);function _(o){t[45](o)}function h(o){t[46](o)}let m={value:t[0],mode:t[13],width:t[16]||t[20],height:t[15]||t[19],container_height:t[17]||t[19],shape:t[6]};return t[2]!==void 0&&(m.brush_radius=t[2]),t[22]!==void 0&&(m.brush_color=t[22]),r=new Ke({props:m}),L.push(()=>K(r,"brush_radius",_)),L.push(()=>K(r,"brush_color",h)),t[47](r),r.$on("change",t[25]),r.$on("clear",t[27]),{c(){T(e.$$.fragment),n=U(),i&&i.c(),l=U(),T(r.$$.fragment)},m(o,f){z(e,o,f),C(o,n,f),i&&i.m(o,f),C(o,l,f),z(r,o,f),u=!0},p(o,f){o[1]==="color-sketch"?i?(i.p(o,f),f[0]&2&&p(i,1)):(i=dt(o),i.c(),p(i,1),i.m(l.parentNode,l)):i&&($(),A(i,1,1,()=>{i=null}),x());const b={};f[0]&1&&(b.value=o[0]),f[0]&8192&&(b.mode=o[13]),f[0]&1114112&&(b.width=o[16]||o[20]),f[0]&557056&&(b.height=o[15]||o[19]),f[0]&655360&&(b.container_height=o[17]||o[19]),f[0]&64&&(b.shape=o[6]),!a&&f[0]&4&&(a=!0,b.brush_radius=o[2],Z(()=>a=!1)),!s&&f[0]&4194304&&(s=!0,b.brush_color=o[22],Z(()=>s=!1)),r.$set(b)},i(o){u||(p(e.$$.fragment,o),p(i),p(r.$$.fragment,o),u=!0)},o(o){A(e.$$.fragment,o),A(i),A(r.$$.fragment,o),u=!1},d(o){B(e,o),o&&v(n),i&&i.d(o),o&&v(l),t[47](null),B(r,o)}}}function Mn(t){let e,n,l;function r(s){t[41](s)}let a={filetype:"image/*",include_file_metadata:!1,disable_click:!!t[0],$$slots:{default:[Rn]},$$scope:{ctx:t}};return t[12]!==void 0&&(a.dragging=t[12]),e=new Qt({props:a}),L.push(()=>K(e,"dragging",r)),e.$on("load",t[23]),{c(){T(e.$$.fragment)},m(s,u){z(e,s,u),l=!0},p(s,u){const i={};u[0]&1&&(i.disable_click=!!s[0]),u[0]&8384231|u[1]&1073741824&&(i.$$scope={dirty:u,ctx:s}),!n&&u[0]&4096&&(n=!0,i.dragging=s[12],Z(()=>n=!1)),e.$set(i)},i(s){l||(p(e.$$.fragment,s),l=!0)},o(s){A(e.$$.fragment,s),l=!1},d(s){B(e,s)}}}function ht(t){let e,n,l,r;return{c(){e=F("img"),d(e,"class","absolute-img svelte-p3y7hu"),J(e.src,n=t[21]||t[0]?.image||t[0])||d(e,"src",n),d(e,"alt",""),E(e,"webcam",t[5]==="webcam"&&t[9])},m(a,s){C(a,e,s),t[53](e),l||(r=q(e,"load",t[26]),l=!0)},p(a,s){s[0]&2097153&&!J(e.src,n=a[21]||a[0]?.image||a[0])&&d(e,"src",n),s[0]&544&&E(e,"webcam",a[5]==="webcam"&&a[9])},d(a){a&&v(e),t[53](null),l=!1,r()}}}function ct(t){let e,n,l,r,a,s,u,i;function _(f){t[55](f)}function h(f){t[56](f)}let m={value:t[0],mode:t[13],width:t[16]||t[20],height:t[15]||t[19],container_height:t[17]||t[19],value_img:t[18],source:t[5]};t[2]!==void 0&&(m.brush_radius=t[2]),t[22]!==void 0&&(m.brush_color=t[22]),e=new Ke({props:m}),t[54](e),L.push(()=>K(e,"brush_radius",_)),L.push(()=>K(e,"brush_color",h)),e.$on("change",t[25]),a=new Ze({}),a.$on("undo",t[57]),a.$on("remove_image",t[27]);let o=(t[1]==="color-sketch"||t[1]==="sketch")&&mt(t);return{c(){T(e.$$.fragment),r=U(),T(a.$$.fragment),s=U(),o&&o.c(),u=ce()},m(f,b){z(e,f,b),C(f,r,b),z(a,f,b),C(f,s,b),o&&o.m(f,b),C(f,u,b),i=!0},p(f,b){const I={};b[0]&1&&(I.value=f[0]),b[0]&8192&&(I.mode=f[13]),b[0]&1114112&&(I.width=f[16]||f[20]),b[0]&557056&&(I.height=f[15]||f[19]),b[0]&655360&&(I.container_height=f[17]||f[19]),b[0]&262144&&(I.value_img=f[18]),b[0]&32&&(I.source=f[5]),!n&&b[0]&4&&(n=!0,I.brush_radius=f[2],Z(()=>n=!1)),!l&&b[0]&4194304&&(l=!0,I.brush_color=f[22],Z(()=>l=!1)),e.$set(I),f[1]==="color-sketch"||f[1]==="sketch"?o?(o.p(f,b),b[0]&2&&p(o,1)):(o=mt(f),o.c(),p(o,1),o.m(u.parentNode,u)):o&&($(),A(o,1,1,()=>{o=null}),x())},i(f){i||(p(e.$$.fragment,f),p(a.$$.fragment,f),p(o),i=!0)},o(f){A(e.$$.fragment,f),A(a.$$.fragment,f),A(o),i=!1},d(f){t[54](null),B(e,f),f&&v(r),B(a,f),f&&v(s),o&&o.d(f),f&&v(u)}}}function mt(t){let e,n,l,r;function a(i){t[58](i)}function s(i){t[59](i)}let u={container_height:t[17]||t[19],img_width:t[16]||t[20],img_height:t[15]||t[19],mode:t[13]};return t[2]!==void 0&&(u.brush_radius=t[2]),t[22]!==void 0&&(u.brush_color=t[22]),e=new $e({props:u}),L.push(()=>K(e,"brush_radius",a)),L.push(()=>K(e,"brush_color",s)),{c(){T(e.$$.fragment)},m(i,_){z(e,i,_),r=!0},p(i,_){const h={};_[0]&655360&&(h.container_height=i[17]||i[19]),_[0]&1114112&&(h.img_width=i[16]||i[20]),_[0]&557056&&(h.img_height=i[15]||i[19]),_[0]&8192&&(h.mode=i[13]),!n&&_[0]&4&&(n=!0,h.brush_radius=i[2],Z(()=>n=!1)),!l&&_[0]&4194304&&(l=!0,h.brush_color=i[22],Z(()=>l=!1)),e.$set(h)},i(i){r||(p(e.$$.fragment,i),r=!0)},o(i){A(e.$$.fragment,i),r=!1},d(i){B(e,i)}}}function gt(t){let e,n;return e=new Jt({props:{streaming:t[7],pending:t[8],mirror_webcam:t[9]}}),e.$on("capture",t[48]),e.$on("stream",t[25]),e.$on("error",t[49]),{c(){T(e.$$.fragment)},m(l,r){z(e,l,r),n=!0},p(l,r){const a={};r[0]&128&&(a.streaming=l[7]),r[0]&256&&(a.pending=l[8]),r[0]&512&&(a.mirror_webcam=l[9]),e.$set(a)},i(l){n||(p(e.$$.fragment,l),n=!0)},o(l){A(e.$$.fragment,l),n=!1},d(l){B(e,l)}}}function dt(t){let e,n,l,r;function a(i){t[43](i)}function s(i){t[44](i)}let u={container_height:t[17]||t[19],img_width:t[16]||t[20],img_height:t[15]||t[19]};return t[2]!==void 0&&(u.brush_radius=t[2]),t[22]!==void 0&&(u.brush_color=t[22]),e=new $e({props:u}),L.push(()=>K(e,"brush_radius",a)),L.push(()=>K(e,"brush_color",s)),{c(){T(e.$$.fragment)},m(i,_){z(e,i,_),r=!0},p(i,_){const h={};_[0]&655360&&(h.container_height=i[17]||i[19]),_[0]&1114112&&(h.img_width=i[16]||i[20]),_[0]&557056&&(h.img_height=i[15]||i[19]),!n&&_[0]&4&&(n=!0,h.brush_radius=i[2],Z(()=>n=!1)),!l&&_[0]&4194304&&(l=!0,h.brush_color=i[22],Z(()=>l=!1)),e.$set(h)},i(i){r||(p(e.$$.fragment,i),r=!0)},o(i){A(e.$$.fragment,i),r=!1},d(i){B(e,i)}}}function yn(t){let e,n,l,r;return{c(){e=F("img"),J(e.src,n=t[0].image||t[0])||d(e,"src",n),d(e,"alt","hello"),d(e,"class","svelte-p3y7hu"),E(e,"webcam",t[5]==="webcam"&&t[9]),E(e,"selectable",t[10])},m(a,s){C(a,e,s),l||(r=q(e,"click",t[29]),l=!0)},p(a,s){s[0]&1&&!J(e.src,n=a[0].image||a[0])&&d(e,"src",n),s[0]&544&&E(e,"webcam",a[5]==="webcam"&&a[9]),s[0]&1024&&E(e,"selectable",a[10])},i:H,o:H,d(a){a&&v(e),l=!1,r()}}}function Tn(t){let e=t[21],n,l,r,a=bt(t),s=t[16]>0&&kt(t);return{c(){a.c(),n=U(),s&&s.c(),l=ce()},m(u,i){a.m(u,i),C(u,n,i),s&&s.m(u,i),C(u,l,i),r=!0},p(u,i){i[0]&2097152&&te(e,e=u[21])?(a.d(1),a=bt(u),a.c(),a.m(n.parentNode,n)):a.p(u,i),u[16]>0?s?(s.p(u,i),i[0]&65536&&p(s,1)):(s=kt(u),s.c(),p(s,1),s.m(l.parentNode,l)):s&&($(),A(s,1,1,()=>{s=null}),x())},i(u){r||(p(s),r=!0)},o(u){A(s),r=!1},d(u){a.d(u),u&&v(n),s&&s.d(u),u&&v(l)}}}function zn(t){let e,n,l,r,a,s,u;return e=new Oe({props:{editable:!0}}),e.$on("edit",t[33]),e.$on("clear",t[24]),{c(){T(e.$$.fragment),n=U(),l=F("img"),J(l.src,r=t[0])||d(l,"src",r),d(l,"alt",""),d(l,"class","svelte-p3y7hu"),E(l,"scale-x-[-1]",t[5]==="webcam"&&t[9]),E(l,"selectable",t[10])},m(i,_){z(e,i,_),C(i,n,_),C(i,l,_),a=!0,s||(u=q(l,"click",t[29]),s=!0)},p(i,_){(!a||_[0]&1&&!J(l.src,r=i[0]))&&d(l,"src",r),(!a||_[0]&544)&&E(l,"scale-x-[-1]",i[5]==="webcam"&&i[9]),(!a||_[0]&1024)&&E(l,"selectable",i[10])},i(i){a||(p(e.$$.fragment,i),a=!0)},o(i){A(e.$$.fragment,i),a=!1},d(i){B(e,i),i&&v(n),i&&v(l),s=!1,u()}}}function Bn(t){let e,n,l,r,a={image:t[0]};return e=new Tt({props:a}),t[31](e),e.$on("crop",t[25]),l=new Oe({}),l.$on("clear",t[32]),{c(){T(e.$$.fragment),n=U(),T(l.$$.fragment)},m(s,u){z(e,s,u),C(s,n,u),z(l,s,u),r=!0},p(s,u){const i={};u[0]&1&&(i.image=s[0]),e.$set(i)},i(s){r||(p(e.$$.fragment,s),p(l.$$.fragment,s),r=!0)},o(s){A(e.$$.fragment,s),A(l.$$.fragment,s),r=!1},d(s){t[31](null),B(e,s),s&&v(n),B(l,s)}}}function Sn(t){let e;const n=t[30].default,l=Lt(n,t,t[61],null);return{c(){l&&l.c()},m(r,a){l&&l.m(r,a),e=!0},p(r,a){l&&l.p&&(!e||a[1]&1073741824)&&jt(l,n,r,r[61],e?qt(n,r[61],a,null):Ut(r[61]),null)},i(r){e||(p(l,r),e=!0)},o(r){A(l,r),e=!1},d(r){l&&l.d(r)}}}function bt(t){let e,n,l,r;return{c(){e=F("img"),d(e,"class","absolute-img svelte-p3y7hu"),J(e.src,n=t[21]||t[0]?.image||t[0])||d(e,"src",n),d(e,"alt",""),E(e,"webcam",t[5]==="webcam"&&t[9])},m(a,s){C(a,e,s),t[34](e),l||(r=q(e,"load",t[26]),l=!0)},p(a,s){s[0]&2097153&&!J(e.src,n=a[21]||a[0]?.image||a[0])&&d(e,"src",n),s[0]&544&&E(e,"webcam",a[5]==="webcam"&&a[9])},d(a){a&&v(e),t[34](null),l=!1,r()}}}function kt(t){let e,n,l,r,a,s,u,i;function _(f){t[36](f)}function h(f){t[37](f)}let m={value:t[0],mode:t[13],width:t[16]||t[20],height:t[15]||t[19],container_height:t[17]||t[19],value_img:t[18],source:t[5],shape:t[6]};t[2]!==void 0&&(m.brush_radius=t[2]),t[22]!==void 0&&(m.brush_color=t[22]),e=new Ke({props:m}),t[35](e),L.push(()=>K(e,"brush_radius",_)),L.push(()=>K(e,"brush_color",h)),e.$on("change",t[25]),a=new Ze({props:{show_eraser:t[18]}}),a.$on("undo",t[38]),a.$on("clear_mask",t[28]),a.$on("remove_image",t[27]);let o=(t[1]==="color-sketch"||t[1]==="sketch")&&wt(t);return{c(){T(e.$$.fragment),r=U(),T(a.$$.fragment),s=U(),o&&o.c(),u=ce()},m(f,b){z(e,f,b),C(f,r,b),z(a,f,b),C(f,s,b),o&&o.m(f,b),C(f,u,b),i=!0},p(f,b){const I={};b[0]&1&&(I.value=f[0]),b[0]&8192&&(I.mode=f[13]),b[0]&1114112&&(I.width=f[16]||f[20]),b[0]&557056&&(I.height=f[15]||f[19]),b[0]&655360&&(I.container_height=f[17]||f[19]),b[0]&262144&&(I.value_img=f[18]),b[0]&32&&(I.source=f[5]),b[0]&64&&(I.shape=f[6]),!n&&b[0]&4&&(n=!0,I.brush_radius=f[2],Z(()=>n=!1)),!l&&b[0]&4194304&&(l=!0,I.brush_color=f[22],Z(()=>l=!1)),e.$set(I);const D={};b[0]&262144&&(D.show_eraser=f[18]),a.$set(D),f[1]==="color-sketch"||f[1]==="sketch"?o?(o.p(f,b),b[0]&2&&p(o,1)):(o=wt(f),o.c(),p(o,1),o.m(u.parentNode,u)):o&&($(),A(o,1,1,()=>{o=null}),x())},i(f){i||(p(e.$$.fragment,f),p(a.$$.fragment,f),p(o),i=!0)},o(f){A(e.$$.fragment,f),A(a.$$.fragment,f),A(o),i=!1},d(f){t[35](null),B(e,f),f&&v(r),B(a,f),f&&v(s),o&&o.d(f),f&&v(u)}}}function wt(t){let e,n,l,r;function a(i){t[39](i)}function s(i){t[40](i)}let u={container_height:t[17]||t[19],img_width:t[16]||t[20],img_height:t[15]||t[19],mode:t[13]};return t[2]!==void 0&&(u.brush_radius=t[2]),t[22]!==void 0&&(u.brush_color=t[22]),e=new $e({props:u}),L.push(()=>K(e,"brush_radius",a)),L.push(()=>K(e,"brush_color",s)),{c(){T(e.$$.fragment)},m(i,_){z(e,i,_),r=!0},p(i,_){const h={};_[0]&655360&&(h.container_height=i[17]||i[19]),_[0]&1114112&&(h.img_width=i[16]||i[20]),_[0]&557056&&(h.img_height=i[15]||i[19]),_[0]&8192&&(h.mode=i[13]),!n&&_[0]&4&&(n=!0,h.brush_radius=i[2],Z(()=>n=!1)),!l&&_[0]&4194304&&(l=!0,h.brush_color=i[22],Z(()=>l=!1)),e.$set(h)},i(i){r||(p(e.$$.fragment,i),r=!0)},o(i){A(e.$$.fragment,i),r=!1},d(i){B(e,i)}}}function Rn(t){let e,n,l,r;const a=[Sn,Bn,zn,Tn,yn],s=[];function u(i,_){return i[0]===null&&!i[21]||i[7]?0:i[1]==="select"?1:i[1]==="editor"?2:(i[1]==="sketch"||i[1]==="color-sketch")&&(i[0]!==null||i[21])?3:4}return e=u(t),n=s[e]=a[e](t),{c(){n.c(),l=ce()},m(i,_){s[e].m(i,_),C(i,l,_),r=!0},p(i,_){let h=e;e=u(i),e===h?s[e].p(i,_):($(),A(s[h],1,1,()=>{s[h]=null}),x(),n=s[e],n?n.p(i,_):(n=s[e]=a[e](i),n.c()),p(n,1),n.m(l.parentNode,l))},i(i){r||(p(n),r=!0)},o(i){A(n),r=!1},d(i){s[e].d(i),i&&v(l)}}}function En(t){let e,n,l,r,a,s,u;e=new Mt({props:{show_label:t[4],Icon:t[5]==="canvas"?tt:We,label:t[3]||(t[5]==="canvas"?"Sketch":"Image")}});const i=[Mn,vn,Cn,In,An,pn,wn],_=[];function h(m,o){return m[5]==="upload"?0:m[5]==="canvas"?1:m[0]===null&&!m[21]||m[7]?2:m[1]==="select"?3:m[1]==="editor"?4:(m[1]==="sketch"||m[1]==="color-sketch")&&(m[0]!==null||m[21])?5:6}return r=h(t),a=_[r]=i[r](t),{c(){T(e.$$.fragment),n=U(),l=F("div"),a.c(),d(l,"data-testid","image"),d(l,"class","image-container svelte-p3y7hu"),Ve(()=>t[60].call(l))},m(m,o){z(e,m,o),C(m,n,o),C(m,l,o),_[r].m(l,null),s=It(l,t[60].bind(l)),u=!0},p(m,o){const f={};o[0]&16&&(f.show_label=m[4]),o[0]&32&&(f.Icon=m[5]==="canvas"?tt:We),o[0]&40&&(f.label=m[3]||(m[5]==="canvas"?"Sketch":"Image")),e.$set(f);let b=r;r=h(m),r===b?_[r].p(m,o):($(),A(_[b],1,1,()=>{_[b]=null}),x(),a=_[r],a?a.p(m,o):(a=_[r]=i[r](m),a.c()),p(a,1),a.m(l,null))},i(m){u||(p(e.$$.fragment,m),p(a),u=!0)},o(m){A(e.$$.fragment,m),A(a),u=!1},d(m){B(e,m),m&&v(n),m&&v(l),_[r].d(),s()}}}function Dn(t,e,n){let l,{$$slots:r={},$$scope:a}=e,{value:s}=e,{label:u=void 0}=e,{show_label:i}=e,{source:_="upload"}=e,{tool:h="editor"}=e,{shape:m}=e,{streaming:o=!1}=e,{pending:f=!1}=e,{mirror_webcam:b}=e,{brush_radius:I}=e,{selectable:D=!1}=e,N,P;s&&(_==="upload"||_==="webcam")&&h==="sketch"&&(s={image:s,mask:null});function me({detail:c}){h==="color-sketch"?n(21,le=c):n(0,s=(_==="upload"||_==="webcam")&&h==="sketch"?{image:c,mask:null}:c),j("upload",c)}function R({detail:c}){n(0,s=null),n(21,le=void 0),j("clear")}async function k({detail:c},S){W==="mask"?_==="webcam"&&S?n(0,s={image:c,mask:null}):n(0,s={image:typeof s=="string"?s:s?.image||null,mask:c}):(_==="upload"||_==="webcam")&&h==="sketch"?n(0,s={image:c,mask:null}):n(0,s=c),await ke(),j(o?"stream":"edit")}const j=we();let X=!1;function re(c){const S=c.currentTarget;n(16,Y=S.naturalWidth),n(15,fe=S.naturalHeight),n(17,ne=S.getBoundingClientRect().height)}async function ae(){N.clear(),await ke(),n(0,s=null),n(21,le=void 0)}async function oe(){N.clear_mask(),await ke()}let fe=0,Y=0,ne=0,W,ee,ue,he,le;Ct(async()=>{h==="color-sketch"&&s&&typeof s=="string"&&(n(21,le=s),await ke(),re({currentTarget:ee}))});const Ie=c=>{let S=yt(c);S&&j("select",{index:S,value:null})};function Ce(c){L[c?"unshift":"push"](()=>{P=c,n(11,P),n(0,s)})}const ge=c=>(R(c),n(1,h="editor")),ve=()=>n(1,h="select");function pe(c){L[c?"unshift":"push"](()=>{ee=c,n(18,ee)})}function w(c){L[c?"unshift":"push"](()=>{N=c,n(14,N)})}function Te(c){I=c,n(2,I)}function ze(c){l=c,n(22,l),n(13,W),n(5,_),n(1,h)}const Be=()=>N.undo();function Se(c){I=c,n(2,I)}function Re(c){l=c,n(22,l),n(13,W),n(5,_),n(1,h)}function de(c){X=c,n(12,X)}const Ee=()=>N.undo();function De(c){I=c,n(2,I)}function Le(c){l=c,n(22,l),n(13,W),n(5,_),n(1,h)}function je(c){I=c,n(2,I)}function Ue(c){l=c,n(22,l),n(13,W),n(5,_),n(1,h)}function qe(c){L[c?"unshift":"push"](()=>{N=c,n(14,N)})}const _e=c=>h==="color-sketch"?me(c):k(c,!0);function be(c){Q.call(this,t,c)}function He(c){L[c?"unshift":"push"](()=>{P=c,n(11,P),n(0,s)})}const Me=c=>(R(c),n(1,h="editor")),Xe=()=>n(1,h="select");function Fe(c){L[c?"unshift":"push"](()=>{ee=c,n(18,ee)})}function Ye(c){L[c?"unshift":"push"](()=>{N=c,n(14,N)})}function Pe(c){I=c,n(2,I)}function Je(c){l=c,n(22,l),n(13,W),n(5,_),n(1,h)}const Ge=()=>N.undo();function g(c){I=c,n(2,I)}function M(c){l=c,n(22,l),n(13,W),n(5,_),n(1,h)}function y(){ue=this.offsetHeight,he=this.offsetWidth,n(19,ue),n(20,he)}return t.$$set=c=>{"value"in c&&n(0,s=c.value),"label"in c&&n(3,u=c.label),"show_label"in c&&n(4,i=c.show_label),"source"in c&&n(5,_=c.source),"tool"in c&&n(1,h=c.tool),"shape"in c&&n(6,m=c.shape),"streaming"in c&&n(7,o=c.streaming),"pending"in c&&n(8,f=c.pending),"mirror_webcam"in c&&n(9,b=c.mirror_webcam),"brush_radius"in c&&n(2,I=c.brush_radius),"selectable"in c&&n(10,D=c.selectable),"$$scope"in c&&n(61,a=c.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1&&j("change",s),t.$$.dirty[0]&4096&&j("drag",X),t.$$.dirty[0]&34&&(_==="canvas"&&h==="sketch"?n(13,W="bw-sketch"):h==="color-sketch"?n(13,W="color-sketch"):(_==="upload"||_==="webcam")&&h==="sketch"?n(13,W="mask"):n(13,W="editor")),t.$$.dirty[0]&8192&&n(22,l=W=="mask"?"#000000":"#000"),t.$$.dirty[0]&1&&(s===null||s.image===null&&s.mask===null)&&n(21,le=void 0),t.$$.dirty[0]&2049&&P&&(s?(n(11,P.image=s,P),P.create()):P.destroy())},[s,h,I,u,i,_,m,o,f,b,D,P,X,W,N,fe,Y,ne,ee,ue,he,le,l,me,R,k,re,ae,oe,Ie,r,Ce,ge,ve,pe,w,Te,ze,Be,Se,Re,de,Ee,De,Le,je,Ue,qe,_e,be,He,Me,Xe,Fe,Ye,Pe,Je,Ge,g,M,y,a]}let Ln=class extends ie{constructor(e){super(),se(this,e,Dn,En,te,{value:0,label:3,show_label:4,source:5,tool:1,shape:6,streaming:7,pending:8,mirror_webcam:9,brush_radius:2,selectable:10},null,[-1,-1,-1])}};function jn(t){let e,n,l,r,a,s,u,i,_,h;l=new Ae({props:{Icon:$t,label:"Download"}});let m=t[4]&&pt(t);return{c(){e=F("div"),n=F("a"),T(l.$$.fragment),r=U(),m&&m.c(),a=U(),s=F("img"),d(n,"href",t[0]),d(n,"target",window.__is_colab__?"_blank":null),d(n,"download","image"),d(e,"class","icon-buttons svelte-1btp92j"),J(s.src,u=t[0])||d(s,"src",u),d(s,"alt",""),d(s,"class","svelte-1btp92j"),E(s,"selectable",t[3])},m(o,f){C(o,e,f),O(e,n),z(l,n,null),O(e,r),m&&m.m(e,null),C(o,a,f),C(o,s,f),i=!0,_||(h=q(s,"click",t[5]),_=!0)},p(o,f){(!i||f&1)&&d(n,"href",o[0]),o[4]?m?(m.p(o,f),f&16&&p(m,1)):(m=pt(o),m.c(),p(m,1),m.m(e,null)):m&&($(),A(m,1,1,()=>{m=null}),x()),(!i||f&1&&!J(s.src,u=o[0]))&&d(s,"src",u),(!i||f&8)&&E(s,"selectable",o[3])},i(o){i||(p(l.$$.fragment,o),p(m),i=!0)},o(o){A(l.$$.fragment,o),A(m),i=!1},d(o){o&&v(e),B(l),m&&m.d(),o&&v(a),o&&v(s),_=!1,h()}}}function Un(t){let e,n;return e=new Zt({props:{unpadded_box:!0,size:"large",$$slots:{default:[qn]},$$scope:{ctx:t}}}),{c(){T(e.$$.fragment)},m(l,r){z(e,l,r),n=!0},p(l,r){const a={};r&1024&&(a.$$scope={dirty:r,ctx:l}),e.$set(a)},i(l){n||(p(e.$$.fragment,l),n=!0)},o(l){A(e.$$.fragment,l),n=!1},d(l){B(e,l)}}}function pt(t){let e,n;return e=new Kt({props:{formatter:t[6],value:t[0]}}),e.$on("share",t[7]),e.$on("error",t[8]),{c(){T(e.$$.fragment)},m(l,r){z(e,l,r),n=!0},p(l,r){const a={};r&1&&(a.value=l[0]),e.$set(a)},i(l){n||(p(e.$$.fragment,l),n=!0)},o(l){A(e.$$.fragment,l),n=!1},d(l){B(e,l)}}}function qn(t){let e,n;return e=new We({}),{c(){T(e.$$.fragment)},m(l,r){z(e,l,r),n=!0},i(l){n||(p(e.$$.fragment,l),n=!0)},o(l){A(e.$$.fragment,l),n=!1},d(l){B(e,l)}}}function Hn(t){let e,n,l,r,a,s;e=new Mt({props:{show_label:t[2],Icon:We,label:t[1]||"Image"}});const u=[Un,jn],i=[];function _(h,m){return h[0]===null?0:1}return l=_(t),r=i[l]=u[l](t),{c(){T(e.$$.fragment),n=U(),r.c(),a=ce()},m(h,m){z(e,h,m),C(h,n,m),i[l].m(h,m),C(h,a,m),s=!0},p(h,[m]){const o={};m&4&&(o.show_label=h[2]),m&2&&(o.label=h[1]||"Image"),e.$set(o);let f=l;l=_(h),l===f?i[l].p(h,m):($(),A(i[f],1,1,()=>{i[f]=null}),x(),r=i[l],r?r.p(h,m):(r=i[l]=u[l](h),r.c()),p(r,1),r.m(a.parentNode,a))},i(h){s||(p(e.$$.fragment,h),p(r),s=!0)},o(h){A(e.$$.fragment,h),A(r),s=!1},d(h){B(e,h),h&&v(n),i[l].d(h),h&&v(a)}}}function Fn(t,e,n){let{value:l}=e,{label:r=void 0}=e,{show_label:a}=e,{selectable:s=!1}=e,{show_share_button:u=!1}=e;const i=we(),_=f=>{let b=yt(f);b&&i("select",{index:b,value:null})},h=async f=>f?`<img src="${await Vt(f,"base64")}" />`:"";function m(f){Q.call(this,t,f)}function o(f){Q.call(this,t,f)}return t.$$set=f=>{"value"in f&&n(0,l=f.value),"label"in f&&n(1,r=f.label),"show_label"in f&&n(2,a=f.show_label),"selectable"in f&&n(3,s=f.selectable),"show_share_button"in f&&n(4,u=f.show_share_button)},t.$$.update=()=>{t.$$.dirty&1&&l&&i("change",l)},[l,r,a,s,u,_,h,m,o]}class Nn extends ie{constructor(e){super(),se(this,e,Fn,Hn,te,{value:0,label:1,show_label:2,selectable:3,show_share_button:4})}}function Wn(t){let e,n,l;function r(s){t[27](s)}let a={brush_radius:t[15],shape:t[14],source:t[5],tool:t[6],selectable:t[16],label:t[7],show_label:t[8],pending:t[10],streaming:t[9],mirror_webcam:t[13],$$slots:{default:[Xn]},$$scope:{ctx:t}};return t[0]!==void 0&&(a.value=t[0]),e=new Ln({props:a}),L.push(()=>K(e,"value",r)),e.$on("edit",t[28]),e.$on("clear",t[29]),e.$on("change",t[30]),e.$on("stream",t[31]),e.$on("drag",t[32]),e.$on("upload",t[33]),e.$on("select",t[34]),e.$on("share",t[35]),e.$on("error",t[36]),{c(){T(e.$$.fragment)},m(s,u){z(e,s,u),l=!0},p(s,u){const i={};u[0]&32768&&(i.brush_radius=s[15]),u[0]&16384&&(i.shape=s[14]),u[0]&32&&(i.source=s[5]),u[0]&64&&(i.tool=s[6]),u[0]&65536&&(i.selectable=s[16]),u[0]&128&&(i.label=s[7]),u[0]&256&&(i.show_label=s[8]),u[0]&1024&&(i.pending=s[10]),u[0]&512&&(i.streaming=s[9]),u[0]&8192&&(i.mirror_webcam=s[13]),u[1]&64&&(i.$$scope={dirty:u,ctx:s}),!n&&u[0]&1&&(n=!0,i.value=s[0],Z(()=>n=!1)),e.$set(i)},i(s){l||(p(e.$$.fragment,s),l=!0)},o(s){A(e.$$.fragment,s),l=!1},d(s){B(e,s)}}}function On(t){let e,n;return e=new Nn({props:{value:t[0],label:t[7],show_label:t[8],selectable:t[16],show_share_button:t[21]}}),e.$on("select",t[24]),e.$on("share",t[25]),e.$on("error",t[26]),{c(){T(e.$$.fragment)},m(l,r){z(e,l,r),n=!0},p(l,r){const a={};r[0]&1&&(a.value=l[0]),r[0]&128&&(a.label=l[7]),r[0]&256&&(a.show_label=l[8]),r[0]&65536&&(a.selectable=l[16]),r[0]&2097152&&(a.show_share_button=l[21]),e.$set(a)},i(l){n||(p(e.$$.fragment,l),n=!0)},o(l){A(e.$$.fragment,l),n=!1},d(l){B(e,l)}}}function Xn(t){let e,n;return e=new xt({props:{type:"image"}}),{c(){T(e.$$.fragment)},m(l,r){z(e,l,r),n=!0},p:H,i(l){n||(p(e.$$.fragment,l),n=!0)},o(l){A(e.$$.fragment,l),n=!1},d(l){B(e,l)}}}function Yn(t){let e,n,l,r,a,s;const u=[t[1]];let i={};for(let o=0;o<u.length;o+=1)i=Ht(i,u[o]);e=new Ft({props:i});const _=[On,Wn],h=[];function m(o,f){return o[20]==="static"?0:1}return l=m(t),r=h[l]=_[l](t),{c(){T(e.$$.fragment),n=U(),r.c(),a=ce()},m(o,f){z(e,o,f),C(o,n,f),h[l].m(o,f),C(o,a,f),s=!0},p(o,f){const b=f[0]&2?Nt(u,[Wt(o[1])]):{};e.$set(b);let I=l;l=m(o),l===I?h[l].p(o,f):($(),A(h[I],1,1,()=>{h[I]=null}),x(),r=h[l],r?r.p(o,f):(r=h[l]=_[l](o),r.c()),p(r,1),r.m(a.parentNode,a))},i(o){s||(p(e.$$.fragment,o),p(r),s=!0)},o(o){A(e.$$.fragment,o),A(r),s=!1},d(o){B(e,o),o&&v(n),h[l].d(o),o&&v(a)}}}function Pn(t){let e,n;return e=new Ot({props:{visible:t[4],variant:t[20]==="dynamic"&&t[0]===null&&t[5]==="upload"?"dashed":"solid",border_mode:t[22]?"focus":"base",padding:!1,elem_id:t[2],elem_classes:t[3],height:t[11]||(t[5]==="webcam"||t[20]==="static"?void 0:At),width:t[12],allow_overflow:!1,container:t[17],scale:t[18],min_width:t[19],$$slots:{default:[Yn]},$$scope:{ctx:t}}}),{c(){T(e.$$.fragment)},m(l,r){z(e,l,r),n=!0},p(l,r){const a={};r[0]&16&&(a.visible=l[4]),r[0]&1048609&&(a.variant=l[20]==="dynamic"&&l[0]===null&&l[5]==="upload"?"dashed":"solid"),r[0]&4194304&&(a.border_mode=l[22]?"focus":"base"),r[0]&4&&(a.elem_id=l[2]),r[0]&8&&(a.elem_classes=l[3]),r[0]&1050656&&(a.height=l[11]||(l[5]==="webcam"||l[20]==="static"?void 0:At)),r[0]&4096&&(a.width=l[12]),r[0]&131072&&(a.container=l[17]),r[0]&262144&&(a.scale=l[18]),r[0]&524288&&(a.min_width=l[19]),r[0]&7464931|r[1]&64&&(a.$$scope={dirty:r,ctx:l}),e.$set(a)},i(l){n||(p(e.$$.fragment,l),n=!0)},o(l){A(e.$$.fragment,l),n=!1},d(l){B(e,l)}}}const At=240;function Jn(t,e,n){let{elem_id:l=""}=e,{elem_classes:r=[]}=e,{visible:a=!0}=e,{value:s=null}=e,{source:u="upload"}=e,{tool:i="editor"}=e,{label:_}=e,{show_label:h}=e,{streaming:m}=e,{pending:o}=e,{height:f}=e,{width:b}=e,{mirror_webcam:I}=e,{shape:D}=e,{brush_radius:N}=e,{selectable:P=!1}=e,{container:me=!1}=e,{scale:R=null}=e,{min_width:k=void 0}=e,{loading_status:j}=e,{mode:X}=e,{show_share_button:re=!1}=e;const ae=we();let oe;function fe(w){Q.call(this,t,w)}function Y(w){Q.call(this,t,w)}function ne(w){Q.call(this,t,w)}function W(w){s=w,n(0,s)}function ee(w){Q.call(this,t,w)}function ue(w){Q.call(this,t,w)}function he(w){Q.call(this,t,w)}function le(w){Q.call(this,t,w)}const Ie=({detail:w})=>n(22,oe=w);function Ce(w){Q.call(this,t,w)}function ge(w){Q.call(this,t,w)}function ve(w){Q.call(this,t,w)}const pe=({detail:w})=>{n(1,j=j||{}),n(1,j.status="error",j),ae("error",w)};return t.$$set=w=>{"elem_id"in w&&n(2,l=w.elem_id),"elem_classes"in w&&n(3,r=w.elem_classes),"visible"in w&&n(4,a=w.visible),"value"in w&&n(0,s=w.value),"source"in w&&n(5,u=w.source),"tool"in w&&n(6,i=w.tool),"label"in w&&n(7,_=w.label),"show_label"in w&&n(8,h=w.show_label),"streaming"in w&&n(9,m=w.streaming),"pending"in w&&n(10,o=w.pending),"height"in w&&n(11,f=w.height),"width"in w&&n(12,b=w.width),"mirror_webcam"in w&&n(13,I=w.mirror_webcam),"shape"in w&&n(14,D=w.shape),"brush_radius"in w&&n(15,N=w.brush_radius),"selectable"in w&&n(16,P=w.selectable),"container"in w&&n(17,me=w.container),"scale"in w&&n(18,R=w.scale),"min_width"in w&&n(19,k=w.min_width),"loading_status"in w&&n(1,j=w.loading_status),"mode"in w&&n(20,X=w.mode),"show_share_button"in w&&n(21,re=w.show_share_button)},t.$$.update=()=>{t.$$.dirty[0]&1&&n(0,s=s||null),t.$$.dirty[0]&1&&ae("change")},[s,j,l,r,a,u,i,_,h,m,o,f,b,I,D,N,P,me,R,k,X,re,oe,ae,fe,Y,ne,W,ee,ue,he,le,Ie,Ce,ge,ve,pe]}class Gn extends ie{constructor(e){super(),se(this,e,Jn,Pn,te,{elem_id:2,elem_classes:3,visible:4,value:0,source:5,tool:6,label:7,show_label:8,streaming:9,pending:10,height:11,width:12,mirror_webcam:13,shape:14,brush_radius:15,selectable:16,container:17,scale:18,min_width:19,loading_status:1,mode:20,show_share_button:21},null,[-1,-1])}}const ol=Gn,fl=["static","dynamic"],_l=t=>({type:{payload:"string"},description:{payload:"image data as base64 string"},example_data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg=="});export{ol as Component,ml as ExampleComponent,_l as document,fl as modes};
//# sourceMappingURL=index-46b8f087.js.map
