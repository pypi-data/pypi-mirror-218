"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_organizationMembers_organizationMemberDetail_tsx"],{"./app/components/radio.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});var o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),n=s("./app/styles/animations.tsx");const a=(0,o.Z)("input",{target:"e72tocb0"})("display:flex;padding:0;width:",(e=>"small"===e.radioSize?"1rem":"1.5rem"),";height:",(e=>"small"===e.radioSize?"1rem":"1.5rem"),";position:relative;border-radius:50%;align-items:center;justify-content:center;border:1px solid ",(e=>e.theme.border),";box-shadow:inset ",(e=>e.theme.dropShadowMedium),";background:none;appearance:none;transition:border 0.1s,box-shadow 0.1s;margin:0!important;&:focus,&.focus-visible{outline:none;border-color:",(e=>e.theme.focusBorder),";box-shadow:",(e=>e.theme.focusBorder)," 0 0 0 1px;}&:checked:after{content:'';",(e=>((e,t)=>(0,i.iv)("display:block;width:","small"===e.radioSize?"0.5rem":"0.875rem",";height:","small"===e.radioSize?"0.5rem":"0.875rem",";border-radius:50%;background-color:",t.active,";animation:0.2s ",n.kQ," ease;opacity:",e.disabled?.4:null,";",""))(e,e.theme)),";}");a.defaultProps={type:"radio"};const r=a},"./app/components/roleSelectControl.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});var o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=s("./app/components/forms/controls/selectControl.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){let{roles:t,disableUnallowed:s,...o}=e;return(0,n.tZ)(i.Z,{options:t?.map((e=>({value:e.id,label:e.name,disabled:s&&!e.allowed||e.isRetired,details:(0,n.tZ)(l,{children:e.desc})}))),showDividers:!0,...o})}a.displayName="RoleSelectControl";const r=a,l=(0,o.Z)("span",{target:"eu9y8de0"})({name:"vad6xm",styles:"display:inline-block;width:20rem"})},"./app/components/teamRoleSelect.tsx":(e,t,s)=>{s.d(t,{Z:()=>m});var o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/es.array.push.js"),s("./app/components/roleSelectControl.tsx")),n=s("./app/styles/space.tsx"),a=s("./app/utils/orgRole.tsx"),r=s("./app/views/settings/organizationTeams/roleOverwriteWarning.tsx"),l=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){let{organization:t,team:s,member:o,onChangeTeamRole:n,disabled:d,size:m}=e;const{orgRoleList:h,teamRoleList:u,features:g}=t;if(!g.includes("team-roles"))return null;const b=[o.orgRole];o.groupOrgRoles&&o.groupOrgRoles.length>0&&b.push(o.groupOrgRoles[0].role.id),s.orgRole&&b.push(s.orgRole);const R=(0,a.M)(b,h);if((0,r.d8)({orgRole:R?.id,orgRoleList:h,teamRoleList:u})){const e=u.find((e=>e.id===R?.minimumTeamRole));return(0,l.BX)(c,{children:[e?.name||R?.minimumTeamRole,(0,l.tZ)(p,{children:(0,l.tZ)(r.Sk,{orgRole:R?.id,orgRoleList:h,teamRoleList:u})})]})}const f=o.teamRole||o.teamRoles?.find((e=>e.teamSlug===s.slug))?.role||null,x=u.find((e=>e.id===f))||u[0];return(0,l.tZ)(i.Z,{disabled:d,disableUnallowed:!1,roles:u,value:x.id,onChange:e=>n(e.value),size:m})}d.displayName="TeamRoleSelect";const m=d,c=(0,o.Z)("div",{target:"ermz4er1"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),p=(0,o.Z)("div",{target:"ermz4er0"})("height:",(0,n.D)(2),";margin-left:",(0,n.D)(1),";")},"./app/utils/isMemberDisabledFromLimit.tsx":(e,t,s)=>{function o(e){return e?.flags["member-limit:restricted"]??!1}s.d(t,{Z:()=>o})},"./app/utils/orgRole.tsx":(e,t,s)=>{function o(e,t){const s=t.reduce(((e,t,s)=>(e[t.id]={index:s,role:t},e)),{});return e.sort(((e,t)=>s[t].index-s[e].index)),s[e[0]]?.role}s.d(t,{M:()=>o})},"./app/views/settings/organizationMembers/organizationMemberDetail.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>de});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),a=s("../node_modules/@sentry/core/esm/exports.js"),r=s("../node_modules/lodash/isEqual.js"),l=s.n(r),d=s("./app/actionCreators/account.tsx"),m=s("./app/actionCreators/indicator.tsx"),c=s("./app/actionCreators/members.tsx"),p=s("./app/components/button.tsx"),h=s("./app/components/buttonBar.tsx"),u=s("./app/components/confirm.tsx"),g=s("./app/components/dateTime.tsx"),b=s("./app/components/errors/notFound.tsx"),R=s("./app/components/forms/fieldGroup/index.tsx"),f=s("./app/components/hookOrDefault.tsx"),x=s("./app/components/links/externalLink.tsx"),Z=s("./app/components/panels/index.tsx"),v=s("./app/components/textCopyInput.tsx"),w=s("./app/components/tooltip.tsx"),y=s("./app/icons/index.tsx"),S=s("./app/locale.tsx"),T=s("./app/styles/space.tsx"),z=s("./app/utils/isMemberDisabledFromLimit.tsx"),C=s("./app/utils/teams.tsx"),j=s("./app/utils/withDomainRequired.tsx"),k=s("./app/utils/withOrganization.tsx"),B=s("./app/views/asyncView.tsx"),_=s("./app/views/settings/components/settingsPageHeader.tsx"),L=(s("../node_modules/core-js/modules/es.regexp.flags.js"),s("../node_modules/lodash/startCase.js")),I=s.n(L),O=s("./app/components/emptyMessage.tsx"),N=s("./app/components/idBadge/teamBadge/index.tsx"),D=s("./app/components/links/link.tsx"),X=s("./app/components/loadingIndicator.tsx"),M=s("./app/components/teamRoleSelect.tsx"),A=s("./app/utils/orgRole.tsx"),F=s("./app/utils/useTeams.tsx"),P=s("./app/views/settings/organizationTeams/roleOverwriteWarning.tsx"),E=s("./app/views/settings/organizationTeams/utils.tsx"),$=s("./app/views/settings/components/teamSelect/utils.tsx"),q=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function U(e){let{disabled:t,loadingTeams:s,member:o,selectedOrgRole:i,selectedTeamRoles:a,organization:r,onAddTeam:l,onRemoveTeam:d,onCreateTeam:m,onChangeTeamRole:c}=e;const{teams:p,onSearch:h,fetching:u}=(0,F.y)(),{orgRoleList:g,teamRoleList:b}=r,R=new Set(a.map((e=>e.teamSlug))),f=p.filter((e=>R.has(e.slug))),x=f.filter((e=>e.orgRole)).map((e=>e.orgRole));i&&x.push(i);const v=(0,A.M)(x,g);return(0,q.BX)(Z.s_,{children:[(0,q.BX)(Z.V9,{hasButtons:!0,children:[(0,S.t)("Team"),(0,q.tZ)($.w,{disabled:t,isLoadingTeams:u,isAddingTeamToMember:!0,canCreateTeam:!1,onSearch:h,onSelect:l,onCreateTeam:m,organization:r,selectedTeams:f.map((e=>e.slug)),teams:p})]}),(0,q.tZ)(Z.N,{children:s?(0,q.tZ)(X.Z,{}):0===f.length?(0,q.tZ)(O.Z,{children:(0,S.t)("No Teams assigned")}):(0,q.BX)(n.Fragment,{children:[r.features.includes("team-roles")&&v&&(0,q.tZ)(P.pu,{orgRole:v?.id,orgRoleList:g,teamRoleList:b}),f.map((e=>(0,q.tZ)(V,{disabled:t,organization:r,team:e,member:{...o,groupOrgRoles:[{role:v,teamSlug:""}],orgRole:i,teamRoles:a},onChangeTeamRole:c,onRemoveTeam:e=>d(e)},e.slug)))]})})]})}function V(e){let{disabled:t,organization:s,team:o,member:i,onRemoveTeam:n,onChangeTeamRole:a}=e;const r=s.access.includes("org:admin"),l=o.flags["idp:provisioned"],d=null!==o.orgRole&&!r,m=t||l||d,c=(0,E.m)(l,d),h=o.orgRole?`${I()(o.orgRole)} Team`:null;return(0,q.BX)(G,{"data-test-id":"team-row-for-member",children:[(0,q.tZ)(J,{children:(0,q.tZ)(D.Z,{to:`/settings/${s.slug}/teams/${o.slug}/`,children:(0,q.tZ)(N.a,{team:o})})}),(0,q.tZ)(W,{children:h}),s.features.includes("team-roles")&&(0,q.tZ)(H,{children:(0,q.tZ)(M.Z,{disabled:t,size:"xs",organization:s,team:o,member:i,onChangeTeamRole:e=>a(o.slug,e)})}),(0,q.tZ)(p.zx,{size:"xs",icon:(0,q.tZ)(y.JZ,{isCircled:!0,size:"xs"}),title:c,disabled:m,onClick:()=>n(o.slug),children:(0,S.t)("Remove")})]})}U.displayName="TeamSelect",V.displayName="TeamRow";const G=(0,i.Z)(Z.Lv,{target:"e21fr73"})("padding:",(0,T.D)(2),";align-items:center;justify-content:space-between;"),J=(0,i.Z)("div",{target:"e21fr72"})({name:"aco78w",styles:"flex-grow:4"}),W=(0,i.Z)("div",{target:"e21fr71"})({name:"1k42tn9",styles:"min-width:90px;flex-grow:1;display:flex;justify-content:center"}),H=(0,i.Z)("div",{target:"e21fr70"})("min-width:200px;margin-right:",(0,T.D)(2),";"),K=U;var Y=s("./app/components/radio.tsx"),Q=s("./app/views/settings/components/text/textBlock.tsx");const ee=(0,i.Z)("label",{target:"e1vdkxph0"})({name:"ddvan8",styles:"display:flex;flex:1;align-items:center;margin-bottom:0"});class te extends n.Component{render(){const{disabled:e,enforceRetired:t,enforceAllowed:s,roleList:o,roleSelected:i,setSelected:n}=this.props;return(0,q.BX)(Z.s_,{children:[(0,q.tZ)(Z.V9,{children:(0,q.tZ)("div",{children:(0,S.t)("Organization Role")})}),(0,q.tZ)(Z.N,{children:o.map((o=>{const{desc:a,name:r,id:l,allowed:d,isRetired:m}=o,c=e||t&&m||s&&!d;return(0,q.tZ)(Z.Lv,{onClick:()=>!c&&n(l),css:c?{color:"grey",cursor:"default"}:{},children:(0,q.BX)(ee,{children:[(0,q.tZ)(Y.Z,{id:l,value:r,checked:l===i,readOnly:!0}),(0,q.BX)("div",{style:{flex:1,padding:"0 16px"},children:[r,(0,q.tZ)(Q.Z,{noMargin:!0,children:(0,q.tZ)("div",{className:"help-block",children:a})})]})]})},l)}))})]})}}te.displayName="OrganizationRoleSelect";const se=te,oe=(0,S.t)("Cannot be reset since user is in more than one organization"),ie=(0,S.t)("Not enrolled in two-factor authentication"),ne=(0,S.t)("You do not have permission to perform this action"),ae=(0,S.t)("Cannot be reset since two-factor is required for this organization"),re=(0,f.Z)({hookName:"component:disabled-member-tooltip",defaultComponent:e=>{let{children:t}=e;return(0,q.tZ)(n.Fragment,{children:t})}});class le extends B.Z{constructor(){super(...arguments),(0,o.Z)(this,"handleSave",(async()=>{const{organization:e,params:t}=this.props,{orgRole:s,teamRoles:o}=this.state;(0,m.E3)((0,S.t)("Saving...")),this.setState({busy:!0});try{const i=await(0,c.hS)(this.api,{orgId:e.slug,memberId:t.memberId,data:{orgRole:s,teamRoles:o}});this.setState({member:i,orgRole:i.orgRole,teamRoles:i.teamRoles,busy:!1}),(0,m.S9)((0,S.t)("Saved"))}catch(e){const t=e&&e.responseJSON&&e.responseJSON.detail||(0,S.t)("Could not save...");this.setState({busy:!1}),(0,m.Iw)(t)}})),(0,o.Z)(this,"handleInvite",(async e=>{const{organization:t,params:s}=this.props;(0,m.E3)((0,S.t)("Sending invite...")),this.setState({busy:!0});try{const o=await(0,c.R_)(this.api,{orgId:t.slug,memberId:s.memberId,regenerate:e});(0,m.S9)((0,S.t)("Sent invite!")),e&&this.setState((e=>({member:{...e.member,...o}})))}catch(e){(0,m.Iw)((0,S.t)("Could not send invite"))}this.setState({busy:!1})})),(0,o.Z)(this,"handle2faReset",(async()=>{const{organization:e,router:t}=this.props,{user:s}=this.state.member,o=s?.authenticators.map((e=>(0,d.Hb)(this.api,s.id,e.id)))??[];try{await Promise.all(o),t.push((0,j.D)(`/settings/${e.slug}/members/`)),(0,m.S9)((0,S.t)("All authenticators have been removed"))}catch(e){(0,m.Iw)((0,S.t)("Error removing authenticators")),a.Tb(e)}})),(0,o.Z)(this,"onAddTeam",(e=>{const t=[...this.state.teamRoles];-1===t.findIndex((t=>t.teamSlug===e))&&(t.push({teamSlug:e,role:null}),this.setState({teamRoles:t}))})),(0,o.Z)(this,"onRemoveTeam",(e=>{const t=this.state.teamRoles.filter((t=>t.teamSlug!==e));this.setState({teamRoles:t})})),(0,o.Z)(this,"onChangeOrgRole",(e=>this.setState({orgRole:e}))),(0,o.Z)(this,"onChangeTeamRole",((e,t)=>{if(!this.hasTeamRoles)return;const s=[...this.state.teamRoles],o=s.findIndex((t=>t.teamSlug===e));-1!==o&&(s[o]={...s[o],role:t},this.setState({teamRoles:s}))})),(0,o.Z)(this,"showResetButton",(()=>{const{organization:e}=this.props,{member:t}=this.state,{user:s}=t;return!(!s||!s.authenticators||e.require2FA)&&(s.authenticators.length>=1&&s.canReset2fa)})),(0,o.Z)(this,"getTooltip",(()=>{const{organization:e}=this.props,{member:t}=this.state,{user:s}=t;return s?s.authenticators?s.authenticators.length?s.canReset2fa?e.require2FA?ae:"":oe:ie:ne:""}))}get hasTeamRoles(){const{organization:e}=this.props;return e.features.includes("team-roles")}getDefaultState(){return{...super.getDefaultState(),groupOrgRoles:[],member:null,orgRole:"",teamRoles:[]}}getEndpoints(){const{organization:e,params:t}=this.props;return[["member",`/organizations/${e.slug}/members/${t.memberId}/`]]}onRequestSuccess(e){let{data:t,stateKey:s}=e;if("member"===s){const{orgRole:e,teamRoles:s,groupOrgRoles:o}=t;this.setState({orgRole:e,teamRoles:s,groupOrgRoles:o})}}get memberDeactivated(){return(0,z.Z)(this.state.member)}get hasFormChanged(){const{member:e,orgRole:t,teamRoles:s}=this.state;return!(!e||t===e.orgRole&&l()(s,e.teamRoles))}renderMemberStatus(e){return this.memberDeactivated?(0,q.tZ)("em",{children:(0,q.tZ)(re,{children:(0,S.t)("Deactivated")})}):e.expired?(0,q.tZ)("em",{children:(0,S.t)("Invitation Expired")}):e.pending?(0,q.tZ)("em",{children:(0,S.t)("Invitation Pending")}):(0,S.t)("Active")}renderBody(){const{organization:e}=this.props,{member:t,orgRole:s,teamRoles:o}=this.state;if(!t)return(0,q.tZ)(b.Z,{});const{access:i,features:a,orgRoleList:r}=e,l=i.includes("org:write")&&!this.memberDeactivated,d=a.includes("team-roles"),{email:m,expired:c,pending:f,invite_link:T}=t,z=!c,j=!f;return(0,q.BX)(n.Fragment,{children:[(0,q.tZ)(_.Z,{title:(0,q.BX)(n.Fragment,{children:[(0,q.tZ)("div",{children:t.name}),(0,q.tZ)(me,{children:(0,S.t)("Member Settings")})]})}),(0,q.BX)(Z.s_,{children:[(0,q.tZ)(Z.V9,{children:(0,S.t)("Basics")}),(0,q.BX)(Z.N,{children:[(0,q.tZ)(Z.Lv,{children:(0,q.BX)(ce,{children:[(0,q.BX)("div",{children:[(0,q.tZ)(pe,{children:(0,S.t)("Email")}),(0,q.tZ)("div",{children:(0,q.tZ)(x.Z,{href:`mailto:${m}`,children:m})})]}),(0,q.BX)("div",{children:[(0,q.tZ)(pe,{children:(0,S.t)("Status")}),(0,q.tZ)("div",{"data-test-id":"member-status",children:this.renderMemberStatus(t)})]}),(0,q.BX)("div",{children:[(0,q.tZ)(pe,{children:(0,S.t)("Added")}),(0,q.tZ)("div",{children:(0,q.tZ)(g.Z,{dateOnly:!0,date:t.dateCreated})})]})]})}),(0,q.tZ)(Z.Lv,{children:T&&(0,q.BX)(ue,{children:[(0,q.BX)(he,{children:[(0,q.tZ)(pe,{children:(0,S.t)("Invite Link")}),(0,q.tZ)(v.Z,{children:T}),(0,q.tZ)("p",{className:"help-block",children:(0,S.t)("This invite link can be used by anyone who knows it. Keep it secure!")})]}),(0,q.BX)(h.ZP,{gap:1,children:[z&&(0,q.tZ)(p.zx,{"data-test-id":"resend-invite",onClick:()=>this.handleInvite(!1),children:(0,S.t)("Resend Invite")}),(0,q.tZ)(p.zx,{onClick:()=>this.handleInvite(!0),title:(0,S.t)("Generate New Invite. This will invalidate the previous invite link!"),priority:"danger","aria-label":(0,S.t)("Generate New Invite"),icon:(0,q.tZ)(y.tr,{size:"sm"})})]})]})})]})]}),j&&(0,q.BX)(Z.s_,{children:[(0,q.tZ)(Z.V9,{children:(0,S.t)("Authentication")}),(0,q.tZ)(Z.N,{children:(0,q.tZ)(R.Z,{alignRight:!0,flexibleControlStateSize:!0,label:(0,S.t)("Reset two-factor authentication"),help:(0,S.t)("Resetting two-factor authentication will remove all two-factor authentication methods for this member."),children:(0,q.tZ)(w.u,{disabled:this.showResetButton(),title:this.getTooltip(),children:(0,q.tZ)(u.Z,{disabled:!this.showResetButton(),message:(0,S._N)("Are you sure you want to disable all two-factor authentication methods for [name]?",{name:t.name?t.name:"this member"}),onConfirm:this.handle2faReset,children:(0,q.tZ)(p.zx,{priority:"danger",children:(0,S.t)("Reset two-factor authentication")})})})})})]}),(0,q.tZ)(se,{enforceAllowed:!1,enforceRetired:d,disabled:!l,roleList:r,roleSelected:s,setSelected:this.onChangeOrgRole}),(0,q.tZ)(C.Z,{slugs:t.teams,children:i=>{let{initiallyLoaded:a}=i;return(0,q.tZ)(n.Fragment,{children:(0,q.tZ)(K,{disabled:!l,organization:e,member:t,selectedOrgRole:s,selectedTeamRoles:o,onChangeTeamRole:this.onChangeTeamRole,onAddTeam:this.onAddTeam,onRemoveTeam:this.onRemoveTeam,loadingTeams:!a})})}}),(0,q.tZ)(ge,{children:(0,q.tZ)(p.zx,{priority:"primary",busy:this.state.busy,onClick:this.handleSave,disabled:!l||!this.hasFormChanged,children:(0,S.t)("Save Member")})})]})}}const de=(0,k.Z)(le),me=(0,i.Z)("div",{target:"e1mjm7f05"})("color:",(e=>e.theme.gray300),";font-weight:normal;font-size:",(e=>e.theme.fontSizeLarge),";"),ce=(0,i.Z)("div",{target:"e1mjm7f04"})("display:grid;grid-auto-flow:column;grid-template-columns:2fr 1fr 1fr;gap:",(0,T.D)(2),";width:100%;@media (max-width: ",(e=>e.theme.breakpoints.small),"){grid-auto-flow:row;grid-template-columns:auto;}"),pe=(0,i.Z)("div",{target:"e1mjm7f03"})("font-weight:bold;margin-bottom:",(0,T.D)(.5),";color:",(e=>e.theme.textColor),";"),he=(0,i.Z)("div",{target:"e1mjm7f02"})({name:"1ff36h2",styles:"flex-grow:1"}),ue=(0,i.Z)("div",{target:"e1mjm7f01"})("flex-grow:1;display:flex;gap:",(0,T.D)(1),";"),ge=(0,i.Z)("div",{target:"e1mjm7f00"})({name:"skgbeu",styles:"display:flex;justify-content:flex-end"})},"./app/views/settings/organizationTeams/roleOverwriteWarning.tsx":(e,t,s)=>{s.d(t,{Sk:()=>l,d8:()=>m,pu:()=>d});var o=s("./app/components/panels/index.tsx"),i=s("./app/components/tooltip.tsx"),n=s("./app/icons/index.tsx"),a=s("./app/locale.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(e){return m(e)?(0,r.tZ)(i.u,{title:c(e),children:(0,r.tZ)(n.aU,{size:"sm",color:"gray300"})}):null}function d(e){return m(e)?(0,r.tZ)(o.aU,{"data-test-id":"alert-role-overwrite",children:c(e)}):null}function m(e){const{orgRole:t,orgRoleList:s,teamRoleList:o}=e,i=s.find((e=>e.id===t));return o.findIndex((e=>e.id===i?.minimumTeamRole))>0}function c(e){const{orgRole:t,orgRoleList:s,teamRoleList:o,isSelf:i}=e,n=s.find((e=>e.id===t)),l=o.find((e=>e.id===n?.minimumTeamRole));return n&&l?(0,a._N)("[selfNoun] organization role as [article] [orgRole] has granted [selfPronoun] a minimum team-level role of [teamRole]",{selfNoun:i?"Your":"This user's",selfPronoun:i?"you":"them",article:"AEIOU".includes(n.name[0])?"an":"a",orgRole:(0,r.tZ)("strong",{children:n.name}),teamRole:(0,r.tZ)("strong",{children:l.name})}):""}l.displayName="RoleOverwriteIcon",d.displayName="RoleOverwritePanelAlert"}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationMembers_organizationMemberDetail_tsx.980bd0e0472ad5fb9c776fca53c29aa4.js.map