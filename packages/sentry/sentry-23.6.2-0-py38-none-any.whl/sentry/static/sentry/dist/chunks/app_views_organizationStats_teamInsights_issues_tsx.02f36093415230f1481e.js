"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_organizationStats_teamInsights_issues_tsx"],{"./app/views/organizationStats/teamInsights/issues.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>he});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=s("../node_modules/react/index.js"),i=s("./app/components/layouts/thirds.tsx"),o=s("./app/components/loadingIndicator.tsx"),a=s("./app/components/noProjectMessage.tsx"),d=s("./app/components/sentryDocumentTitle.tsx"),l=s("./app/locale.tsx"),u=s("./app/utils/localStorage.tsx"),c=s("./app/utils/routeAnalytics/useRouteAnalyticsEventNames.tsx"),p=s("./app/utils/useOrganization.tsx"),m=s("./app/utils/useTeams.tsx"),g=s("./app/views/organizationStats/header.tsx"),h=s("./app/views/organizationStats/teamInsights/controls.tsx"),Z=s("./app/views/organizationStats/teamInsights/descriptionCard.tsx"),v=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),y=s("../node_modules/moment/moment.js"),x=s.n(y),f=s("./app/components/charts/barChart.tsx"),b=s("./app/components/count.tsx"),w=s("./app/components/idBadge/projectBadge.tsx"),j=s("./app/components/links/link.tsx"),S=s("./app/components/loadingError.tsx"),T=s("./app/components/panels/panelTable.tsx"),D=s("./app/components/placeholder.tsx"),z=s("./app/components/timeSince.tsx"),I=s("./app/icons/index.tsx"),B=s("./app/styles/space.tsx"),C=s("./app/utils/events.tsx"),E=s("./app/utils/queryClient.tsx"),N=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function k(e){if("> 1 year"===e)return x()().subtract(1,"y").subtract(1,"d").valueOf();const[t,s,n]=e.split(" ");return x()().subtract(s,n).valueOf()}const A={"< 1 hour":(0,l.t)("1 hour"),"< 4 hour":(0,l.t)("4 hours"),"< 12 hour":(0,l.t)("12 hours"),"< 1 day":(0,l.t)("1 day"),"< 1 week":(0,l.t)("1 week"),"< 4 week":(0,l.t)("1 month"),"< 24 week":(0,l.t)("6 months"),"< 1 year":(0,l.t)("1 year"),"> 1 year":(0,l.t)("> 1 year")};function q(e){let{organization:t,teamSlug:s}=e;const{data:n,isLoading:i,isError:o,refetch:a}=(0,E.WE)([`/teams/${t.slug}/${s}/issues/old/`,{query:{limit:7}}],{staleTime:5e3}),{data:d,isLoading:u,isError:c,refetch:p}=(0,E.WE)([`/teams/${t.slug}/${s}/unresolved-issue-age/`],{staleTime:5e3}),m=i||u;if(o||c)return(0,N.tZ)(S.Z,{onRetry:()=>{a(),p()}});const g=Object.entries(d??{}).map((e=>{let[t,s]=e;return{name:t,value:s}})).sort(((e,t)=>k(t.name)-k(e.name)));return(0,N.BX)("div",{children:[(0,N.BX)(L,{children:[m&&(0,N.tZ)(D.Z,{height:"200px"}),!m&&(0,N.tZ)(f.v,{style:{height:190},legend:{right:3,top:0},yAxis:{minInterval:1},xAxis:{type:"category",min:0,axisLabel:{showMaxLabel:!0,showMinLabel:!0,formatter:e=>A[e]??e}},series:[{seriesName:(0,l.t)("Unresolved Issues"),silent:!0,data:g,barCategoryGap:"5%"}]})]}),(0,N.tZ)(O,{isEmpty:!n||0===n?.length,emptyMessage:(0,l.t)("No unresolved issues for this teamâ€™s projects"),headers:[(0,l.t)("Oldest Issues"),(0,N.tZ)($,{children:(0,l.t)("Events")},"events"),(0,N.tZ)($,{children:(0,l.t)("Users")},"users"),(0,N.BX)($,{children:[(0,l.t)("Age")," ",(0,N.tZ)(I.CC,{direction:"down",size:"xs",color:"gray300"})]},"age")],isLoading:m,children:n?.map((e=>{const{title:s}=(0,C.YQ)(e,t?.features,!1);return(0,N.BX)(r.Fragment,{children:[(0,N.BX)(M,{children:[(0,N.tZ)(_,{disableLink:!0,hideName:!0,avatarSize:18,project:e.project}),(0,N.tZ)(R,{children:(0,N.tZ)(j.Z,{to:{pathname:`/organizations/${t.slug}/issues/${e.id}/`},children:s})})]}),(0,N.tZ)($,{children:(0,N.tZ)(b.Z,{value:e.count})}),(0,N.tZ)($,{children:(0,N.tZ)(b.Z,{value:e.userCount})}),(0,N.tZ)($,{children:(0,N.tZ)(z.Z,{date:e.firstSeen})})]},e.id)}))})]})}q.displayName="TeamIssuesAge";const X=q,L=(0,n.Z)("div",{target:"eq9p07m5"})("padding:",(0,B.D)(2)," ",(0,B.D)(2)," 0 ",(0,B.D)(2),";border-bottom:1px solid ",(e=>e.theme.border),";"),O=(0,n.Z)(T.Z,{target:"eq9p07m4"})("grid-template-columns:1fr 0.15fr 0.15fr 0.25fr;white-space:nowrap;margin-bottom:0;border:0;font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:unset;>*{padding:",(0,B.D)(1)," ",(0,B.D)(2),";}",(e=>e.isEmpty&&(0,v.iv)("&>div:last-child{padding:48px ",(0,B.D)(2),";}","")),";"),$=(0,n.Z)("span",{target:"eq9p07m3"})({name:"19mh0x6",styles:"display:flex;align-items:center;justify-content:flex-end"}),M=(0,n.Z)("div",{target:"eq9p07m2"})((e=>e.theme.overflowEllipsis),";display:flex;align-items:center;"),R=(0,n.Z)("div",{target:"eq9p07m1"})((e=>e.theme.overflowEllipsis),";"),_=(0,n.Z)(w.Z,{target:"eq9p07m0"})("display:inline-flex;align-items:center;margin-right:",(0,B.D)(1),";*>img{box-shadow:none;}");var G=s("./app/components/collapsePanel.tsx"),F=s("./app/components/organizations/pageFilters/parse.tsx"),P=s("./app/stores/projectsStore.tsx"),U=s("./app/views/organizationStats/teamInsights/styles.tsx"),W=s("./app/views/organizationStats/teamInsights/utils.tsx");const K=["deleted","ignored","resolved","unignored","regressed","new","total"];function H(e){let{organization:t,projects:s,start:n,end:i,period:o,utc:a,teamSlug:d,statuses:u,environment:c}=e;const{data:p={},isLoading:m,isError:g,refetch:h}=(0,E.WE)([`/teams/${t.slug}/${d}/issue-breakdown/`,{query:{...(0,F.fK)({start:n,end:i,period:o,utc:a}),statuses:u,environment:c}}],{staleTime:5e3}),Z={},v={};for(const[e,t]of Object.entries(p))for(const[s,n]of Object.entries(t)){v[e]||(v[e]={deleted:0,ignored:0,resolved:0,unignored:0,regressed:0,new:0,total:0});for(const t of K)v[e][t]+=n[t];Z[e]||(Z[e]={}),void 0===Z[e][s]?Z[e][s]=n.total:Z[e][s]+=n.total}const y=Object.entries(v).map((e=>{let[t,{total:s}]=e;return{projectId:t,total:s}})).sort(((e,t)=>t.total-e.total)),x=Object.keys(Z).map(((e,t)=>({seriesName:P.Z.getById(e)?.slug??e,data:(0,W.Gs)((0,W.E7)(Z[e])),animationDuration:500,animationDelay:500*t,silent:!0,barCategoryGap:"5%"})));return g?(0,N.tZ)(S.Z,{onRetry:h}):(0,N.BX)(r.Fragment,{children:[(0,N.BX)(Y,{children:[m&&(0,N.tZ)(D.Z,{height:"200px"}),!m&&(0,N.tZ)(f.v,{style:{height:200},stacked:!0,isGroupedByDate:!0,useShortDate:!0,legend:{right:0,top:0},xAxis:(0,W.tP)(),yAxis:{minInterval:1},series:x})]}),(0,N.tZ)(G.Z,{items:y.length,children:e=>{let{isExpanded:t,showMoreButton:n}=e;return(0,N.BX)(r.Fragment,{children:[(0,N.tZ)(J,{numActions:u.length,headers:[(0,l.t)("Project"),...u.map((e=>(0,N.tZ)(ee,{children:e},e))),(0,N.BX)(ee,{children:[(0,l.t)("total")," ",(0,N.tZ)(I.CC,{direction:"down",size:"xs",color:"gray300"})]},"total")],isLoading:m,children:y.map(((e,n)=>{let{projectId:i}=e;const o=s.find((e=>e.id===i));return n>=G.$&&!t?null:(0,N.BX)(r.Fragment,{children:[(0,N.tZ)(U.R,{children:o&&(0,N.tZ)(U.W,{avatarSize:18,project:o})}),u.map((e=>(0,N.tZ)(ee,{children:v[i][e]},e))),(0,N.tZ)(ee,{children:v[i].total})]},i)}))}),!m&&n]})}})]})}H.displayName="TeamIssuesBreakdown";const Q=H,V=(0,n.Z)("div",{target:"e1hoqdvl3"})("padding:",(0,B.D)(2)," ",(0,B.D)(2)," 0 ",(0,B.D)(2),";"),Y=(0,n.Z)(V,{target:"e1hoqdvl2"})("border-bottom:1px solid ",(e=>e.theme.border),";"),J=(0,n.Z)(T.Z,{target:"e1hoqdvl1"})("grid-template-columns:1fr ",(e=>" 0.2fr".repeat(e.numActions))," 0.2fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,B.D)(1)," ",(0,B.D)(2),";}"),ee=(0,n.Z)("div",{target:"e1hoqdvl0"})({name:"mnwtso",styles:"text-align:right;font-variant-numeric:tabular-nums"});var te=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),se=s("./app/components/asyncComponent.tsx"),ne=s("./app/utils/formatters.tsx");class re extends se.Z{constructor(){super(...arguments),(0,te.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),resolutionTime:null}}getEndpoints(){const{organization:e,start:t,end:s,period:n,utc:r,teamSlug:i,environment:o}=this.props,a={start:t,end:s,period:n,utc:r};return[["resolutionTime",`/teams/${e.slug}/${i}/time-to-resolution/`,{query:{...(0,F.fK)(a),environment:o}}]]}componentDidUpdate(e){const{start:t,end:s,period:n,utc:r,teamSlug:i,environment:o}=this.props;e.start===t&&e.end===s&&e.period===n&&e.utc===r&&e.teamSlug===i&&e.environment===o||this.remountComponent()}renderLoading(){return(0,N.tZ)(oe,{children:(0,N.tZ)(o.Z,{})})}renderBody(){const{resolutionTime:e}=this.state,t=Object.entries(e??{}).map((e=>{let[t,{avg:s}]=e;return{value:s,name:new Date(t).getTime()}})),s=(0,W.Gs)(t);return(0,N.tZ)(oe,{children:(0,N.tZ)(f.v,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",tooltip:{valueFormatter:e=>(0,ne.g9)(e,1)},yAxis:{minInterval:86400,axisLabel:{formatter:e=>0===e?"":(0,ne.g9)(e,0,!0,!0)}},legend:{right:0,top:0},xAxis:(0,W.tP)(),series:[{seriesName:(0,l.t)("Time to Resolution"),data:s,silent:!0,barCategoryGap:"5%"}]})})}}const ie=re,oe=(0,n.Z)("div",{target:"ew4ocpl0"})("padding:",(0,B.D)(2)," ",(0,B.D)(2)," 0 ",(0,B.D)(2),";");function ae(e){let{organization:t,teamSlug:s,projects:n,start:i,end:o,period:a,utc:d,environment:u}=e;const{data:c={},isLoading:p,isError:m,refetch:g}=(0,E.WE)([`/teams/${t.slug}/${s}/all-unresolved-issues/`,{query:{...(0,F.fK)({start:i,end:o,period:a,utc:d}),environment:u}}],{staleTime:0});function h(e){const t=Object.values(c?.[e]??{}),s=t.reduce(((e,t)=>e+t.unresolved),0);return Math.round(s/t.length)}const Z={};for(const e of Object.keys(c)){const t=h(Number(e)),s=Object.values(c?.[e]??{}),n=s[s.length-1]?.unresolved??0,r=(n-t)/t;Z[e]={projectId:e,periodAvg:t,today:n,percentChange:Number.isNaN(r)?0:r}}const v=n.map((e=>({project:e,trend:Z[e.id]?.percentChange??0}))).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))),y=(0,W.NW)(v),x=Object.values(c).flatMap((e=>Object.entries(e).map((e=>{let[t,{unresolved:s}]=e;return[t,s]})))).reduce(((e,t)=>{let[s,n]=t;return void 0===e[s]&&(e[s]=0),e[s]+=n,e}),{}),b=(0,W.Gs)((0,W.E7)(x));return m?(0,N.tZ)(S.Z,{onRetry:g}):(0,N.BX)("div",{children:[(0,N.BX)(de,{children:[p&&(0,N.tZ)(D.Z,{height:"200px"}),!p&&(0,N.tZ)(f.v,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,legend:{right:3,top:0},yAxis:{minInterval:1},xAxis:(0,W.tP)(),series:[{seriesName:(0,l.t)("Unresolved Issues"),silent:!0,data:b,barCategoryGap:"6%"}]})]}),(0,N.tZ)(G.Z,{items:y.length,children:e=>{let{isExpanded:t,showMoreButton:s}=e;return(0,N.BX)(r.Fragment,{children:[(0,N.tZ)(le,{isEmpty:0===n.length,isLoading:p,headers:[(0,l.t)("Project"),(0,N.tZ)(ue,{children:(0,l._N)("Last [period] Average",{period:a})},"last"),(0,N.tZ)(ue,{children:(0,l.t)("Today")},"curr"),(0,N.tZ)(ue,{children:(0,l.t)("Change")},"diff")],children:y.map(((e,s)=>{let{project:n}=e;const i=Z[n.id]??{};return s>=G.$&&!t?null:(0,N.BX)(r.Fragment,{children:[(0,N.tZ)(U.R,{children:(0,N.tZ)(U.W,{avatarSize:18,project:n})}),(0,N.tZ)(ce,{children:i.periodAvg}),(0,N.tZ)(ce,{children:i.today}),(0,N.tZ)(ce,{children:(0,N.BX)(me,{color:0===i.percentChange?"subText":i.percentChange>0?"errorText":"successText",children:[(0,ne.rl)(Number.isNaN(i.percentChange)?0:i.percentChange,0),(0,N.tZ)(pe,{direction:i.percentChange>0?"up":"down",size:"xs"})]})})]},n.id)}))}),!p&&s]})}})]})}ae.displayName="TeamUnresolvedIssues";const de=(0,n.Z)("div",{target:"e4muyu35"})("padding:",(0,B.D)(2)," ",(0,B.D)(2)," 0 ",(0,B.D)(2),";border-bottom:1px solid ",(e=>e.theme.border),";"),le=(0,n.Z)(T.Z,{target:"e4muyu34"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr;white-space:nowrap;margin-bottom:0;border:0;font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:unset;&>div{padding:",(0,B.D)(1)," ",(0,B.D)(2),";}"),ue=(0,n.Z)("span",{target:"e4muyu33"})({name:"2qga7i",styles:"text-align:right"}),ce=(0,n.Z)("div",{target:"e4muyu32"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),pe=(0,n.Z)(I.CC,{target:"e4muyu31"})("margin:0 ",(0,B.D)(.5),";"),me=(0,n.Z)("div",{target:"e4muyu30"})("color:",(e=>e.theme[e.color]),";");function ge(e){let{location:t,router:s}=e;const n=(0,p.Z)(),{teams:v,initiallyLoaded:y}=(0,m.y)({provideUserTeams:!0});(0,c.Z)("team_insights.viewed","Team Insights: Viewed");const x=t?.query??{},f=`teamInsightsSelectedTeamId:${n.slug}`;let b=x.team??u.Z.getItem(f);b&&!v.find((e=>e.id===b))&&(b=null);const w=b??v[0]?.id,j=v.find((e=>e.id===w)),S=j?.projects??[],T=x.environment,{period:D,start:z,end:I,utc:B}=(0,W.lI)(x);return 0===v.length?(0,N.tZ)(a.Z,{organization:n,superuserNeedsToBeProjectMember:!0}):(0,N.BX)(r.Fragment,{children:[(0,N.tZ)(d.Z,{title:(0,l.t)("Team Issues"),orgSlug:n.slug}),(0,N.tZ)(g.Z,{organization:n,activeTab:"issues"}),(0,N.BX)(Ze,{children:[(0,N.tZ)(h.Z,{showEnvironment:!0,location:t,router:s,currentTeam:j,currentEnvironment:T}),!y&&(0,N.tZ)(o.Z,{}),y&&(0,N.BX)(i.or,{fullWidth:!0,children:[(0,N.tZ)(Z.Z,{title:(0,l.t)("All Unresolved Issues"),description:(0,l.t)("This includes New and Returning issues in the last 7 days as well as those that havenâ€™t been resolved or ignored in the past."),children:(0,N.tZ)(ae,{projects:S,organization:n,teamSlug:j.slug,environment:T,period:D,start:z,end:I,utc:B})}),(0,N.tZ)(Z.Z,{title:(0,l.t)("New and Returning Issues"),description:(0,l.t)("The new, regressed, and unignored issues that were assigned to your team."),children:(0,N.tZ)(Q,{organization:n,projects:S,teamSlug:j.slug,environment:T,period:D,start:z?.toString(),end:I?.toString(),statuses:["new","regressed","unignored"]})}),(0,N.tZ)(Z.Z,{title:(0,l.t)("Issues Triaged"),description:(0,l.t)("How many new and returning issues were reviewed by your team each week. Reviewing an issue includes marking as reviewed, resolving, assigning to another team, or deleting."),children:(0,N.tZ)(Q,{organization:n,projects:S,teamSlug:j.slug,environment:T,period:D,start:z?.toString(),end:I?.toString(),statuses:["resolved","ignored","deleted"]})}),(0,N.tZ)(Z.Z,{title:(0,l.t)("Age of Unresolved Issues"),description:(0,l.t)("How long ago since unresolved issues were first created."),children:(0,N.tZ)(X,{organization:n,teamSlug:j.slug})}),(0,N.tZ)(Z.Z,{title:(0,l.t)("Time to Resolution"),description:(0,l.t)("The mean time it took for issues to be resolved by your team."),children:(0,N.tZ)(ie,{organization:n,environment:T,teamSlug:j.slug,period:D,start:z?.toString(),end:I?.toString(),location:t})})]})]})]})}ge.displayName="TeamStatsIssues";const he=ge,Ze=(0,n.Z)(i.uT,{target:"e1bncyea0"})("@media (min-width: ",(e=>e.theme.breakpoints.medium),"){display:block;}")}}]);
//# sourceMappingURL=../sourcemaps/app_views_organizationStats_teamInsights_issues_tsx.4a7ca1a9d34d39f50fad3e8e6ea7f82e.js.map