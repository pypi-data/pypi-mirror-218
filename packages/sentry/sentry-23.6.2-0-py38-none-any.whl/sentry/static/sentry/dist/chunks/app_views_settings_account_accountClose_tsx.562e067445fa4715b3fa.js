"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_account_accountClose_tsx"],{"./app/views/asyncView.tsx":(e,t,n)=>{n.d(t,{Z:()=>r});var o=n("./app/components/asyncComponent.tsx"),s=n("./app/components/sentryDocumentTitle.tsx"),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class r extends o.Z{getTitle(){return""}render(){return(0,i.tZ)(s.Z,{title:this.getTitle(),children:this.renderComponent()})}}r.displayName="AsyncView"},"./app/views/settings/account/accountClose.tsx":(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var o=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=n("./app/actionCreators/indicator.tsx"),r=n("./app/actionCreators/modal.tsx"),a=n("./app/components/alert.tsx"),l=n("./app/components/button.tsx"),c=n("./app/components/hookOrDefault.tsx"),d=n("./app/components/panels/index.tsx"),u=n("./app/locale.tsx"),h=n("./app/views/asyncView.tsx"),m=n("./app/components/confirm.tsx"),g=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){let{handleRemoveAccount:t}=e;return(0,g.tZ)(m.Z,{priority:"danger",message:(0,u.t)("This is permanent and cannot be undone, are you really sure you want to do this?"),onConfirm:t,children:(0,g.tZ)(l.zx,{priority:"danger",children:(0,u.t)("Close Account")})})}p.displayName="ConfirmAccountClose";var w=n("./app/views/settings/components/settingsPageHeader.tsx"),v=n("./app/views/settings/components/text/textBlock.tsx");const y=()=>window.location.href="/",Z=(0,s.Z)("div",{target:"evrw3re0"})({name:"14rp7vr",styles:"font-weight:bold;font-size:1.2em"});function x(e){let{Header:t,Body:n,Footer:o}=e;return(0,g.BX)("div",{children:[(0,g.tZ)(t,{children:(0,u.t)("Closing Account")}),(0,g.BX)(n,{children:[(0,g.tZ)(v.Z,{children:(0,u.t)("Your account has been deactivated and scheduled for removal.")}),(0,g.tZ)(v.Z,{children:(0,u.t)("Thanks for using Sentry! We hope to see you again soon!")})]}),(0,g.tZ)(o,{children:(0,g.tZ)(l.zx,{href:"/",children:(0,u.t)("Goodbye")})})]})}x.displayName="GoodbyeModalContent";class b extends h.Z{constructor(){super(...arguments),(0,o.Z)(this,"leaveRedirectTimeout",void 0),(0,o.Z)(this,"handleChange",((e,t,n)=>{let{slug:o}=e;const s=n.target.checked;t||this.setState((e=>{const t=e.orgsToRemove||new Set(this.singleOwnerOrgs);return s?t.add(o):t.delete(o),{orgsToRemove:t}}))})),(0,o.Z)(this,"handleRemoveAccount",(async()=>{const e=this.orgSlugsToRemove;(0,i.E3)("Closing accountâ€¦");try{await this.api.requestPromise("/users/me/",{method:"DELETE",data:{organizations:e}}),(0,r.openModal)(x,{onClose:y}),window.clearTimeout(this.leaveRedirectTimeout),this.leaveRedirectTimeout=window.setTimeout(y,1e4)}catch{(0,i.Iw)("Error closing account")}}))}componentWillUnmount(){window.clearTimeout(this.leaveRedirectTimeout)}getEndpoints(){return[["organizations","/organizations/?owner=1"]]}getDefaultState(){return{...super.getDefaultState(),orgsToRemove:null}}get singleOwnerOrgs(){return this.state.organizations?.filter((e=>{let{singleOwner:t}=e;return t}))?.map((e=>{let{organization:t}=e;return t.slug}))}getTitle(){return(0,u.t)("Close Account")}get orgSlugsToRemove(){const{orgsToRemove:e}=this.state;return(null===e?this.singleOwnerOrgs:Array.from(e))||[]}renderBody(){const{organizations:e,orgsToRemove:t}=this.state,n=(0,c.Z)({hookName:"component:confirm-account-close",defaultComponent:e=>(0,g.tZ)(p,{...e})});return(0,g.BX)("div",{children:[(0,g.tZ)(w.Z,{title:this.getTitle()}),(0,g.BX)(v.Z,{children:[(0,u.t)("This will permanently remove all associated data for your user"),"."]}),(0,g.tZ)(a.bZ,{type:"error",showIcon:!0,children:(0,g.BX)(Z,{children:[(0,u.t)("Closing your account is permanent and cannot be undone"),"!"]})}),(0,g.BX)(d.s_,{children:[(0,g.tZ)(d.V9,{children:(0,u.t)("Remove the following organizations")}),(0,g.BX)(d.N,{children:[(0,g.BX)(d.aU,{type:"info",children:[(0,u.t)("Ownership will remain with other organization owners if an organization is not deleted."),(0,g.tZ)("br",{}),(0,u._N)("Boxes which can't be unchecked mean that you are the only organization owner and the organization [strong:will be deleted].",{strong:(0,g.tZ)("strong",{})})]}),e?.map((e=>{let{organization:n,singleOwner:o}=e;return(0,g.tZ)(d.Lv,{children:(0,g.BX)("label",{children:[(0,g.tZ)("input",{style:{marginRight:6},type:"checkbox",value:n.slug,onChange:this.handleChange.bind(this,n,o),name:"organizations",checked:null===t?o:t.has(n.slug),disabled:o}),n.slug]})},n.slug)}))]})]}),(0,g.tZ)(n,{handleRemoveAccount:this.handleRemoveAccount,organizationSlugs:this.orgSlugsToRemove})]})}}const T=b}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_account_accountClose_tsx.575dc1f82981c2484da214f09bbf37a5.js.map