"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_account_accountNotificationFineTuning_tsx"],{"./app/data/forms/accountNotificationSettings.tsx":(t,e,i)=>{i.r(e),i.d(e,{fields:()=>s,route:()=>o});var n=i("./app/locale.tsx");const o="/settings/account/notifications/",s={subscribeByDefault:{name:"subscribeByDefault",type:"boolean",label:(0,n.t)("Send Me Alerts"),help:(0,n.t)("Enable this to receive notifications for Alerts sent to your teams. You will always receive alerts configured to be sent directly to you.")},workflowNotifications:{name:"workflowNotifications",type:"radio",label:(0,n.t)("Send Me Workflow Notifications"),choices:[[0,(0,n.t)("Always")],[1,(0,n.t)("Only On Issues I Subscribe To")],[2,(0,n.t)("Never")]],help:(0,n.t)("E.g. changes in issue assignment, resolution status, and comments.")},weeklyReports:{name:"weeklyReports",type:"boolean",label:(0,n.t)("Send Me Weekly Reports"),help:(0,n.t)("Reports contain a summary of what's happened within your organization."),disabled:!0},deployNotifications:{name:"deployNotifications",type:"radio",label:(0,n.t)("Send Me Deploy Notifications"),choices:[[2,(0,n.t)("Always")],[3,(0,n.t)("Only On Deploys With My Commits")],[4,(0,n.t)("Never")]],help:(0,n.t)("Deploy emails include release, environment and commit overviews.")},personalActivityNotifications:{name:"personalActivityNotifications",type:"boolean",label:(0,n.t)("Notify Me About My Own Activity"),help:(0,n.t)("Enable this to receive notifications about your own actions on Sentry.")},selfAssignOnResolve:{name:"selfAssignOnResolve",type:"boolean",label:(0,n.t)("Claim Unassigned Issues I've Resolved"),help:(0,n.t)("You'll receive notifications about any changes that happen afterwards.")}}},"./app/views/asyncView.tsx":(t,e,i)=>{i.d(e,{Z:()=>a});var n=i("./app/components/asyncComponent.tsx"),o=i("./app/components/sentryDocumentTitle.tsx"),s=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class a extends n.Z{getTitle(){return""}render(){return(0,s.tZ)(o.Z,{title:this.getTitle(),children:this.renderComponent()})}}a.displayName="AsyncView"},"./app/views/settings/account/accountNotificationFineTuning.tsx":(t,e,i)=>{i.r(e),i.d(e,{default:()=>G});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(i("../node_modules/core-js/modules/es.array.push.js"),i("../node_modules/react/index.js")),s=i("./app/components/emptyMessage.tsx"),a=i("./app/components/forms/fields/selectField.tsx"),r=i("./app/components/forms/form.tsx"),l=i("./app/components/forms/jsonForm.tsx"),c=i("./app/components/pagination.tsx"),p=i("./app/components/panels/index.tsx"),u=i("./app/data/forms/accountNotificationSettings.tsx"),d=i("./app/locale.tsx"),m=i("./app/utils/withOrganizations.tsx"),f=i("./app/views/asyncView.tsx");const h={alerts:{title:(0,d.t)("Issue Alert Notifications"),description:(0,d.t)("Notifications from Alert Rules that your team has setup. Youâ€™ll always receive notifications from Alerts configured to be sent directly to you."),type:"select",options:[{value:"-1",label:(0,d.t)("Default")},{value:"1",label:(0,d.t)("On")},{value:"0",label:(0,d.t)("Off")}],defaultValue:"-1",defaultFieldName:"subscribeByDefault"},workflow:{title:(0,d.t)("Workflow Notifications"),description:(0,d.t)("Control workflow notifications, e.g. changes in issue assignment, resolution status, and comments."),type:"select",options:[{value:"-1",label:(0,d.t)("Default")},{value:"0",label:(0,d.t)("Always")},{value:"1",label:(0,d.t)("Only on issues I subscribe to")},{value:"2",label:(0,d.t)("Never")}],defaultValue:"-1",defaultFieldName:"workflowNotifications"},deploy:{title:(0,d.t)("Deploy Notifications"),description:(0,d.t)("Control deploy notifications that include release, environment, and commit overviews."),type:"select",options:[{value:"-1",label:(0,d.t)("Default")},{value:"2",label:(0,d.t)("Always")},{value:"3",label:(0,d.t)("Only on deploys with my commits")},{value:"4",label:(0,d.t)("Never")}],defaultValue:"-1",defaultFieldName:"deployNotifications"},reports:{title:(0,d.t)("Weekly Reports"),description:(0,d.t)("Reports contain a summary of what's happened within the organization."),type:"select",defaultValue:"1",options:[{value:"1",label:(0,d.t)("On")},{value:"0",label:(0,d.t)("Off")}],defaultFieldName:"weeklyReports"},approval:{title:(0,d.t)("Approvals"),description:(0,d.t)("Notifications from teammates that require review or approval."),type:"select"},quota:{title:(0,d.t)("Quota Notifications"),description:(0,d.t)("Control the notifications you receive for error, transaction, and attachment quota limits."),type:"select"},spikeProtection:{title:(0,d.t)("Spike Protection Notifications"),description:(0,d.t)("Notifications about spikes on projects that you have enabled spike protection for."),type:"select",defaultValue:"1",options:[{value:"1",label:(0,d.t)("On")},{value:"0",label:(0,d.t)("Off")}],defaultFieldName:"spikeProtection"},email:{title:(0,d.t)("Email Routing"),description:(0,d.t)("On a per project basis, route emails to an alternative email address."),type:"select"}};var g=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),y=i("./app/components/asyncComponent.tsx"),b=i("./app/components/sentryDocumentTitle.tsx"),v=i("./app/utils/analytics.tsx"),Z=i("./app/views/settings/account/notifications/constants.tsx"),S=i("./app/views/settings/account/notifications/fields2.tsx"),w=i("./app/views/settings/account/notifications/utils.tsx"),j=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function x(t){let{notificationType:e,notificationSettings:i,onChange:n,onSubmitSuccess:o,organizations:s}=t;return(0,j.tZ)(r.Z,{saveOnBlur:!0,apiMethod:"PUT",apiEndpoint:"/users/me/notification-settings/",initialData:(0,w.tl)(e,i,s),onSubmitSuccess:o,children:(0,j.tZ)(l.Z,{title:(0,d.t)("Organizations"),fields:s.map((t=>(0,w.gw)(e,i,t,n)))})})}x.displayName="NotificationSettingsByOrganization";const k=(0,m.Z)(x);var T=i("./app/utils.tsx"),N=i("./app/views/settings/components/defaultSearchBar.tsx");class O extends y.Z{constructor(){super(...arguments),(0,g.Z)(this,"getProjectCount",(()=>{const{notificationType:t,notificationSettings:e}=this.props;return Object.values(e[t]?.project||{}).length})),(0,g.Z)(this,"getGroupedProjects",(()=>{const{projects:t}=this.state;return Object.fromEntries(Object.values((0,w.uI)((0,T.Mx)(t))).map((t=>{let{organization:e,projects:i}=t;return[`${e.name} Projects`,i]})))}))}getDefaultState(){return{...super.getDefaultState(),projects:[]}}getEndpoints(){return[["projects","/projects/"]]}renderBody(){const{notificationType:t,notificationSettings:e,onChange:i,onSubmitSuccess:n}=this.props,{projects:a,projectsPageLinks:p}=this.state,u=this.getProjectCount()>=Z.Zb,m=a.length>=Z.sg;return(0,j.BX)(o.Fragment,{children:[u&&this.renderSearchInput({stateKey:"projects",url:"/projects/",placeholder:(0,d.t)("Search Projects"),children:t=>{let{defaultSearchBar:e}=t;return(0,j.tZ)(D,{children:e})}}),(0,j.tZ)(r.Z,{saveOnBlur:!0,apiMethod:"PUT",apiEndpoint:"/users/me/notification-settings/",initialData:(0,w.tl)(t,e,a),onSubmitSuccess:n,children:0===a.length?(0,j.tZ)(s.Z,{children:(0,d.t)("No projects found")}):Object.entries(this.getGroupedProjects()).map((n=>{let[o,s]=n;return(0,j.tZ)(l.Z,{collapsible:!0,title:o,fields:s.map((n=>(0,w.gw)(t,e,n,i)))},o)}))}),u&&m&&(0,j.tZ)(c.Z,{pageLinks:p,...this.props})]})}}const P=O,D=(0,n.Z)(N._,{target:"e4ddg0o0"})({name:"1ekhw56",styles:"*{width:100%;}"});var B=i("./app/components/alert.tsx");function _(t){let{organizations:e}=t;return(0,j.BX)(z,{type:"warning",showIcon:!0,children:[(0,d.t)("You've selected Slack as your delivery method, but do not have a linked account for the following organizations. You'll receive email notifications instead until you type \"/sentry link\" into your Slack workspace to link your account. If slash commands are not working, please re-install the Slack integration."),(0,j.tZ)("ul",{children:e.map((t=>(0,j.tZ)("li",{children:t.slug},t.id)))})]})}_.displayName="UnlinkedAlert";const z=(0,n.Z)(B.bZ,{target:"e1mzr5km0"})({name:"12jd8yt",styles:"margin:20px 0px"}),F=_;var A=i("./app/views/settings/components/settingsPageHeader.tsx"),I=i("./app/views/settings/components/text/textBlock.tsx");const E={quota:["quotaErrors","quotaTransactions","quotaAttachments","quotaReplays","quotaWarnings","quotaSpendAllocations"]},C=t=>t in E?null:{type:t};class q extends y.Z{constructor(){super(...arguments),(0,g.Z)(this,"getStateToPutForProvider",(t=>{const{notificationType:e}=this.props,{notificationSettings:i}=this.state,n=(0,w.E2)(e,i,t);return this.setState({notificationSettings:(0,w.r_)(i,n)}),n})),(0,g.Z)(this,"getStateToPutForDependentSetting",((t,e)=>{const i=t[e],{notificationSettings:n}=this.state,o={[e]:{user:{me:Z.rn.reduce(((t,e)=>(t[e]=i,t)),{})}}};return this.setState({notificationSettings:(0,w.r_)(n,o)}),o})),(0,g.Z)(this,"getStateToPutForDefault",(t=>{const{notificationType:e}=this.props,{notificationSettings:i}=this.state,n=(0,w.zD)(e,i,t,(0,w.Vy)(e,i));return this.setState({notificationSettings:(0,w.r_)(i,n)}),n})),(0,g.Z)(this,"getStateToPutForParent",((t,e)=>{const{notificationType:i}=this.props,{notificationSettings:n}=this.state,o=(0,w.O0)(i,n,t,e);return this.setState({notificationSettings:(0,w.r_)(n,o)}),o})),(0,g.Z)(this,"getUnlinkedOrgs",(()=>{const{organizations:t}=this.props,{identities:e,organizationIntegrations:i}=this.state,n=Object.fromEntries(i.map((t=>[t.organizationId,t.externalId]))),o=Object.fromEntries(e.map((t=>[t?.identityProvider?.externalId,t])));return t.filter((t=>{const e=n[t.id];return null==o[e]}))}))}getDefaultState(){return{...super.getDefaultState(),notificationSettings:{},identities:[],organizationIntegrations:[]}}getEndpoints(){const{notificationType:t}=this.props;return[["notificationSettings","/users/me/notification-settings/",{query:C(t)}],["identities","/users/me/identities/",{query:{provider:"slack"}}],["organizationIntegrations","/users/me/organization-integrations/",{query:{provider:"slack"}}]]}componentDidMount(){super.componentDidMount(),(0,v.Gi)("notification_settings.tuning_page_viewed",{organization:null,notification_type:this.props.notificationType})}trackTuningUpdated(t){(0,v.Gi)("notification_settings.updated_tuning_setting",{organization:null,notification_type:this.props.notificationType,tuning_field_type:t})}getInitialData(){const{notificationType:t}=this.props,{notificationSettings:e}=this.state,i=(0,w.iy)(t,e)?["email","slack"]:(0,w.xy)(t,e),n=E[t]||[],o=Object.fromEntries(n.map((t=>[t,(0,w.hx)(t,e)])));return{[t]:(0,w.hx)(t,e),provider:i,...o}}getFields(){const{notificationType:t}=this.props,{notificationSettings:e}=this.state,i=(0,w.yB)(t)?(0,d.t)("This is the default for all projects."):(0,d.t)("This is the default for all organizations."),n=Object.assign({},S.u[t],{help:i,getData:t=>this.getStateToPutForDefault(t)});(0,w.Vi)(t,e)&&(n.confirm={never:Z.Y5});const o=[n];return(0,w.iy)(t,e)||o.push(Object.assign({help:(0,d.t)("Where personal notifications will be sent."),getData:t=>this.getStateToPutForProvider(t)},S.u.provider)),"quota"!==t||(0,w.iy)(t,e)||o.push(...S.i.map((t=>({...t,type:"select",getData:e=>this.getStateToPutForDependentSetting(e,t.name)})))),o}renderBody(){const{notificationType:t}=this.props,{notificationSettings:e}=this.state,i=(0,w.xy)(t,e).includes("slack"),n=this.getUnlinkedOrgs(),{title:s,description:a}=h[t];return(0,j.BX)(o.Fragment,{children:[(0,j.tZ)(b.Z,{title:s}),(0,j.tZ)(A.Z,{title:s}),a&&(0,j.tZ)(I.Z,{children:a}),i&&n.length>0&&(0,j.tZ)(F,{organizations:n}),(0,j.tZ)(r.Z,{saveOnBlur:!0,apiMethod:"PUT",apiEndpoint:"/users/me/notification-settings/",initialData:this.getInitialData(),onSubmitSuccess:()=>this.trackTuningUpdated("general"),children:(0,j.tZ)(l.Z,{title:(0,w.yB)(t)?(0,d.t)("All Projects"):(0,d.t)("All Organizations"),fields:this.getFields()})}),!(0,w.iy)(t,e)&&((0,w.yB)(t)?(0,j.tZ)(P,{notificationType:t,notificationSettings:e,onChange:this.getStateToPutForParent,onSubmitSuccess:()=>this.trackTuningUpdated("project")}):(0,j.tZ)(k,{notificationType:t,notificationSettings:e,onChange:this.getStateToPutForParent,onSubmitSuccess:()=>this.trackTuningUpdated("organization")}))]})}}const V=(0,m.Z)(q),M=(0,n.Z)(p.N,{target:"e1a4qntk1"})("font-size:1rem;&:not(:last-child){border-bottom:1px solid ",(t=>t.theme.innerBorder),";}"),R=["alerts","deploy","workflow","approval","quota","spikeProtection"];function U(t){let{projects:e,field:i}=t;const n=(0,w.uI)(e),{title:s,description:r,...l}=i,c=Object.values(n).map((t=>({name:t.organization.name,projects:t.projects.map((t=>({...l,name:t.id,label:t.slug})))})));return(0,j.tZ)(o.Fragment,{children:c.map((t=>{let{name:e,projects:i}=t;return(0,j.BX)("div",{children:[(0,j.tZ)(p.V9,{children:e}),i.map((t=>(0,j.tZ)(M,{children:(0,j.tZ)(a.Z,{defaultValue:t.defaultValue,name:t.name,options:t.options,label:t.label})},t.name)))]},e)}))})}function X(t){let{organizations:e,field:i}=t;const{title:n,description:s,...r}=i,l=e.map((t=>({...r,name:t.id,label:t.slug})));return(0,j.tZ)(o.Fragment,{children:l.map((t=>(0,j.tZ)(M,{children:(0,j.tZ)(a.Z,{defaultValue:t.defaultValue,name:t.name,options:t.options,label:t.label})},t.name)))})}U.displayName="AccountNotificationsByProject",X.displayName="AccountNotificationsByOrganization";const W=(0,m.Z)(X);class Y extends f.Z{getEndpoints(){const{fineTuneType:t}=this.props.params,e=(0,w.$s)(t),i=[["notifications","/users/me/notifications/"],["fineTuneData",`/users/me/notifications/${e}/`]];return(0,w.yB)(e)&&i.push(["projects","/projects/"]),i.push(["emails","/users/me/emails/"]),"email"===e&&i.push(["emails","/users/me/emails/"]),i}get emailChoices(){return this.state.emails?.filter((t=>{let{isVerified:e}=t;return e}))?.sort(((t,e)=>t.isPrimary?-1:e.isPrimary?1:t.email<e.email?-1:1))??[]}renderBody(){const{params:t}=this.props,{fineTuneType:e}=t,i=(0,w.$s)(e);if(R.includes(i))return(0,j.tZ)(V,{notificationType:i});const{notifications:n,projects:o,fineTuneData:a,projectsPageLinks:m}=this.state,f=(0,w.yB)(i),g=h[i],{title:y,description:b}=g,[v,Z]=f?this.getEndpoints()[2]:[],S=!!o?.length;return"email"===i&&(g.options=this.emailChoices.map((t=>{let{email:e}=t;return{value:e,label:e}}))),n&&a?(0,j.BX)("div",{children:[(0,j.tZ)(A.Z,{title:y}),b&&(0,j.tZ)(I.Z,{children:b}),g&&g.defaultFieldName&&"weeklyReports"!==g.defaultFieldName&&(0,j.tZ)(r.Z,{saveOnBlur:!0,apiMethod:"PUT",apiEndpoint:"/users/me/notifications/",initialData:n,children:(0,j.tZ)(l.Z,{title:`Default ${y}`,fields:[u.fields[g.defaultFieldName]]})}),(0,j.tZ)(p.s_,{children:(0,j.BX)(p.N,{children:[(0,j.BX)(p.V9,{hasButtons:f,children:[(0,j.tZ)($,{children:f?(0,d.t)("Projects"):(0,d.t)("Organizations")}),(0,j.tZ)("div",{children:f&&this.renderSearchInput({placeholder:(0,d.t)("Search Projects"),url:Z,stateKey:v})})]}),(0,j.BX)(r.Z,{saveOnBlur:!0,apiMethod:"PUT",apiEndpoint:`/users/me/notifications/${i}/`,initialData:a,children:[f&&S&&(0,j.tZ)(U,{projects:o,field:g}),f&&!S&&(0,j.tZ)(s.Z,{children:(0,d.t)("No projects found")}),!f&&(0,j.tZ)(W,{field:g})]})]})}),o&&(0,j.tZ)(c.Z,{pageLinks:m,...this.props})]}):null}}const $=(0,n.Z)("div",{target:"e1a4qntk0"})({name:"82a6rk",styles:"flex:1"}),G=Y},"./app/views/settings/components/defaultSearchBar.tsx":(t,e,i)=>{i.d(e,{_:()=>s});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=i("./app/styles/space.tsx");const s=(0,n.Z)("div",{target:"e1wlcrsk0"})("display:flex;grid-template-columns:1fr max-content;gap:",(0,o.D)(1.5),";margin-top:",(0,o.D)(4),";margin-bottom:",(0,o.D)(1.5),";position:relative;")}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_account_accountNotificationFineTuning_tsx.18fe055fff7a5b0bfe34144b485662ae.js.map