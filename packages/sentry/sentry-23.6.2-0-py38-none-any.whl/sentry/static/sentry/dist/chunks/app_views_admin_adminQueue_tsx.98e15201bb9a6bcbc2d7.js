"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_admin_adminQueue_tsx"],{"./app/components/internalStatChart.tsx":(e,t,s)=>{s.d(t,{Z:()=>c});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=s("../node_modules/react/index.js"),a=s("./app/components/charts/miniBarChart.tsx"),o=s("./app/components/loadingError.tsx"),r=s("./app/components/loadingIndicator.tsx"),l=s("./app/utils/withApi.tsx"),d=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class h extends i.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{error:!1,loading:!0,data:null}),(0,n.Z)(this,"fetchData",(()=>{this.setState({loading:!0}),this.props.api.request("/internal/stats/",{method:"GET",data:{since:this.props.since,resolution:this.props.resolution,key:this.props.stat},success:e=>this.setState({data:e,loading:!1,error:!1}),error:()=>this.setState({error:!0,loading:!1})})}))}componentDidMount(){this.fetchData()}shouldComponentUpdate(e,t){return this.state.loading!==t.loading}componentDidUpdate(e){e.since===this.props.since&&e.stat===this.props.stat&&e.resolution===this.props.resolution||this.fetchData()}render(){const{loading:e,error:t,data:s}=this.state,{label:n,height:i}=this.props;if(e)return(0,d.tZ)(r.Z,{});if(t)return(0,d.tZ)(o.Z,{onRetry:this.fetchData});const l={seriesName:n,data:s?.map((e=>{let[t,s]=e;return{name:1e3*t,value:s}}))??[]};return(0,d.tZ)(a.Z,{height:i??150,series:[l],isGroupedByDate:!0,showTimeInTooltip:!0,labelYAxisExtents:!0})}}h.displayName="InternalStatChart";const c=(0,l.Z)(h)},"./app/views/admin/adminQueue.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>p});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/es.error.cause.js"),s("./app/components/button.tsx")),a=s("./app/components/buttonBar.tsx"),o=s("./app/components/forms/controls/selectControl.tsx"),r=s("./app/components/internalStatChart.tsx"),l=s("./app/components/panels/index.tsx"),d=s("./app/views/asyncView.tsx"),h=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const c=["1h","1d","1w"];class p extends d.Z{getDefaultState(){return{...super.getDefaultState(),timeWindow:"1w",since:(new Date).getTime()/1e3-604800,resolution:"1h",taskName:null}}getEndpoints(){return[["taskList","/internal/queue/tasks/"]]}changeWindow(e){let t;if("1h"===e)t=3600;else if("1d"===e)t=86400;else{if("1w"!==e)throw new Error("Invalid time window");t=604800}this.setState({since:(new Date).getTime()/1e3-t,timeWindow:e})}changeTask(e){this.setState({activeTask:e})}renderBody(){const{activeTask:e,taskList:t}=this.state;return(0,h.BX)("div",{children:[(0,h.BX)(m,{children:[(0,h.tZ)("h3",{children:"Queue Overview"}),(0,h.tZ)(a.ZP,{merged:!0,active:this.state.timeWindow,children:c.map((e=>(0,h.tZ)(i.zx,{size:"sm",barId:e,onClick:()=>this.changeWindow(e),children:e},e)))})]}),(0,h.BX)(l.s_,{children:[(0,h.tZ)(l.V9,{children:"Global Throughput"}),(0,h.tZ)(l.N,{withPadding:!0,children:(0,h.tZ)(r.Z,{since:this.state.since,resolution:this.state.resolution,stat:"jobs.all.started",label:"jobs started"})})]}),(0,h.tZ)("h3",{children:"Task Details"}),(0,h.BX)("div",{children:[(0,h.BX)("div",{className:"m-b-1",children:[(0,h.tZ)("label",{children:"Show details for task:"}),(0,h.tZ)(o.Z,{name:"task",onChange:e=>{let{value:t}=e;return this.changeTask(t)},value:e,clearable:!0,options:t.map((e=>({value:e,label:e})))})]}),e?(0,h.BX)("div",{children:[(0,h.BX)(l.s_,{children:[(0,h.BX)(l.V9,{children:["Jobs Started ",(0,h.tZ)("small",{children:e})]}),(0,h.tZ)(l.N,{withPadding:!0,children:(0,h.tZ)(r.Z,{since:this.state.since,resolution:this.state.resolution,stat:`jobs.started.${e}`,label:"jobs",height:100})})]},`jobs.started.${e}`),(0,h.BX)(l.s_,{children:[(0,h.BX)(l.V9,{children:["Jobs Finished ",(0,h.tZ)("small",{children:e})]}),(0,h.tZ)(l.N,{withPadding:!0,children:(0,h.tZ)(r.Z,{since:this.state.since,resolution:this.state.resolution,stat:`jobs.finished.${e}`,label:"jobs",height:100})})]},`jobs.finished.${e}`)]}):null]})]})}}const m=(0,n.Z)("div",{target:"ep5vcnk0"})({name:"1066lcq",styles:"display:flex;justify-content:space-between;align-items:center"})},"./app/views/asyncView.tsx":(e,t,s)=>{s.d(t,{Z:()=>o});var n=s("./app/components/asyncComponent.tsx"),i=s("./app/components/sentryDocumentTitle.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class o extends n.Z{getTitle(){return""}render(){return(0,a.tZ)(i.Z,{title:this.getTitle(),children:this.renderComponent()})}}o.displayName="AsyncView"}}]);
//# sourceMappingURL=../sourcemaps/app_views_admin_adminQueue_tsx.072d7fe1eee4cac0a0799b9ad335a975.js.map