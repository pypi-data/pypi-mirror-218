"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_admin_adminOverview_index_tsx"],{"./app/views/admin/adminOverview/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>S});var r=s("../node_modules/react/index.js"),a=s("./app/components/panels/index.tsx"),i=s("./app/components/sentryDocumentTitle.tsx"),n=s("./app/locale.tsx"),o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),p=s("./app/components/charts/miniBarChart.tsx"),c=s("./app/components/loadingError.tsx"),l=s("./app/components/loadingIndicator.tsx"),h=s("./app/utils/theme.tsx"),d=s("./app/utils/withApi.tsx"),u=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const m={error:!1,loading:!0,rawData:{"client-api.all-versions.responses.2xx":[],"client-api.all-versions.responses.4xx":[],"client-api.all-versions.responses.5xx":[]}};class x extends r.Component{constructor(){super(...arguments),(0,o.Z)(this,"state",m),(0,o.Z)(this,"fetchData",(()=>{["client-api.all-versions.responses.2xx","client-api.all-versions.responses.4xx","client-api.all-versions.responses.5xx"].forEach((e=>{this.props.api.request("/internal/stats/",{method:"GET",data:{since:this.props.since,resolution:this.props.resolution,key:e},success:t=>{this.setState((s=>{const r=s.rawData;return r[e]=t,{rawData:r}}),this.requestFinished)},error:()=>{this.setState({error:!0})}})}))})),(0,o.Z)(this,"requestFinished",(()=>{const{rawData:e}=this.state;e["client-api.all-versions.responses.2xx"]&&e["client-api.all-versions.responses.4xx"]&&e["client-api.all-versions.responses.5xx"]&&this.setState({loading:!1})}))}UNSAFE_componentWillMount(){this.fetchData()}UNSAFE_componentWillReceiveProps(e){this.props.since!==e.since&&this.setState(m,this.fetchData)}processRawSeries(e){return e.map((e=>({name:1e3*e[0],value:e[1]})))}getChartSeries(){const{rawData:e}=this.state;return[{seriesName:"2xx",data:this.processRawSeries(e["client-api.all-versions.responses.2xx"]),color:h.ZP.green200},{seriesName:"4xx",data:this.processRawSeries(e["client-api.all-versions.responses.4xx"]),color:h.ZP.blue300},{seriesName:"5xx",data:this.processRawSeries(e["client-api.all-versions.responses.5xx"]),color:h.ZP.red200}]}render(){const{loading:e,error:t}=this.state;if(e)return(0,u.tZ)(l.Z,{});if(t)return(0,u.tZ)(c.Z,{onRetry:this.fetchData});const s=this.getChartSeries(),r=s.map((e=>{let{color:t}=e;return t}));return(0,u.tZ)(p.Z,{series:s,colors:r,height:110,stacked:!0,isGroupedByDate:!0,showTimeInTooltip:!0,labelYAxisExtents:!0})}}x.displayName="ApiChart";const v=(0,d.Z)(x),Z={error:!1,loading:!0,rawData:{"events.total":[],"events.dropped":[]},stats:{received:[],rejected:[]}};class w extends r.Component{constructor(){super(...arguments),(0,o.Z)(this,"state",Z),(0,o.Z)(this,"fetchData",(()=>{["events.total","events.dropped"].forEach((e=>{this.props.api.request("/internal/stats/",{method:"GET",data:{since:this.props.since,resolution:this.props.resolution,key:e},success:t=>{this.setState((s=>{const r=s.rawData;return r[e]=t,{rawData:r}}),this.requestFinished)},error:()=>{this.setState({error:!0})}})}))}))}UNSAFE_componentWillMount(){this.fetchData()}UNSAFE_componentWillReceiveProps(e){this.props.since!==e.since&&this.setState(Z,this.fetchData)}requestFinished(){const{rawData:e}=this.state;e["events.total"]&&e["events.dropped"]&&this.processOrgData()}processOrgData(){const{rawData:e}=this.state,t={},s={},r=[0,0];e["events.total"].forEach(((a,i)=>{const n=a[1],o=e["events.dropped"][i]?.[1],p=a[0];void 0===t[p]?(t[p]=n,s[p]=o):(t[p]+=n,s[p]+=o),n>0&&(r[0]+=n,r[1]+=1)})),this.setState({stats:{rejected:Object.keys(s).map((e=>({name:1e3*parseInt(e,10),value:s[e]||0}))),accepted:Object.keys(t).map((e=>({name:1e3*parseInt(e,10),value:t[e]-s[e]})))},loading:!1})}getChartSeries(){const{stats:e}=this.state;return[{seriesName:(0,n.t)("Accepted"),data:e.accepted,color:h.ZP.blue300},{seriesName:(0,n.t)("Dropped"),data:e.rejected,color:h.ZP.red200}]}render(){const{loading:e,error:t}=this.state;if(e)return(0,u.tZ)(l.Z,{});if(t)return(0,u.tZ)(c.Z,{onRetry:this.fetchData});const s=this.getChartSeries(),r=s.map((e=>{let{color:t}=e;return t}));return(0,u.tZ)(p.Z,{series:s,colors:r,height:110,stacked:!0,isGroupedByDate:!0,showTimeInTooltip:!0,labelYAxisExtents:!0})}}w.displayName="EventChart";const D=(0,d.Z)(w);function g(){const e=(new Date).getTime()/1e3-604800;return(0,u.tZ)(i.Z,{title:(0,n.t)("Admin Overview"),children:(0,u.BX)(r.Fragment,{children:[(0,u.tZ)("h3",{children:(0,n.t)("System Overview")}),(0,u.BX)(a.s_,{children:[(0,u.tZ)(a.V9,{children:(0,n.t)("Event Throughput")}),(0,u.tZ)(a.N,{withPadding:!0,children:(0,u.tZ)(D,{since:e,resolution:"1h"})})]},"events"),(0,u.BX)(a.s_,{children:[(0,u.tZ)(a.V9,{children:(0,n.t)("API Responses")}),(0,u.tZ)(a.N,{withPadding:!0,children:(0,u.tZ)(v,{since:e,resolution:"1h"})})]},"api")]})})}g.displayName="AdminOverview";const S=g}}]);
//# sourceMappingURL=../sourcemaps/app_views_admin_adminOverview_index_tsx.828d38573b5380b705adb22c02125151.js.map