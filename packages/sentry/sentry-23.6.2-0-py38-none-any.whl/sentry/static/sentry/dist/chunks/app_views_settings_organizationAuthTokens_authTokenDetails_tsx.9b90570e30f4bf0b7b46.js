"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_organizationAuthTokens_authTokenDetails_tsx"],{"./app/views/settings/organizationAuthTokens/authTokenDetails.tsx":(t,e,n)=>{n.r(e),n.d(e,{OrganizationAuthTokensDetails:()=>v,default:()=>D,makeFetchOrgAuthTokenKey:()=>b}),n("../node_modules/core-js/modules/es.array.push.js");var o=n("../node_modules/react/index.js"),s=n("../node_modules/react-router/es/index.js"),a=n("./app/actionCreators/indicator.tsx"),i=n("./app/components/forms/fieldGroup/index.tsx"),r=n("./app/components/forms/fields/textField.tsx"),l=n("./app/components/forms/form.tsx"),u=n("./app/components/links/externalLink.tsx"),p=n("./app/components/loadingError.tsx"),d=n("./app/components/loadingIndicator.tsx"),h=n("./app/components/panels/index.tsx"),c=n("./app/components/sentryDocumentTitle.tsx"),g=n("./app/locale.tsx"),m=n("./app/utils/handleXhrErrorResponse.tsx"),k=n("./app/utils/queryClient.tsx"),x=n("./app/utils/useApi.tsx"),Z=n("./app/utils/withDomainRequired.tsx"),y=n("./app/utils/withOrganization.tsx"),T=n("./app/views/settings/components/settingsPageHeader.tsx"),f=n("./app/views/settings/components/text/textBlock.tsx"),w=n("./app/views/settings/organizationAuthTokens/index.tsx"),A=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const b=t=>{let{orgSlug:e,tokenId:n}=t;return[`/organizations/${e}/org-auth-tokens/${n}/`]};function z(t){let{token:e,organization:n}=t;const u={name:e.name,tokenPreview:(0,w.tokenPreview)(e.tokenLastCharacters||"****")},p=(0,x.Z)(),d=(0,k.NL)(),h=(0,o.useCallback)((()=>{s.browserHistory.push((0,Z.D)(`/settings/${n.slug}/auth-tokens/`))}),[n.slug]),{mutate:c}=(0,k.Db)({mutationFn:t=>{let{name:o}=t;return p.requestPromise(`/organizations/${n.slug}/org-auth-tokens/${e.id}/`,{method:"PUT",data:{name:o}})},onSuccess:(t,o)=>{let{name:s}=o;(0,a.S9)((0,g.t)("Updated auth token.")),(0,k.XN)(d,b({orgSlug:n.slug,tokenId:e.id}),(t=>t?(t.name=s,t):t)),(0,k.nE)(d,(0,w.makeFetchOrgAuthTokensForOrgQueryKey)({orgSlug:n.slug}))&&(0,k.XN)(d,(0,w.makeFetchOrgAuthTokensForOrgQueryKey)({orgSlug:n.slug}),(t=>{if(!Array.isArray(t))return t;const n=t.find((t=>t.id===e.id));return n&&(n.name=s),t})),h()},onError:t=>{const e=(0,g.t)("Failed to update the auth token.");(0,m.X)(e,t),(0,a.Iw)(e)}});return(0,A.BX)(l.Z,{apiMethod:"PUT",initialData:u,apiEndpoint:`/organizations/${n.slug}/org-auth-tokens/${e.id}/`,onSubmit:t=>{let{name:e}=t;return(0,a.E3)(),c({name:e})},onCancel:h,children:[(0,A.tZ)(r.Z,{name:"name",label:(0,g.t)("Name"),required:!0,help:(0,g.t)("A name to help you identify this token.")}),(0,A.tZ)(r.Z,{name:"tokenPreview",label:(0,g.t)("Token"),disabled:!0,help:(0,g.t)("You can only view the token once after creation.")}),(0,A.tZ)(i.Z,{label:(0,g.t)("Scopes"),help:(0,g.t)("You cannot change the scopes of an existing token."),children:(0,A.tZ)("div",{children:e.scopes.slice().sort().join(", ")})})]})}function v(t){let{params:e,organization:n}=t;const{tokenId:o}=e,{isLoading:s,isError:a,data:i,refetch:r}=(0,k.WE)(b({orgSlug:n.slug,tokenId:o}),{staleTime:1/0});return(0,A.BX)("div",{children:[(0,A.tZ)(c.Z,{title:(0,g.t)("Edit Auth Token")}),(0,A.tZ)(T.Z,{title:(0,g.t)("Edit Auth Token")}),(0,A.tZ)(f.Z,{children:(0,g.t)("Authentication tokens allow you to perform actions against the Sentry API on behalf of your organization. They're the easiest way to get started using the API.")}),(0,A.tZ)(f.Z,{children:(0,g._N)("For more information on how to use the web API, see our [link:documentation].",{link:(0,A.tZ)(u.Z,{href:"https://docs.sentry.io/api/"})})}),(0,A.BX)(h.s_,{children:[(0,A.tZ)(h.V9,{children:(0,g.t)("Auth Token Details")}),(0,A.BX)(h.N,{children:[a&&(0,A.tZ)(p.Z,{message:(0,g.t)("Failed to load auth token."),onRetry:r}),s&&(0,A.tZ)(d.Z,{}),!s&&!a&&i&&(0,A.tZ)(z,{token:i,organization:n})]})]})]})}z.displayName="AuthTokenDetailsForm",v.displayName="OrganizationAuthTokensDetails";const D=(0,y.Z)(v)}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationAuthTokens_authTokenDetails_tsx.d20708fbb54aae867c9c903937800b37.js.map