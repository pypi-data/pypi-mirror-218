"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_organizationTeams_teamMembers_tsx"],{"./app/components/roleSelectControl.tsx":(e,t,s)=>{s.d(t,{Z:()=>n});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=s("./app/components/forms/controls/selectControl.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{roles:t,disableUnallowed:s,...r}=e;return(0,a.tZ)(o.Z,{options:t?.map((e=>({value:e.id,label:e.name,disabled:s&&!e.allowed||e.isRetired,details:(0,a.tZ)(m,{children:e.desc})}))),showDividers:!0,...r})}i.displayName="RoleSelectControl";const n=i,m=(0,r.Z)("span",{target:"eu9y8de0"})({name:"vad6xm",styles:"display:inline-block;width:20rem"})},"./app/components/teamRoleSelect.tsx":(e,t,s)=>{s.d(t,{Z:()=>d});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/core-js/modules/es.array.push.js"),s("./app/components/roleSelectControl.tsx")),a=s("./app/styles/space.tsx"),i=s("./app/utils/orgRole.tsx"),n=s("./app/views/settings/organizationTeams/roleOverwriteWarning.tsx"),m=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(e){let{organization:t,team:s,member:r,onChangeTeamRole:a,disabled:l,size:d}=e;const{orgRoleList:u,teamRoleList:g,features:h}=t;if(!h.includes("team-roles"))return null;const b=[r.orgRole];r.groupOrgRoles&&r.groupOrgRoles.length>0&&b.push(r.groupOrgRoles[0].role.id),s.orgRole&&b.push(s.orgRole);const x=(0,i.M)(b,u);if((0,n.d8)({orgRole:x?.id,orgRoleList:u,teamRoleList:g})){const e=g.find((e=>e.id===x?.minimumTeamRole));return(0,m.BX)(p,{children:[e?.name||x?.minimumTeamRole,(0,m.tZ)(c,{children:(0,m.tZ)(n.Sk,{orgRole:x?.id,orgRoleList:u,teamRoleList:g})})]})}const Z=r.teamRole||r.teamRoles?.find((e=>e.teamSlug===s.slug))?.role||null,f=g.find((e=>e.id===Z))||g[0];return(0,m.tZ)(o.Z,{disabled:l,disableUnallowed:!1,roles:g,value:f.id,onChange:e=>a(e.value),size:d})}l.displayName="TeamRoleSelect";const d=l,p=(0,r.Z)("div",{target:"ermz4er1"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),c=(0,r.Z)("div",{target:"ermz4er0"})("height:",(0,a.D)(2),";margin-left:",(0,a.D)(1),";")},"./app/utils/orgRole.tsx":(e,t,s)=>{function r(e,t){const s=t.reduce(((e,t,s)=>(e[t.id]={index:s,role:t},e)),{});return e.sort(((e,t)=>s[t].index-s[e].index)),s[e[0]]?.role}s.d(t,{M:()=>r})},"./app/views/asyncView.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var r=s("./app/components/asyncComponent.tsx"),o=s("./app/components/sentryDocumentTitle.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class i extends r.Z{getTitle(){return""}render(){return(0,a.tZ)(o.Z,{title:this.getTitle(),children:this.renderComponent()})}}i.displayName="AsyncView"},"./app/views/settings/organizationTeams/roleOverwriteWarning.tsx":(e,t,s)=>{s.d(t,{Sk:()=>m,d8:()=>d,pu:()=>l});var r=s("./app/components/panels/index.tsx"),o=s("./app/components/tooltip.tsx"),a=s("./app/icons/index.tsx"),i=s("./app/locale.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(e){return d(e)?(0,n.tZ)(o.u,{title:p(e),children:(0,n.tZ)(a.aU,{size:"sm",color:"gray300"})}):null}function l(e){return d(e)?(0,n.tZ)(r.aU,{"data-test-id":"alert-role-overwrite",children:p(e)}):null}function d(e){const{orgRole:t,orgRoleList:s,teamRoleList:r}=e,o=s.find((e=>e.id===t));return r.findIndex((e=>e.id===o?.minimumTeamRole))>0}function p(e){const{orgRole:t,orgRoleList:s,teamRoleList:r,isSelf:o}=e,a=s.find((e=>e.id===t)),m=r.find((e=>e.id===a?.minimumTeamRole));return a&&m?(0,i._N)("[selfNoun] organization role as [article] [orgRole] has granted [selfPronoun] a minimum team-level role of [teamRole]",{selfNoun:o?"Your":"This user's",selfPronoun:o?"you":"them",article:"AEIOU".includes(a.name[0])?"an":"a",orgRole:(0,n.tZ)("strong",{children:a.name}),teamRole:(0,n.tZ)("strong",{children:m.name})}):""}m.displayName="RoleOverwriteIcon",l.displayName="RoleOverwritePanelAlert"},"./app/views/settings/organizationTeams/teamMembers.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>W});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(s("../node_modules/core-js/modules/es.regexp.flags.js"),s("../node_modules/react/index.js")),i=s("../node_modules/lodash/debounce.js"),n=s.n(i),m=s("./app/actionCreators/indicator.tsx"),l=s("./app/actionCreators/modal.tsx"),d=s("./app/actionCreators/teams.tsx"),p=s("./app/components/acl/access.tsx"),c=s("./app/components/avatar/userAvatar.tsx"),u=s("./app/components/dropdownAutoComplete/index.tsx"),g=s("./app/components/dropdownButton.tsx"),h=s("./app/components/emptyMessage.tsx"),b=s("./app/components/links/link.tsx"),x=s("./app/components/loadingError.tsx"),Z=s("./app/components/pagination.tsx"),f=s("./app/components/panels/index.tsx"),v=s("./app/icons/index.tsx"),w=s("./app/locale.tsx"),y=s("./app/styles/space.tsx"),R=s("./app/utils/withApi.tsx"),M=s("./app/utils/withConfig.tsx"),z=s("./app/utils/withOrganization.tsx"),T=s("./app/views/asyncView.tsx"),S=s("./app/views/settings/components/text/textBlock.tsx"),j=s("./app/components/button.tsx"),C=s("./app/components/idBadge/index.tsx"),O=s("./app/components/teamRoleSelect.tsx"),I=s("./app/views/settings/organizationTeams/utils.tsx"),_=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function k(e){let{organization:t,team:s,member:r,user:o,hasWriteAccess:a,isOrgOwner:i,removeMember:n,updateMemberRole:m}=e;const l=o.email===r.email;return(0,_.BX)(q,{children:[(0,_.tZ)("div",{children:(0,_.tZ)(C.Z,{avatarSize:36,member:r,useLink:!0,orgId:t.slug})}),(0,_.tZ)(A,{children:(0,_.tZ)(O.Z,{disabled:l||!a,organization:t,team:s,member:r,onChangeTeamRole:e=>m(r,e)})}),(0,_.tZ)("div",{children:(0,_.tZ)(B,{hasWriteAccess:a,hasOrgRoleFromTeam:null!==s.orgRole,isOrgOwner:i,isSelf:l,onClick:()=>n(r),member:r})})]},r.id)}function B(e){const{member:t,hasWriteAccess:s,isOrgOwner:r,isSelf:o,hasOrgRoleFromTeam:a,onClick:i}=e,n=s||o;if(!n)return(0,_.tZ)(j.zx,{size:"xs",disabled:!0,icon:(0,_.tZ)(v.JZ,{size:"xs",isCircled:!0}),"aria-label":(0,w.t)("Remove"),title:(0,w.t)("You do not have permission to remove a member from this team."),children:(0,w.t)("Remove")});const m=t.flags["idp:provisioned"],l=a&&!r,d=(0,I.m)(m,l);if(m||l)return(0,_.tZ)(j.zx,{size:"xs",disabled:!0,icon:(0,_.tZ)(v.JZ,{size:"xs",isCircled:!0}),"aria-label":(0,w.t)("Remove"),title:d,children:(0,w.t)("Remove")});const p=o?(0,w.t)("Leave"):(0,w.t)("Remove");return(0,_.tZ)(j.zx,{"data-test-id":`button-remove-${t.id}`,size:"xs",disabled:!n,icon:(0,_.tZ)(v.JZ,{size:"xs",isCircled:!0}),onClick:i,"aria-label":p,children:p})}k.displayName="TeamMembersRow",B.displayName="RemoveButton";const A=(0,o.Z)("div",{target:"eqg848x1"})({name:"5b6t4c",styles:"display:flex;flex-direction:row;align-items:center;>div:first-child{flex-grow:1;}"}),q=(0,o.Z)(f.Lv,{target:"eqg848x0"})("display:grid;grid-template-columns:minmax(120px, 4fr) minmax(120px, 2fr) minmax(100px, 1fr);gap:",(0,y.D)(2),";align-items:center;>div:last-child{margin-left:auto;}"),L=k;var D=s("./app/views/settings/project/permissionAlert.tsx");class N extends T.Z{constructor(){super(...arguments),(0,r.Z)(this,"debouncedFetchMembersRequest",n()((e=>this.setState({dropdownBusy:!0},(()=>this.fetchMembersRequest(e)))),200)),(0,r.Z)(this,"fetchMembersRequest",(async e=>{const{organization:t,api:s}=this.props;try{const r=await s.requestPromise(`/organizations/${t.slug}/members/`,{query:{query:e}});this.setState({orgMembers:r,dropdownBusy:!1})}catch(e){(0,m.Iw)((0,w.t)("Unable to load organization members."),{duration:2e3}),this.setState({dropdownBusy:!1})}})),(0,r.Z)(this,"addTeamMember",(e=>{const{organization:t,params:s}=this.props,{orgMembers:r,teamMembers:o}=this.state;this.debouncedFetchMembersRequest(""),(0,d.um)(this.props.api,{orgId:t.slug,teamId:s.teamId,memberId:e.value},{success:()=>{const t=r.find((t=>t.id===e.value));void 0!==t&&(this.setState({error:!1,teamMembers:o.concat([t])}),(0,m.S9)((0,w.t)("Successfully added member to team.")))},error:()=>{(0,m.Iw)((0,w.t)("Unable to add team member."))}})})),(0,r.Z)(this,"removeTeamMember",(e=>{const{organization:t,params:s}=this.props,{teamMembers:r}=this.state;(0,d.s)(this.props.api,{orgId:t.slug,teamId:s.teamId,memberId:e.id},{success:()=>{this.setState({teamMembers:r.filter((t=>t.id!==e.id))}),(0,m.S9)((0,w.t)("Successfully removed member from team."))},error:()=>(0,m.Iw)((0,w.t)("There was an error while trying to remove a member from the team."))})})),(0,r.Z)(this,"updateTeamMemberRole",((e,t)=>{const{organization:s}=this.props,{teamId:r}=this.props.params,o=`/organizations/${s.slug}/members/${e.id}/teams/${r}/`;this.props.api.request(o,{method:"PUT",data:{teamRole:t},success:t=>{const s=[...this.state.teamMembers],r=s.findIndex((t=>t.id===e.id));s[r]={...e,teamRole:t.teamRole},this.setState({teamMembers:s}),(0,m.S9)((0,w.t)("Successfully changed role for team member."))},error:()=>{(0,m.Iw)((0,w.t)("There was an error while trying to change the roles for a team member."))}})})),(0,r.Z)(this,"handleMemberFilterChange",(e=>{this.setState({dropdownBusy:!0}),this.debouncedFetchMembersRequest(e.target.value)}))}getDefaultState(){return{...super.getDefaultState(),error:!1,dropdownBusy:!1,teamMembers:[],orgMembers:[]}}componentDidMount(){super.componentDidMount(),this.fetchMembersRequest("")}getEndpoints(){const{organization:e,params:t}=this.props;return[["teamMembers",`/teams/${e.slug}/${t.teamId}/members/`,{},{paginate:!0}]]}renderDropdown(e){const{organization:t,params:s,team:r}=this.props,{orgMembers:o}=this.state,a=new Set(this.state.teamMembers.map((e=>e.id))),i=!!t?.openMembership||e,n=r.flags["idp:provisioned"],m=(o||[]).filter((e=>!a.has(e.id))).map((e=>({searchKey:`${e.name} ${e.email}`,value:e.id,label:(0,_.BX)(P,{children:[(0,_.tZ)($,{user:e,size:24,className:"avatar"}),(0,_.tZ)(F,{children:e.name||e.email})]})}))),d=(0,_.BX)(U,{children:[(0,w.t)("Members"),(0,_.tZ)(X,{to:"",onClick:()=>(0,l.openInviteMembersModal)({source:"teams"}),"data-test-id":"invite-member",children:(0,w.t)("Invite Member")})]});return(0,_.tZ)(u.Z,{closeOnSelect:!1,items:m,alignMenu:"right",onSelect:i?this.addTeamMember:e=>(0,l.openTeamAccessRequestModal)({teamId:s.teamId,orgId:t.slug,memberId:e.value}),menuHeader:d,emptyMessage:(0,w.t)("No members"),onChange:this.handleMemberFilterChange,busy:this.state.dropdownBusy,onClose:()=>this.debouncedFetchMembersRequest(""),disabled:n,"data-test-id":"add-member-menu",children:e=>{let{isOpen:t}=e;return(0,_.tZ)(g.Z,{isOpen:t,size:"xs","data-test-id":"add-member",disabled:n,children:(0,w.t)("Add Member")})}})}renderPageTextBlock(){const{organization:e,team:t}=this.props,{openMembership:s}=e,r=t.flags["idp:provisioned"];return r?(0,I.m)(r):s?(0,w.t)('"Open Membership" is enabled for the organization. Anyone can add members for this team.'):(0,w.t)('"Open Membership" is disabled for the organization. Org Owner/Manager/Admin, or Team Admins can add members for this team.')}render(){if(this.state.error)return(0,_.tZ)(x.Z,{onRetry:this.fetchData});const{organization:e,config:t,team:s}=this.props,{teamMembersPageLinks:r}=this.state,{access:o,openMembership:i}=e,n=(0,p.d)(["org:write"],{organization:e,team:s}),m=(0,p.d)(["team:admin"],{organization:e,team:s}),l=n||m,d=o.includes("org:admin");return(0,_.BX)(a.Fragment,{children:[(0,_.tZ)(S.Z,{children:this.renderPageTextBlock()}),(0,_.tZ)(D.Z,{access:i?["org:read"]:["team:write"],team:s}),(0,_.BX)(f.s_,{children:[(0,_.BX)(f.V9,{hasButtons:!0,children:[(0,_.tZ)("div",{children:(0,w.t)("Members")}),(0,_.tZ)("div",{style:{textTransform:"none"},children:this.renderDropdown(l)})]}),this.state.teamMembers.length?this.state.teamMembers.map((r=>(0,_.tZ)(L,{hasWriteAccess:l,isOrgOwner:d,organization:e,team:s,member:r,user:t.user,removeMember:this.removeTeamMember,updateMemberRole:this.updateTeamMemberRole},r.id))):(0,_.tZ)(h.Z,{icon:(0,_.tZ)(v.qO,{size:"xl"}),size:"large",children:(0,w.t)("This team has no members")})]}),(0,_.tZ)(Z.Z,{pageLinks:r})]})}}N.displayName="TeamMembers";const P=(0,o.Z)("div",{target:"e1anr5pt4"})("display:grid;grid-template-columns:max-content 1fr;gap:",(0,y.D)(.5),";align-items:center;"),F=(0,o.Z)("div",{target:"e1anr5pt3"})("font-size:",(e=>e.theme.fontSizeSmall),";",(e=>e.theme.overflowEllipsis),";"),$=(0,o.Z)((e=>(0,_.tZ)(c.Z,{...e})),{target:"e1anr5pt2"})({name:"1dy9mco",styles:"min-width:1.75em;min-height:1.75em;width:1.5em;height:1.5em"}),U=(0,o.Z)("div",{target:"e1anr5pt1"})("display:grid;grid-template-columns:1fr max-content;padding:",(0,y.D)(1)," 0;font-size:",(e=>e.theme.fontSizeExtraSmall),";text-transform:uppercase;"),X=(0,o.Z)(b.Z,{target:"e1anr5pt0"})({name:"kxbue8",styles:"text-transform:none"}),W=(0,M.Z)((0,R.Z)((0,z.Z)(N)))},"./app/views/settings/organizationTeams/utils.tsx":(e,t,s)=>{s.d(t,{m:()=>o});var r=s("./app/locale.tsx");function o(){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(0,r.t)("Membership to this team is managed through your organization's identity provider."):e?(0,r.t)("Membership to a team with an organization role is managed by org owners."):void 0}},"./app/views/settings/project/permissionAlert.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var r=s("./app/components/acl/access.tsx"),o=s("./app/components/alert.tsx"),a=s("./app/locale.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const n=(0,a.t)("These settings can only be edited by users with the organization-level owner, manager, or team-level admin roles.");function m(e){let{access:t=["project:write"],project:s,team:a,...m}=e;return(0,i.tZ)(r.Z,{access:t,project:s,team:a,children:e=>{let{hasAccess:t}=e;return!t&&(0,i.tZ)(o.bZ,{"data-test-id":"project-permission-alert",type:"warning",...m,children:n})}})}m.displayName="PermissionAlert";const l=m}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationTeams_teamMembers_tsx.22c76feaed2c889be074c75029e3d508.js.map