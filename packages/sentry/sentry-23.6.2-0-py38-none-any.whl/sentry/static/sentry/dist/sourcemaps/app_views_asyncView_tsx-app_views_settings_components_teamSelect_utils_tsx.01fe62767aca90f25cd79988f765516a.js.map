{"version":3,"file":"chunks/app_views_asyncView_tsx-app_views_settings_components_teamSelect_utils_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/views/asyncView.tsx","webpack:///./app/views/settings/components/teamSelect/utils.tsx","webpack:///./app/views/settings/organizationTeams/utils.tsx"],"sourcesContent":["import AsyncComponent from 'sentry/components/asyncComponent';\nimport SentryDocumentTitle from 'sentry/components/sentryDocumentTitle';\n\nexport type AsyncViewState = AsyncComponent['state'];\nexport type AsyncViewProps = AsyncComponent['props'];\n\nexport default class AsyncView<\n  P extends AsyncViewProps = AsyncViewProps,\n  S extends AsyncViewState = AsyncViewState\n> extends AsyncComponent<P, S> {\n  getTitle() {\n    return '';\n  }\n\n  render() {\n    return (\n      <SentryDocumentTitle title={this.getTitle()}>\n        {this.renderComponent() as React.ReactChild}\n      </SentryDocumentTitle>\n    );\n  }\n}\n","import React from 'react';\nimport {css} from '@emotion/react';\nimport styled from '@emotion/styled';\nimport debounce from 'lodash/debounce';\n\nimport {openCreateTeamModal} from 'sentry/actionCreators/modal';\nimport {hasEveryAccess} from 'sentry/components/acl/access';\nimport DropdownAutoComplete from 'sentry/components/dropdownAutoComplete';\nimport {Item} from 'sentry/components/dropdownAutoComplete/types';\nimport DropdownButton from 'sentry/components/dropdownButton';\nimport {TeamBadge} from 'sentry/components/idBadge/teamBadge';\nimport Link from 'sentry/components/links/link';\nimport {Tooltip} from 'sentry/components/tooltip';\nimport {DEFAULT_DEBOUNCE_DURATION} from 'sentry/constants';\nimport {t} from 'sentry/locale';\nimport {space} from 'sentry/styles/space';\nimport {Organization, Project, Team} from 'sentry/types';\nimport {getButtonHelpText} from 'sentry/views/settings/organizationTeams/utils';\n\nexport type TeamSelectProps = {\n  /**\n   * Should button be disabled\n   */\n  disabled: boolean;\n  /**\n   * callback when teams are added\n   */\n  onAddTeam: (teamSlug: string) => void;\n  /**\n   * Callback when teams are removed\n   */\n  onRemoveTeam: (teamSlug: string) => void;\n  organization: Organization;\n  /**\n   * Used to determine whether we should show a loading state while waiting for teams\n   */\n  loadingTeams?: boolean;\n  /**\n   * Callback when teams are created\n   */\n  onCreateTeam?: (team: Team) => void;\n};\n\nexport function DropdownAddTeam({\n  disabled,\n  isLoadingTeams,\n  isAddingTeamToMember = false,\n  isAddingTeamToProject = false,\n  onSearch,\n  onSelect,\n  onCreateTeam,\n  organization,\n  selectedTeams,\n  teams,\n  project,\n}: {\n  disabled: boolean;\n  isLoadingTeams: boolean;\n  onSearch: (teamSlug: string) => void;\n  onSelect: (teamSlug: string) => void;\n  organization: Organization;\n  selectedTeams: string[];\n  teams: Team[];\n  canCreateTeam?: boolean;\n  isAddingTeamToMember?: boolean;\n  isAddingTeamToProject?: boolean;\n  onCreateTeam?: (team: Team) => void;\n  project?: Project;\n}) {\n  const dropdownItems = teams\n    .filter(team => !selectedTeams.some(slug => slug === team.slug))\n    .map((team, index) =>\n      renderDropdownOption({\n        isAddingTeamToMember,\n        isAddingTeamToProject,\n        organization,\n        team,\n        index,\n        disabled,\n      })\n    );\n\n  const onDropdownChange = debounce<(e: React.ChangeEvent<HTMLInputElement>) => void>(\n    e => onSearch(e.target.value),\n    DEFAULT_DEBOUNCE_DURATION\n  );\n\n  return (\n    <DropdownAutoComplete\n      items={dropdownItems}\n      busyItemsStillVisible={isLoadingTeams}\n      onChange={onDropdownChange}\n      onSelect={(option: Item) => onSelect(option.value)}\n      emptyMessage={t('No teams')}\n      menuHeader={renderDropdownHeader({\n        organization,\n        project,\n        onCreateTeam,\n      })}\n      disabled={disabled}\n      alignMenu=\"right\"\n    >\n      {({isOpen}) => (\n        <DropdownButton\n          aria-label={t('Add Team')}\n          isOpen={isOpen}\n          size=\"xs\"\n          disabled={disabled}\n        >\n          {t('Add Team')}\n        </DropdownButton>\n      )}\n    </DropdownAutoComplete>\n  );\n}\n\nfunction renderDropdownOption({\n  disabled,\n  index,\n  isAddingTeamToMember,\n  organization,\n  team,\n}: {\n  disabled: boolean;\n  index: number;\n  isAddingTeamToMember: boolean;\n  isAddingTeamToProject: boolean;\n  organization: Organization;\n  team: Team;\n}) {\n  const hasOrgAdmin = organization.access.includes('org:admin');\n  const isIdpProvisioned = isAddingTeamToMember && team.flags['idp:provisioned'];\n  const isPermissionGroup = isAddingTeamToMember && team.orgRole !== null && !hasOrgAdmin;\n  const buttonHelpText = getButtonHelpText(isIdpProvisioned, isPermissionGroup);\n\n  return {\n    index,\n    value: team.slug,\n    searchKey: team.slug,\n    label: () => {\n      if (isIdpProvisioned || isPermissionGroup) {\n        return (\n          <Tooltip title={buttonHelpText}>\n            <DropdownTeamBadgeDisabled avatarSize={18} team={team} />\n          </Tooltip>\n        );\n      }\n\n      return <DropdownTeamBadge avatarSize={18} team={team} />;\n    },\n    disabled: disabled || isIdpProvisioned || isPermissionGroup,\n  };\n}\n\nfunction renderDropdownHeader({\n  organization,\n  project,\n  onCreateTeam,\n}: {\n  organization: Organization;\n  onCreateTeam?: (team) => void;\n  project?: Project;\n}) {\n  const canCreateTeam = hasEveryAccess(['org:write'], {organization, project});\n\n  return (\n    <StyledTeamsLabel>\n      <span>{t('Teams')}</span>\n\n      <Tooltip\n        disabled={canCreateTeam}\n        title={t('You must be a Org Owner/Manager to create teams')}\n        position=\"top\"\n      >\n        <StyledCreateTeamLink\n          to=\"#create-team\"\n          disabled={!canCreateTeam}\n          onClick={(e: React.MouseEvent) => {\n            e.stopPropagation();\n            e.preventDefault();\n\n            openCreateTeamModal({\n              organization,\n              project,\n              onClose: onCreateTeam,\n            });\n          }}\n        >\n          {t('Create Team')}\n        </StyledCreateTeamLink>\n      </Tooltip>\n    </StyledTeamsLabel>\n  );\n}\n\nconst DropdownTeamBadge = styled(TeamBadge)`\n  font-weight: normal;\n  font-size: ${p => p.theme.fontSizeMedium};\n  text-transform: none;\n`;\n\nconst DropdownTeamBadgeDisabled = styled(TeamBadge)`\n  font-weight: normal;\n  font-size: ${p => p.theme.fontSizeMedium};\n  text-transform: none;\n  filter: grayscale(1);\n`;\n\nconst StyledTeamsLabel = styled('div')`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  font-size: 0.875em;\n  padding: ${space(0.5)} 0px;\n  text-transform: uppercase;\n`;\n\nconst StyledCreateTeamLink = styled(Link)`\n  float: right;\n  text-transform: none;\n  ${p =>\n    p.disabled &&\n    css`\n      cursor: not-allowed;\n      color: ${p.theme.gray300};\n      opacity: 0.6;\n    `};\n`;\n","import {t} from 'sentry/locale';\n\nexport function getButtonHelpText(\n  isIdpProvisioned: boolean = false,\n  isPermissionGroup: boolean = false\n) {\n  if (isIdpProvisioned) {\n    return t(\n      \"Membership to this team is managed through your organization's identity provider.\"\n    );\n  }\n\n  if (isPermissionGroup) {\n    return t('Membership to a team with an organization role is managed by org owners.');\n  }\n\n  return undefined;\n}\n"],"names":["AsyncView","AsyncComponent","getTitle","render","_jsx","SentryDocumentTitle","title","this","children","renderComponent","displayName","DropdownAddTeam","_ref","disabled","isLoadingTeams","isAddingTeamToMember","isAddingTeamToProject","onSearch","onSelect","onCreateTeam","organization","selectedTeams","teams","project","dropdownItems","filter","team","some","slug","map","index","_ref3","hasOrgAdmin","access","includes","isIdpProvisioned","flags","isPermissionGroup","orgRole","buttonHelpText","getButtonHelpText","value","searchKey","label","Tooltip","DropdownTeamBadgeDisabled","avatarSize","DropdownTeamBadge","renderDropdownOption","onDropdownChange","debounce","e","target","DEFAULT_DEBOUNCE_DURATION","DropdownAutoComplete","items","busyItemsStillVisible","onChange","option","emptyMessage","t","menuHeader","renderDropdownHeader","alignMenu","_ref2","isOpen","DropdownButton","size","_ref4","canCreateTeam","hasEveryAccess","_jsxs","StyledTeamsLabel","position","StyledCreateTeamLink","to","onClick","stopPropagation","preventDefault","openCreateTeamModal","onClose","_styled","TeamBadge","p","theme","fontSizeMedium","space","Link","css","gray300","arguments","length","undefined"],"sourceRoot":""}