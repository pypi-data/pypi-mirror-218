{"version":3,"file":"chunks/app_components_modals_sudoModal_tsx-node_modules_core-js_internals_define-built-in-accessor_js.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/actionCreators/account.tsx","webpack:///./app/components/forms/fields/secretField.tsx","webpack:///./app/components/hook.tsx","webpack:///./app/components/modals/sudoModal.tsx","webpack:///./app/components/u2f/u2fContainer.tsx","webpack:///./app/components/u2f/webAuthnHelper.tsx","webpack:///./app/components/u2f/u2finterface.tsx","webpack:///./app/components/u2f/u2fsign.tsx","webpack:///./app/constants/superuserAccessErrors.tsx","webpack:///./app/utils/useApi.tsx","webpack:///./app/utils/withApi.tsx","webpack:///../node_modules/core-js/internals/define-built-in-accessor.js"],"sourcesContent":["import {addErrorMessage, addSuccessMessage} from 'sentry/actionCreators/indicator';\nimport {Client} from 'sentry/api';\nimport ConfigStore from 'sentry/stores/configStore';\nimport {User, UserIdentityConfig} from 'sentry/types';\n\nexport async function disconnectIdentity(\n  identity: UserIdentityConfig,\n  onSuccess: {(): void}\n) {\n  const api = new Client();\n\n  try {\n    await api.requestPromise(\n      `/users/me/user-identities/${identity.category}/${identity.id}/`,\n      {\n        method: 'DELETE',\n      }\n    );\n  } catch {\n    addErrorMessage('Error disconnecting identity');\n    return;\n  }\n\n  addSuccessMessage(`Disconnected ${identity.provider.name}`);\n  onSuccess();\n}\n\nexport function updateUser(user: User) {\n  const previousUser = ConfigStore.get('user');\n\n  // If the user changed their theme preferences, we should also update\n  // the config store\n  if (\n    previousUser.options.theme !== user.options.theme &&\n    user.options.theme !== 'system'\n  ) {\n    ConfigStore.set('theme', user.options.theme);\n  }\n\n  // Ideally we'd fire an action but this is gonna get refactored soon anyway\n  ConfigStore.set('user', user);\n}\n\nexport function logout(api: Client) {\n  return api.requestPromise('/auth/', {method: 'DELETE'});\n}\n\nexport function removeAuthenticator(api: Client, userId: string, authId: string) {\n  return api.requestPromise(`/users/${userId}/authenticators/${authId}/`, {\n    method: 'DELETE',\n  });\n}\n","import InputField, {InputFieldProps} from './inputField';\n\nexport interface SecretFieldProps extends Omit<InputFieldProps, 'type'> {}\n\nfunction SecretField(props: SecretFieldProps) {\n  // XXX: We explicitly give the password field a aria textbox role. This field\n  // does not typically have a role, but for testability reasons it's preferred\n  // for it to have a role. See [0]\n  //\n  // [0]: https://github.com/testing-library/dom-testing-library/issues/567\n  return <InputField {...props} type=\"password\" role=\"textbox\" />;\n}\n\nexport default SecretField;\n","import {Component} from 'react';\n\nimport HookStore from 'sentry/stores/hookStore';\nimport {HookName, Hooks} from 'sentry/types/hooks';\n\ntype Props<H extends HookName> = {\n  /**\n   * The name of the hook as listed in hookstore.add(hookName, callback)\n   */\n  name: H;\n  /**\n   * If children are provided as a function to the Hook, the hooks will be\n   * passed down as a render prop.\n   */\n  children?: (opts: {hooks: Array<Hooks[H]>}) => React.ReactNode;\n} & Omit<Parameters<Hooks[H]>[0], 'name'>;\n\ntype HookState<H extends HookName> = {\n  hooks: Array<Hooks[H]>;\n};\n\n/**\n * Instead of accessing the HookStore directly, use this.\n *\n * If the hook slot needs to perform anything w/ the hooks, you can pass a\n * function as a child and you will receive an object with a `hooks` key\n *\n * Example:\n *\n *   <Hook name=\"my-hook\">\n *     {({hooks}) => hooks.map(hook => (\n *       <Wrapper>{hook}</Wrapper>\n *     ))}\n *   </Hook>\n */\nfunction Hook<H extends HookName>({name, ...props}: Props<H>) {\n  class HookComponent extends Component<{}, HookState<H>> {\n    static displayName = `Hook(${name})`;\n\n    state = {\n      hooks: HookStore.get(name).map(cb => cb(props)),\n    };\n\n    componentWillUnmount() {\n      this.unsubscribe();\n    }\n\n    handleHooks(hookName: HookName, hooks: Array<Hooks[H]>) {\n      // Make sure that the incoming hook update matches this component's hook name\n      if (hookName !== name) {\n        return;\n      }\n\n      this.setState({hooks: hooks.map(cb => cb(props))});\n    }\n\n    unsubscribe = HookStore.listen(\n      (hookName: HookName, hooks: Array<Hooks[H]>) => this.handleHooks(hookName, hooks),\n      undefined\n    );\n\n    render() {\n      const {children} = props;\n\n      if (!this.state.hooks || !this.state.hooks.length) {\n        return null;\n      }\n\n      if (typeof children === 'function') {\n        return children({hooks: this.state.hooks});\n      }\n\n      return this.state.hooks;\n    }\n  }\n\n  return <HookComponent />;\n}\n\nexport default Hook;\n","import {Component, Fragment} from 'react';\nimport {WithRouterProps} from 'react-router';\nimport styled from '@emotion/styled';\nimport trimEnd from 'lodash/trimEnd';\n\nimport {logout} from 'sentry/actionCreators/account';\nimport {ModalRenderProps} from 'sentry/actionCreators/modal';\nimport {Client} from 'sentry/api';\nimport {Alert} from 'sentry/components/alert';\nimport {Button} from 'sentry/components/button';\nimport SecretField from 'sentry/components/forms/fields/secretField';\nimport Form from 'sentry/components/forms/form';\nimport Hook from 'sentry/components/hook';\nimport U2fContainer from 'sentry/components/u2f/u2fContainer';\nimport {ErrorCodes} from 'sentry/constants/superuserAccessErrors';\nimport {t} from 'sentry/locale';\nimport ConfigStore from 'sentry/stores/configStore';\nimport {space} from 'sentry/styles/space';\nimport {Authenticator} from 'sentry/types';\nimport withApi from 'sentry/utils/withApi';\n// eslint-disable-next-line no-restricted-imports\nimport withSentryRouter from 'sentry/utils/withSentryRouter';\nimport TextBlock from 'sentry/views/settings/components/text/textBlock';\n\ntype OnTapProps = NonNullable<React.ComponentProps<typeof U2fContainer>['onTap']>;\n\ntype Props = WithRouterProps &\n  Pick<ModalRenderProps, 'Body' | 'Header'> & {\n    api: Client;\n    closeModal: () => void;\n    /**\n     * User is a superuser without an active su session\n     */\n    isSuperuser?: boolean;\n    needsReload?: boolean;\n    /**\n     * expects a function that returns a Promise\n     */\n    retryRequest?: () => Promise<any>;\n  };\n\ntype State = {\n  authenticators: Array<Authenticator>;\n  busy: boolean;\n  error: boolean;\n  errorType: string;\n  showAccessForms: boolean;\n  superuserAccessCategory: string;\n  superuserReason: string;\n};\n\nclass SudoModal extends Component<Props, State> {\n  state: State = {\n    authenticators: [],\n    busy: false,\n    error: false,\n    errorType: '',\n    showAccessForms: true,\n    superuserAccessCategory: '',\n    superuserReason: '',\n  };\n\n  componentDidMount() {\n    this.getAuthenticators();\n  }\n\n  handleSubmitCOPS = () => {\n    this.setState({\n      superuserAccessCategory: 'cops_csm',\n      superuserReason: 'COPS and CSM use',\n    });\n  };\n\n  handleSubmit = async data => {\n    const {api, isSuperuser} = this.props;\n    const {superuserAccessCategory, superuserReason, authenticators} = this.state;\n    const disableU2FForSUForm = ConfigStore.get('disableU2FForSUForm');\n\n    const suAccessCategory = superuserAccessCategory || data.superuserAccessCategory;\n\n    const suReason = superuserReason || data.superuserReason;\n\n    if (!authenticators.length && !disableU2FForSUForm) {\n      this.handleError(ErrorCodes.NO_AUTHENTICATOR);\n      return;\n    }\n\n    if (this.state.showAccessForms && isSuperuser && !disableU2FForSUForm) {\n      this.setState({\n        showAccessForms: false,\n        superuserAccessCategory: suAccessCategory,\n        superuserReason: suReason,\n      });\n    } else {\n      try {\n        await api.requestPromise('/auth/', {method: 'PUT', data});\n        this.handleSuccess();\n      } catch (err) {\n        this.handleError(err);\n      }\n    }\n  };\n\n  handleSuccess = () => {\n    const {closeModal, isSuperuser, location, needsReload, router, retryRequest} =\n      this.props;\n\n    if (!retryRequest) {\n      closeModal();\n      return;\n    }\n\n    if (isSuperuser) {\n      router.replace({pathname: location.pathname, state: {forceUpdate: new Date()}});\n      if (needsReload) {\n        window.location.reload();\n      }\n      return;\n    }\n\n    this.setState({busy: true}, () => {\n      retryRequest().then(() => {\n        this.setState({busy: false, showAccessForms: true}, closeModal);\n      });\n    });\n  };\n\n  handleError = err => {\n    let errorType = '';\n    if (err.status === 403) {\n      if (err.responseJSON.detail.code === 'no_u2f') {\n        errorType = ErrorCodes.NO_AUTHENTICATOR;\n      } else {\n        errorType = ErrorCodes.INVALID_PASSWORD;\n      }\n    } else if (err.status === 401) {\n      errorType = ErrorCodes.INVALID_SSO_SESSION;\n    } else if (err.status === 400) {\n      errorType = ErrorCodes.INVALID_ACCESS_CATEGORY;\n    } else if (err === ErrorCodes.NO_AUTHENTICATOR) {\n      errorType = ErrorCodes.NO_AUTHENTICATOR;\n    } else {\n      errorType = ErrorCodes.UNKNOWN_ERROR;\n    }\n    this.setState({\n      busy: false,\n      error: true,\n      errorType,\n      showAccessForms: true,\n    });\n  };\n\n  handleU2fTap = async (data: Parameters<OnTapProps>[0]) => {\n    this.setState({busy: true});\n\n    const {api, isSuperuser} = this.props;\n\n    try {\n      data.isSuperuserModal = isSuperuser;\n      data.superuserAccessCategory = this.state.superuserAccessCategory;\n      data.superuserReason = this.state.superuserReason;\n      await api.requestPromise('/auth/', {method: 'PUT', data});\n      this.handleSuccess();\n    } catch (err) {\n      this.setState({busy: false});\n      // u2fInterface relies on this\n      throw err;\n    }\n  };\n\n  getAuthLoginPath(): string {\n    const authLoginPath = `/auth/login/?next=${encodeURIComponent(window.location.href)}`;\n    const {superuserUrl} = window.__initialData.links;\n    if (window.__initialData?.customerDomain && superuserUrl) {\n      return `${trimEnd(superuserUrl, '/')}${authLoginPath}`;\n    }\n    return authLoginPath;\n  }\n\n  handleLogout = async () => {\n    const {api} = this.props;\n    try {\n      await logout(api);\n    } catch {\n      // ignore errors\n    }\n    window.location.assign(this.getAuthLoginPath());\n  };\n\n  async getAuthenticators() {\n    const {api} = this.props;\n\n    try {\n      const authenticators = await api.requestPromise('/authenticators/');\n      this.setState({authenticators: authenticators ?? []});\n    } catch {\n      // ignore errors\n    }\n  }\n\n  renderBodyContent() {\n    const {isSuperuser} = this.props;\n    const {authenticators, error, errorType, showAccessForms} = this.state;\n    const user = ConfigStore.get('user');\n    const isSelfHosted = ConfigStore.get('isSelfHosted');\n    const validateSUForm = ConfigStore.get('validateSUForm');\n\n    if (errorType === ErrorCodes.INVALID_SSO_SESSION) {\n      this.handleLogout();\n      return null;\n    }\n\n    if (\n      (!user.hasPasswordAuth && authenticators.length === 0) ||\n      (isSuperuser && !isSelfHosted && validateSUForm)\n    ) {\n      return (\n        <Fragment>\n          <StyledTextBlock>\n            {isSuperuser\n              ? t(\n                  'You are attempting to access a resource that requires superuser access, please re-authenticate as a superuser.'\n                )\n              : t('You will need to reauthenticate to continue')}\n          </StyledTextBlock>\n          {error && (\n            <StyledAlert type=\"error\" showIcon>\n              {errorType}\n            </StyledAlert>\n          )}\n          {isSuperuser ? (\n            <Form\n              apiMethod=\"PUT\"\n              apiEndpoint=\"/auth/\"\n              submitLabel={showAccessForms ? t('Continue') : t('Re-authenticate')}\n              onSubmit={this.handleSubmit}\n              onSubmitSuccess={this.handleSuccess}\n              onSubmitError={this.handleError}\n              initialData={{isSuperuserModal: isSuperuser}}\n              extraButton={\n                <BackWrapper>\n                  <Button type=\"submit\" onClick={this.handleSubmitCOPS}>\n                    {t('COPS/CSM')}\n                  </Button>\n                </BackWrapper>\n              }\n              resetOnError\n            >\n              {!isSelfHosted && showAccessForms && (\n                <Hook name=\"component:superuser-access-category\" />\n              )}\n              {!isSelfHosted && !showAccessForms && (\n                <U2fContainer\n                  authenticators={authenticators}\n                  displayMode=\"sudo\"\n                  onTap={this.handleU2fTap}\n                />\n              )}\n            </Form>\n          ) : (\n            <Button priority=\"primary\" href={this.getAuthLoginPath()}>\n              {t('Continue')}\n            </Button>\n          )}\n        </Fragment>\n      );\n    }\n\n    return (\n      <Fragment>\n        <StyledTextBlock>\n          {isSuperuser\n            ? t(\n                'You are attempting to access a resource that requires superuser access, please re-authenticate as a superuser.'\n              )\n            : t('Help us keep your account safe by confirming your identity.')}\n        </StyledTextBlock>\n\n        {error && (\n          <StyledAlert type=\"error\" showIcon>\n            {errorType}\n          </StyledAlert>\n        )}\n\n        <Form\n          apiMethod=\"PUT\"\n          apiEndpoint=\"/auth/\"\n          submitLabel={t('Confirm Password')}\n          onSubmitSuccess={this.handleSuccess}\n          onSubmitError={this.handleError}\n          hideFooter={!user.hasPasswordAuth && authenticators.length === 0}\n          initialData={{isSuperuserModal: isSuperuser}}\n          resetOnError\n        >\n          {user.hasPasswordAuth && (\n            <StyledSecretField\n              inline={false}\n              label={t('Password')}\n              name=\"password\"\n              autoFocus\n              flexibleControlStateSize\n            />\n          )}\n\n          <U2fContainer\n            authenticators={authenticators}\n            displayMode=\"sudo\"\n            onTap={this.handleU2fTap}\n          />\n        </Form>\n      </Fragment>\n    );\n  }\n\n  render() {\n    const {Header, Body} = this.props;\n\n    return (\n      <Fragment>\n        <Header closeButton>{t('Confirm Password to Continue')}</Header>\n        <Body>{this.renderBodyContent()}</Body>\n      </Fragment>\n    );\n  }\n}\n\nexport default withSentryRouter(withApi(SudoModal));\nexport {SudoModal};\n\nconst StyledTextBlock = styled(TextBlock)`\n  margin-bottom: ${space(1)};\n`;\n\nconst StyledSecretField = styled(SecretField)`\n  padding-left: 0;\n`;\n\nconst StyledAlert = styled(Alert)`\n  margin-bottom: 0;\n`;\n\nconst BackWrapper = styled('div')`\n  width: 100%;\n  margin-left: ${space(4)};\n`;\n","import {Authenticator} from 'sentry/types';\n\nimport U2fSign from './u2fsign';\n\ntype U2FSignProps = React.ComponentProps<typeof U2fSign>;\n\ntype Props = {\n  authenticators: Array<Authenticator>;\n  onTap: U2FSignProps['onTap'];\n  className?: string;\n  displayMode?: U2FSignProps['displayMode'];\n};\n\nfunction U2fContainer({className, authenticators, ...props}: Props) {\n  if (!authenticators.length) {\n    return null;\n  }\n\n  return (\n    <div className={className}>\n      {authenticators.map(auth =>\n        auth.id === 'u2f' && auth.challenge ? (\n          <U2fSign key={auth.id} {...props} challengeData={auth.challenge} />\n        ) : null\n      )}\n    </div>\n  );\n}\n\nexport default U2fContainer;\n","// Copyright (c) 2019 GitHub, Inc.\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"),\n// to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense,\n// and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n// DEALINGS IN THE SOFTWARE.\n\n// below is from https://github.com/github/webauthn-json/tree/66322fc5c12184c5269691ab5abaac79545a3916\n\nexport function base64urlToBuffer(baseurl64String: string): ArrayBuffer {\n  // Base64url to Base64\n  const padding = '=='.slice(0, (4 - (baseurl64String.length % 4)) % 4);\n  const base64String = baseurl64String.replace(/-/g, '+').replace(/_/g, '/') + padding;\n\n  // Base64 to binary string\n  const str = atob(base64String);\n\n  // Binary string to buffer\n  const buffer = new ArrayBuffer(str.length);\n  const byteView = new Uint8Array(buffer);\n  for (let i = 0; i < str.length; i++) {\n    byteView[i] = str.charCodeAt(i);\n  }\n  return buffer;\n}\n\nexport function bufferToBase64url(buffer: ArrayBuffer): string {\n  // Buffer to binary string\n  const byteView = new Uint8Array(buffer);\n  let str = '';\n  for (const charCode of byteView) {\n    str += String.fromCharCode(charCode);\n  }\n\n  // Binary string to base64\n  const base64String = btoa(str);\n\n  // Base64 to base64url\n  // We assume that the base64url string is well-formed.\n  const base64urlString = base64String\n    .replace(/\\+/g, '-')\n    .replace(/\\//g, '_')\n    .replace(/=/g, '');\n  return base64urlString;\n}\n","import {Component} from 'react';\nimport * as Sentry from '@sentry/react';\nimport * as cbor from 'cbor-web';\n\nimport {base64urlToBuffer, bufferToBase64url} from 'sentry/components/u2f/webAuthnHelper';\nimport {t, tct} from 'sentry/locale';\nimport ConfigStore from 'sentry/stores/configStore';\nimport {ChallengeData, Organization} from 'sentry/types';\nimport withOrganization from 'sentry/utils/withOrganization';\n\ntype TapParams = {\n  challenge: string;\n  response: string;\n  isSuperuserModal?: boolean;\n  superuserAccessCategory?: string;\n  superuserReason?: string;\n};\n\ntype Props = {\n  challengeData: ChallengeData;\n  flowMode: string;\n  onTap: ({\n    response,\n    challenge,\n    isSuperuserModal,\n    superuserAccessCategory,\n    superuserReason,\n  }: TapParams) => Promise<void>;\n  organization: Organization;\n  silentIfUnsupported: boolean;\n  children?: React.ReactNode;\n  style?: React.CSSProperties;\n};\n\ntype State = {\n  challengeElement: HTMLInputElement | null;\n  deviceFailure: string | null;\n  failCount: number;\n  formElement: HTMLFormElement | null;\n  hasBeenTapped: boolean;\n  isSafari: boolean;\n  isSupported: boolean | null;\n  responseElement: HTMLInputElement | null;\n};\n\nclass U2fInterface extends Component<Props, State> {\n  state: State = {\n    isSupported: null,\n    formElement: null,\n    challengeElement: null,\n    hasBeenTapped: false,\n    deviceFailure: null,\n    responseElement: null,\n    isSafari: false,\n    failCount: 0,\n  };\n\n  componentDidMount() {\n    const supported = !!window.PublicKeyCredential;\n\n    // eslint-disable-next-line react/no-did-mount-set-state\n    this.setState({isSupported: supported});\n\n    const isSafari =\n      navigator.userAgent.includes('Safari') && !navigator.userAgent.includes('Chrome');\n\n    if (isSafari) {\n      // eslint-disable-next-line react/no-did-mount-set-state\n      this.setState({\n        deviceFailure: 'safari: requires interaction',\n        isSafari,\n        hasBeenTapped: false,\n      });\n    }\n\n    if (supported && !isSafari) {\n      this.invokeU2fFlow();\n    }\n  }\n\n  getU2FResponse(data) {\n    if (!data.response) {\n      return JSON.stringify(data);\n    }\n\n    if (this.props.flowMode === 'sign') {\n      const authenticatorData = {\n        keyHandle: data.id,\n        clientData: bufferToBase64url(data.response.clientDataJSON),\n        signatureData: bufferToBase64url(data.response.signature),\n        authenticatorData: bufferToBase64url(data.response.authenticatorData),\n      };\n      return JSON.stringify(authenticatorData);\n    }\n    if (this.props.flowMode === 'enroll') {\n      const authenticatorData = {\n        id: data.id,\n        rawId: bufferToBase64url(data.rawId),\n        response: {\n          attestationObject: bufferToBase64url(data.response.attestationObject),\n          clientDataJSON: bufferToBase64url(data.response.clientDataJSON),\n        },\n        type: bufferToBase64url(data.type),\n      };\n      return JSON.stringify(authenticatorData);\n    }\n\n    throw new Error(`Unsupported flow mode '${this.props.flowMode}'`);\n  }\n\n  submitU2fResponse(promise) {\n    promise\n      .then(data => {\n        this.setState(\n          {\n            hasBeenTapped: true,\n          },\n          () => {\n            const u2fResponse = this.getU2FResponse(data);\n            const challenge = JSON.stringify(this.props.challengeData);\n\n            if (this.state.responseElement) {\n              // eslint-disable-next-line react/no-direct-mutation-state\n              this.state.responseElement.value = u2fResponse;\n            }\n\n            if (!this.props.onTap) {\n              this.state.formElement?.submit();\n              return;\n            }\n\n            this.props\n              .onTap({\n                response: u2fResponse,\n                challenge,\n              })\n              .catch(() => {\n                // This is kind of gross but I want to limit the amount of changes to this component\n                this.setState({\n                  deviceFailure: 'UNKNOWN_ERROR',\n                  hasBeenTapped: false,\n                });\n              });\n          }\n        );\n      })\n      .catch(err => {\n        let failure = 'DEVICE_ERROR';\n        // in some rare cases there is no metadata on the error which\n        // causes this to blow up badly.\n        if (err.metaData) {\n          if (err.metaData.type === 'DEVICE_INELIGIBLE') {\n            if (this.props.flowMode === 'enroll') {\n              failure = 'DUPLICATE_DEVICE';\n            } else {\n              failure = 'UNKNOWN_DEVICE';\n            }\n          } else if (err.metaData.type === 'BAD_REQUEST') {\n            failure = 'BAD_APPID';\n          }\n        }\n        // we want to know what is happening here.  There are some indicators\n        // that users are getting errors that should not happen through the\n        // regular u2f flow.\n        Sentry.captureException(err);\n        this.setState({\n          deviceFailure: failure,\n          hasBeenTapped: false,\n          failCount: this.state.failCount + 1,\n        });\n      });\n  }\n\n  webAuthnSignIn(publicKeyCredentialRequestOptions) {\n    const promise = navigator.credentials.get({\n      publicKey: publicKeyCredentialRequestOptions,\n    });\n    this.submitU2fResponse(promise);\n  }\n\n  webAuthnRegister(publicKey) {\n    const promise = navigator.credentials.create({\n      publicKey,\n    });\n    this.submitU2fResponse(promise);\n  }\n\n  invokeU2fFlow() {\n    if (this.props.flowMode === 'sign') {\n      const challengeArray = base64urlToBuffer(\n        this.props.challengeData.webAuthnAuthenticationData\n      );\n      const challenge = cbor.decodeFirst(challengeArray);\n      challenge\n        .then(data => {\n          this.webAuthnSignIn(data);\n        })\n        .catch(err => {\n          const failure = 'DEVICE_ERROR';\n          Sentry.captureException(err);\n          this.setState({\n            deviceFailure: failure,\n            hasBeenTapped: false,\n          });\n        });\n    } else if (this.props.flowMode === 'enroll') {\n      const challengeArray = base64urlToBuffer(\n        this.props.challengeData.webAuthnRegisterData\n      );\n      const challenge = cbor.decodeFirst(challengeArray);\n      // challenge contains a PublicKeyCredentialRequestOptions object for webauthn registration\n      challenge\n        .then(data => {\n          this.webAuthnRegister(data.publicKey);\n        })\n        .catch(err => {\n          const failure = 'DEVICE_ERROR';\n          Sentry.captureException(err);\n          this.setState({\n            deviceFailure: failure,\n            hasBeenTapped: false,\n          });\n        });\n    } else {\n      throw new Error(`Unsupported flow mode '${this.props.flowMode}'`);\n    }\n  }\n\n  onTryAgain = () => {\n    this.setState(\n      {hasBeenTapped: false, deviceFailure: null},\n      () => void this.invokeU2fFlow()\n    );\n  };\n\n  bindChallengeElement: React.RefCallback<HTMLInputElement> = ref => {\n    this.setState({\n      challengeElement: ref,\n      formElement: ref && ref.form,\n    });\n\n    if (ref) {\n      ref.value = JSON.stringify(this.props.challengeData);\n    }\n  };\n\n  bindResponseElement: React.RefCallback<HTMLInputElement> = ref =>\n    this.setState({responseElement: ref});\n\n  renderUnsupported() {\n    return this.props.silentIfUnsupported ? null : (\n      <div className=\"u2f-box\">\n        <div className=\"inner\">\n          <p className=\"error\">\n            {t(\n              `\n             Unfortunately your browser does not support U2F. You need to use\n             a different two-factor method or switch to a browser that supports\n             it (Google Chrome or Microsoft Edge).`\n            )}\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  get canTryAgain() {\n    return this.state.deviceFailure !== 'BAD_APPID';\n  }\n\n  renderSafariWebAuthn = () => {\n    return (\n      <a onClick={this.onTryAgain} className=\"btn btn-primary\">\n        {this.props.flowMode === 'enroll'\n          ? t('Enroll with WebAuthn')\n          : t('Sign in with WebAuthn')}\n      </a>\n    );\n  };\n\n  renderFailure = () => {\n    const {deviceFailure} = this.state;\n    const supportMail = ConfigStore.get('supportEmail');\n    const support = supportMail ? (\n      <a href={'mailto:' + supportMail}>{supportMail}</a>\n    ) : (\n      <span>{t('Support')}</span>\n    );\n    if (this.state.isSafari && this.state.failCount === 0) {\n      return this.renderSafariWebAuthn();\n    }\n    return (\n      <div className=\"failure-message\">\n        <div>\n          <strong>{t('Error: ')}</strong>{' '}\n          {\n            {\n              UNKNOWN_ERROR: t('There was an unknown problem, please try again'),\n              DEVICE_ERROR: t('Your U2F device reported an error.'),\n              DUPLICATE_DEVICE: t('This device is already registered with Sentry.'),\n              UNKNOWN_DEVICE: t('The device you used for sign-in is unknown.'),\n              BAD_APPID: tct(\n                `[p1:The Sentry server administrator modified the device\n                 registrations.] [p2:You need to remove and re-add the device to continue using\n                 your U2F device. Use a different sign-in method or contact [support] for\n                 assistance.]`,\n                {\n                  p1: <p />,\n                  p2: <p />,\n                  support,\n                }\n              ),\n            }[deviceFailure || '']\n          }\n        </div>\n        {this.canTryAgain && (\n          <div style={{marginTop: 18}}>\n            <a onClick={this.onTryAgain} className=\"btn btn-primary\">\n              {t('Try Again')}\n            </a>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  renderBody() {\n    return this.state.deviceFailure ? this.renderFailure() : this.props.children;\n  }\n\n  renderPrompt() {\n    const {style} = this.props;\n\n    return (\n      <div\n        style={style}\n        className={\n          'u2f-box' +\n          (this.state.hasBeenTapped ? ' tapped' : '') +\n          (this.state.deviceFailure\n            ? this.state.failCount === 0 && this.state.isSafari\n              ? ' loading-dots'\n              : ' device-failure'\n            : '')\n        }\n      >\n        <div className=\"device-animation-frame\">\n          <div className=\"device-failed\" />\n          <div className=\"device-animation\" />\n          <div className=\"loading-dots\">\n            <span className=\"dot\" />\n            <span className=\"dot\" />\n            <span className=\"dot\" />\n          </div>\n        </div>\n        <input type=\"hidden\" name=\"challenge\" ref={this.bindChallengeElement} />\n        <input type=\"hidden\" name=\"response\" ref={this.bindResponseElement} />\n        <div className=\"inner\">{this.renderBody()}</div>\n      </div>\n    );\n  }\n\n  render() {\n    const {isSupported} = this.state;\n    // if we are still waiting for the browser to tell us if we can do u2f this\n    // will be null.\n    if (isSupported === null) {\n      return null;\n    }\n\n    if (!isSupported) {\n      return this.renderUnsupported();\n    }\n\n    return this.renderPrompt();\n  }\n}\n\nexport default withOrganization(U2fInterface);\n","import {t} from 'sentry/locale';\n\nimport U2fInterface from './u2finterface';\n\nconst MESSAGES = {\n  signin: t(\n    'Insert your U2F device or tap the button on it to confirm the sign-in request.'\n  ),\n  sudo: t('Alternatively you can use your U2F device to confirm the action.'),\n  enroll: t(\n    'To enroll your U2F device insert it now or tap the button on it to activate it.'\n  ),\n};\n\ntype InterfaceProps = React.ComponentProps<typeof U2fInterface>;\n\ntype Props = Omit<InterfaceProps, 'silentIfUnsupported' | 'flowMode'> & {\n  displayMode?: 'signin' | 'enroll' | 'sudo';\n};\n\nfunction U2fSign({displayMode = 'signin', ...props}: Props) {\n  const flowMode = displayMode === 'enroll' ? 'enroll' : 'sign';\n\n  return (\n    <U2fInterface\n      {...props}\n      silentIfUnsupported={displayMode === 'sudo'}\n      flowMode={flowMode}\n    >\n      <p>{MESSAGES[displayMode] ?? null}</p>\n    </U2fInterface>\n  );\n}\n\nexport default U2fSign;\n","// TODO(epurkhiser): These can't be translated with `t()` because they're an\n// Enum. We should probably just use a regular map\nexport enum ErrorCodes {\n  INVALID_PASSWORD = 'Incorrect password',\n  INVALID_SSO_SESSION = 'Your SSO Session has expired, please reauthenticate',\n  INVALID_ACCESS_CATEGORY = 'Please fill out the access category and reason correctly',\n  NO_AUTHENTICATOR = 'Please add a U2F authenticator to your account',\n  UNKNOWN_ERROR = 'An error ocurred, please try again',\n}\n","import {useCallback, useEffect, useRef} from 'react';\n\nimport {Client} from 'sentry/api';\n\ntype Options = {\n  /**\n   * An existing API client may be provided.\n   *\n   * This is a continent way to re-use clients and still inherit the\n   * persistInFlight configuration.\n   */\n  api?: Client;\n  /**\n   * Enabling this option will disable clearing in-flight requests when the\n   * component is unmounted.\n   *\n   * This may be useful in situations where your component needs to finish up\n   * somewhere the client was passed into some type of action creator and the\n   * component is unmounted.\n   */\n  persistInFlight?: boolean;\n};\n\n/**\n * Returns an API client that will have it's requests canceled when the owning\n * React component is unmounted (may be disabled via options).\n */\nfunction useApi({persistInFlight, api: providedApi}: Options = {}) {\n  const localApi = useRef<Client>();\n\n  // Lazily construct the client if we weren't provided with one\n  if (localApi.current === undefined && providedApi === undefined) {\n    localApi.current = new Client();\n  }\n\n  // Use the provided client if available\n  const api = providedApi ?? localApi.current!;\n\n  // Clear API calls on unmount (if persistInFlight is disabled\n  const clearOnUnmount = useCallback(() => {\n    if (!persistInFlight) {\n      api.clear();\n    }\n  }, [api, persistInFlight]);\n\n  useEffect(() => clearOnUnmount, [clearOnUnmount]);\n\n  return api;\n}\n\nexport default useApi;\n","import {Client} from 'sentry/api';\nimport getDisplayName from 'sentry/utils/getDisplayName';\nimport useApi from 'sentry/utils/useApi';\n\ntype InjectedApiProps = {\n  api: Client;\n};\n\ntype WrappedProps<P> = Omit<P, keyof InjectedApiProps> & Partial<InjectedApiProps>;\n\n/**\n * XXX: Prefer useApi if you are wrapping a Function Component!\n *\n * React Higher-Order Component (HoC) that provides \"api\" client when mounted,\n * and clears API requests when component is unmounted.\n *\n * If an `api` prop is provided when the component is invoked it will be passed\n * through.\n */\nconst withApi = <P extends InjectedApiProps>(\n  WrappedComponent: React.ComponentType<P>,\n  options: Parameters<typeof useApi>[0] = {}\n) => {\n  function WithApi({api: propsApi, ...props}: WrappedProps<P>) {\n    const api = useApi({api: propsApi, ...options});\n\n    return <WrappedComponent {...(props as P)} api={api} />;\n  }\n\n  WithApi.displayName = `withApi(${getDisplayName(WrappedComponent)})`;\n\n  return WithApi;\n};\n\nexport default withApi;\n","var makeBuiltIn = require('../internals/make-built-in');\nvar defineProperty = require('../internals/object-define-property');\n\nmodule.exports = function (target, name, descriptor) {\n  if (descriptor.get) makeBuiltIn(descriptor.get, name, { getter: true });\n  if (descriptor.set) makeBuiltIn(descriptor.set, name, { setter: true });\n  return defineProperty.f(target, name, descriptor);\n};\n"],"names":["async","disconnectIdentity","identity","onSuccess","api","Client","requestPromise","category","id","method","addErrorMessage","addSuccessMessage","provider","name","updateUser","user","ConfigStore","get","options","theme","set","logout","removeAuthenticator","userId","authId","SecretField","props","_jsx","InputField","type","role","displayName","Hook","_ref","HookComponent","Component","constructor","arguments","_defineProperty","hooks","HookStore","map","cb","listen","hookName","this","handleHooks","undefined","componentWillUnmount","unsubscribe","setState","render","children","state","length","SudoModal","authenticators","busy","error","errorType","showAccessForms","superuserAccessCategory","superuserReason","isSuperuser","disableU2FForSUForm","suAccessCategory","data","suReason","handleSuccess","err","handleError","ErrorCodes","NO_AUTHENTICATOR","closeModal","location","needsReload","router","retryRequest","replace","pathname","forceUpdate","Date","window","reload","then","status","responseJSON","detail","code","INVALID_PASSWORD","INVALID_SSO_SESSION","INVALID_ACCESS_CATEGORY","UNKNOWN_ERROR","isSuperuserModal","assign","getAuthLoginPath","componentDidMount","getAuthenticators","authLoginPath","encodeURIComponent","href","superuserUrl","__initialData","links","customerDomain","trimEnd","renderBodyContent","isSelfHosted","validateSUForm","handleLogout","hasPasswordAuth","_jsxs","Fragment","StyledTextBlock","t","StyledAlert","showIcon","Form","apiMethod","apiEndpoint","submitLabel","onSubmit","handleSubmit","onSubmitSuccess","onSubmitError","initialData","extraButton","BackWrapper","Button","onClick","handleSubmitCOPS","resetOnError","U2fContainer","displayMode","onTap","handleU2fTap","priority","hideFooter","StyledSecretField","inline","label","autoFocus","flexibleControlStateSize","Header","Body","closeButton","withSentryRouter","withApi","_styled","TextBlock","target","space","styles","Alert","className","auth","challenge","U2fSign","challengeData","base64urlToBuffer","baseurl64String","padding","slice","base64String","str","atob","buffer","ArrayBuffer","byteView","Uint8Array","i","charCodeAt","bufferToBase64url","charCode","String","fromCharCode","btoa","U2fInterface","isSupported","formElement","challengeElement","hasBeenTapped","deviceFailure","responseElement","isSafari","failCount","invokeU2fFlow","ref","form","value","JSON","stringify","onTryAgain","flowMode","supportMail","support","renderSafariWebAuthn","DEVICE_ERROR","DUPLICATE_DEVICE","UNKNOWN_DEVICE","BAD_APPID","tct","p1","p2","canTryAgain","style","marginTop","supported","PublicKeyCredential","navigator","userAgent","includes","getU2FResponse","response","authenticatorData","keyHandle","clientData","clientDataJSON","signatureData","signature","rawId","attestationObject","Error","submitU2fResponse","promise","u2fResponse","catch","submit","failure","metaData","Sentry","webAuthnSignIn","publicKeyCredentialRequestOptions","credentials","publicKey","webAuthnRegister","create","challengeArray","webAuthnAuthenticationData","cbor","decodeFirst","webAuthnRegisterData","renderUnsupported","silentIfUnsupported","renderBody","renderFailure","renderPrompt","bindChallengeElement","bindResponseElement","withOrganization","MESSAGES","signin","sudo","enroll","persistInFlight","providedApi","localApi","useRef","current","clearOnUnmount","useCallback","clear","useEffect","WrappedComponent","WithApi","propsApi","useApi","getDisplayName","makeBuiltIn","defineProperty","module","exports","descriptor","getter","setter","f"],"sourceRoot":""}