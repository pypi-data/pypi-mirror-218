"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[1804],{9320:(e,s,t)=>{t.r(s),t.d(s,{default:()=>se});var o=t(6252),a=t(3577);const l={class:"card"},r={class:"card-body"},d=(0,o._)("h2",null,"User List",-1),i=(0,o._)("hr",null,null,-1),n={class:"row"},u={class:"col-md-4"},c=(0,o._)("strong",null,"List of Users",-1),p={text:"text-instructions"},m={class:"col-md-8"},h={class:"table"},_=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("td",null,"User"),(0,o._)("td",null,"Group List"),(0,o._)("td",null,"Permission List"),(0,o._)("td",null,"Team Leader")])],-1),g={style:{"text-align":"center"}},v=["checked","data-group","data-permission-set","data-user"],b=(0,o._)("hr",null,null,-1),y={class:"row"},w={class:"col-md-12"};var S=t(3138),f=t(3058);const M={class:"modal fade",id:"addUserModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"addUserModalLabel","aria-hidden":"true"},U={class:"modal-dialog modal-lg modal-fullscreen-lg-down"},k={class:"modal-content"},L=(0,o._)("div",{class:"modal-header"},[(0,o._)("h5",{class:"modal-title",id:"addUserModalLabel"}," Add User "),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),D={class:"modal-body"},R={key:0,class:"row"},E={class:"col-md-4"},I=(0,o._)("strong",null,"Search Users",-1),A={class:"text-instructions"},C={class:"col-md-8"},T=(0,o._)("label",null,"Search User",-1),x={key:1},q={key:2,class:"row"},$=(0,o._)("div",{class:"col-md-4"},[(0,o._)("strong",null,"Search Groups"),(0,o._)("p",{class:"text-instructions"}," Please use the select to find the group you would like to add to this user to. ")],-1),B={class:"col-md-8"},G=(0,o._)("label",null,"Search Groups",-1),P={key:3},H={key:4,class:"row"},Z=(0,o._)("div",{class:"col-md-4"},[(0,o._)("strong",null,"Search Permission Sets"),(0,o._)("p",{class:"text-instructions"}," Please use the select to find the permission set you would like to add to this user. ")],-1),W={class:"col-md-8"},F=(0,o._)("label",null,"Search Permission Sets",-1),N={class:"modal-footer"},j=(0,o._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);var O=t(9669),K=t.n(O),V=t(1317),Y=t(989);const z={name:"AdminAddUser",components:{NSelect:V.Z},props:{destination:{type:String,default:""},locationId:{type:Number,default:0}},data:()=>({groupModel:[],groupResults:[],permissionSetModel:[],permissionSetResults:[],userModel:[],userResults:[]}),computed:{...(0,Y.Se)({rootUrl:"getRootUrl",userLevel:"getUserLevel"})},mixins:[f.Z],methods:{addUser(){const e=new FormData;e.set("username",this.userModel),this.groupModel.forEach((s=>{e.append("group",s)})),this.permissionSetModel.forEach((s=>{e.append("permission_set",s)})),K().post(`${this.rootUrl}admin_add_user/`,e).then((e=>{window.location.reload(!0)})).catch((e=>{this.showErrorModal(e,"Admin Add user","")}))},getData(){K().post(`${this.rootUrl}object_data/admin_add_user/`).then((e=>{switch(this.groupResults=e.data.group_results.map((e=>({label:e.group_name,value:e.group_id}))),this.permissionSetResults=e.data.permission_set_results.map((e=>({label:e.permission_set_name,value:e.permission_set_id}))),this.userResults=e.data.user_results.map((e=>({label:`${e.id}: ${e.first_name} ${e.last_name}`,value:e.id}))),this.destination){case"group":this.groupModel=[this.locationId];break;case"permission_set":this.permissionSetModel=[this.locationId];break;case"user":this.userModel=this.locationId}})).catch((e=>{this.showErrorModal(e,"Admin Add User","")}))}},mounted(){this.getData()}};var J=t(3744);const Q=(0,J.Z)(z,[["render",function(e,s,t,l,r,d){const i=(0,o.up)("n-select");return(0,o.wg)(),(0,o.iD)("div",M,[(0,o._)("div",U,[(0,o._)("div",k,[L,(0,o._)("div",D,[(0,o.kq)(" Search Users "),"user"!==t.destination?((0,o.wg)(),(0,o.iD)("div",R,[(0,o._)("div",E,[I,(0,o._)("p",A," Please use the select to find the user you would like to add to this "+(0,a.toDisplayString)(t.destination),1)]),(0,o._)("div",C,[T,(0,o.Wm)(i,{options:r.userResults,value:r.userModel,"onUpdate:value":s[0]||(s[0]=e=>r.userModel=e),class:"form-control"},null,8,["options","value"])])])):(0,o.kq)("v-if",!0),"user"!==t.destination?((0,o.wg)(),(0,o.iD)("hr",x)):(0,o.kq)("v-if",!0),(0,o.kq)(" Search Groups "),"group"!==t.destination?((0,o.wg)(),(0,o.iD)("div",q,[$,(0,o._)("div",B,[G,(0,o.Wm)(i,{options:r.groupResults,value:r.groupModel,"onUpdate:value":s[1]||(s[1]=e=>r.groupModel=e),class:"form-control",multiple:""},null,8,["options","value"])])])):(0,o.kq)("v-if",!0),"group"!==t.destination?((0,o.wg)(),(0,o.iD)("hr",P)):(0,o.kq)("v-if",!0),(0,o.kq)(" Search Permission Sets "),"permission_set"!==t.destination?((0,o.wg)(),(0,o.iD)("div",H,[Z,(0,o._)("div",W,[F,(0,o.Wm)(i,{options:r.permissionSetResults,value:r.permissionSetModel,"onUpdate:value":s[2]||(s[2]=e=>r.permissionSetModel=e),class:"form-control",multiple:""},null,8,["options","value"])])])):(0,o.kq)("v-if",!0)]),(0,o._)("div",N,[j,(0,o._)("button",{type:"button",class:"btn btn-primary",onClick:s[3]||(s[3]=(...e)=>d.addUser&&d.addUser(...e))}," Add User ")])])])])}]]),X=t(9669),ee={name:"UserList",components:{AdminAddUser:Q},props:{destination:{type:String,default:""},locationId:{type:Number,default:0},userListResults:{type:Array,default:()=>[]}},data:()=>({localListResults:[]}),mixins:[f.Z],methods:{addUser(){new S.u_(document.getElementById("addUserModal")).show()},isTeamLeader(e){return this.userListResults.filter((s=>s.username===e&&s.group_leader)).length>0},updateGroupLeader(e){new S.u_("#loadingModal").show();const s=document.getElementById("loadingModalContent");s.innerHTML="Updating Team Leader Status";const t=e.target.checked,o=new FormData;o.set("group_leader",t),o.set("username",e.target.dataset.user),"group"===this.destination||"user"===this.destination?o.set("group",e.target.dataset.group):"permission_set"===this.destination&&o.set("permission_set",e.target.dataset.permissionSet),X.post(`/update_group_leader_status/${this.destination}/`,o).then((e=>{this.localListResults=e.data,s.innerHTML="Updated  Team Leader Status Complete"})).catch((e=>{this.showErrorModal(e,this.destination)}))}},mounted(){this.localListResults=this.userListResults}},se=(0,J.Z)(ee,[["render",function(e,s,t,S,f,M){const U=(0,o.up)("admin-add-user");return(0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("div",r,[d,i,(0,o._)("div",n,[(0,o._)("div",u,[c,(0,o._)("p",p," The following are a list of users associated to "+(0,a.toDisplayString)(t.destination)+'. To add a new user please click on the "Add User" at the bottom of the page. ',1)]),(0,o._)("div",m,[(0,o._)("table",h,[_,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(f.localListResults,(e=>((0,o.wg)(),(0,o.iD)("tr",{key:e.username},[(0,o._)("td",null,(0,a.toDisplayString)(e.username__first_name)+" "+(0,a.toDisplayString)(e.username__last_name),1),(0,o._)("td",null,(0,a.toDisplayString)(e.group__group_name),1),(0,o._)("td",null,(0,a.toDisplayString)(e.permission_set__permission_set_name),1),(0,o._)("td",g,[(0,o._)("input",{class:"form-check-input",type:"checkbox",checked:e.group_leader,"data-group":e.group,"data-permission-set":e.permission_set,"data-user":e.username,onChange:s[0]||(s[0]=(...e)=>M.updateGroupLeader&&M.updateGroupLeader(...e))},null,40,v)])])))),128))])])])]),b,(0,o._)("div",y,[(0,o._)("div",w,[(0,o._)("a",{href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:s[1]||(s[1]=(...e)=>M.addUser&&M.addUser(...e))},"Add User")])])]),(0,o.kq)(" MODALS "),(0,o.Wm)(U,{destination:t.destination,"location-id":t.locationId},null,8,["destination","location-id"])])}]])},3058:(e,s,t)=>{t.d(s,{Z:()=>a});var o=t(3138);const a={methods:{showErrorModal(e,s,t){new o.u_(document.getElementById("loadingModal")).hide(),document.getElementById("errorModalContent").innerHTML=`<strong>HTML ISSUE:</strong> We could not save the new ${s}-${t}<hr>${e}`,new o.u_(document.getElementById("errorModal")).show()},showValidationErrorModal(){document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",new o.u_(document.getElementById("errorModal")).show()}}}}}]);