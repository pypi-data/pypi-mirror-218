(function(){"use strict";importScripts("https://cdn.jsdelivr.net/pyodide/v0.23.2/full/pyodide.js");const a=self;async function o(){a.pyodide=await a.loadPyodide(),await a.pyodide.loadPackage("micropip"),await a.pyodide.pyimport("micropip").install("sqlglot");const l=await(await fetch(new URL("data:application/octet-stream;base64,aW1wb3J0IGpzb24KCmltcG9ydCBzcWxnbG90CmZyb20gc3FsZ2xvdCBpbXBvcnQgZXhwCmZyb20gc3FsZ2xvdC5kaWFsZWN0cy5kaWFsZWN0IGltcG9ydCBEaWFsZWN0LCBEaWFsZWN0VHlwZQoKZGlhbGVjdHMgPSBqc29uLmR1bXBzKAogICAgWwogICAgICAgIHsKICAgICAgICAgICAgImRpYWxlY3RfdGl0bGUiOiAiU1FMR2xvdCIgaWYgZGlhbGVjdCA9PSAiIiBlbHNlIGRpYWxlY3RfY2xhc3MuX19uYW1lX18sCiAgICAgICAgICAgICJkaWFsZWN0X25hbWUiOiBkaWFsZWN0LAogICAgICAgIH0KICAgICAgICBmb3IgZGlhbGVjdCwgZGlhbGVjdF9jbGFzcyBpbiBEaWFsZWN0LmNsYXNzZXMuaXRlbXMoKQogICAgXQopCgoKZGVmIHBhcnNlX3RvX2pzb24oc3FsOiBzdHIsIHJlYWQ6IERpYWxlY3RUeXBlID0gTm9uZSkgLT4gc3RyOgogICAgcmV0dXJuIGpzb24uZHVtcHMoCiAgICAgICAgW2V4cC5kdW1wKCkgaWYgZXhwIGVsc2Uge30gZm9yIGV4cCBpbiBzcWxnbG90LnBhcnNlKHNxbCwgcmVhZD1yZWFkLCBlcnJvcl9sZXZlbD0iaWdub3JlIildCiAgICApCgoKZGVmIGdldF9kaWFsZWN0KG5hbWU6IHN0ciA9ICIiKSAtPiBzdHI6CiAgICBkaWFsZWN0ID0gRGlhbGVjdC5jbGFzc2VzLmdldChuYW1lLCBEaWFsZWN0KQogICAga2V5d29yZHMgPSBkaWFsZWN0LnRva2VuaXplcl9jbGFzcy5LRVlXT1JEUwogICAgdHlwZV9tYXBwaW5nID0gZGlhbGVjdC5nZW5lcmF0b3JfY2xhc3MuVFlQRV9NQVBQSU5HCgogICAgb3V0cHV0ID0gewogICAgICAgICJrZXl3b3JkcyI6ICIgIi5qb2luKGtleXdvcmRzKSwKICAgICAgICAidHlwZXMiOiAiICIuam9pbih0eXBlX21hcHBpbmcuZ2V0KHQsIHQudmFsdWUpIGZvciB0IGluIGV4cC5EYXRhVHlwZS5UeXBlKSwKICAgIH0KCiAgICByZXR1cm4ganNvbi5kdW1wcyhvdXRwdXQpCgoKW3BhcnNlX3RvX2pzb24sIGdldF9kaWFsZWN0LCBkaWFsZWN0c10K",self.location))).text();return a.postMessage({topic:"init"}),Array.from(a.pyodide.runPython(l))}const s=o();a.onmessage=async i=>{const[l,t,g]=await s;if(i.data.topic==="validate"){let c;try{const d=JSON.parse(l(i.data.payload)).filter(Boolean);c=!!d&&d.length>0}catch{c=!1}a.postMessage({topic:"validate",payload:c})}if(i.data.topic==="dialect"){const{keywords:c,types:d}=JSON.parse(t(i.data.payload));a.postMessage({topic:"dialect",payload:{types:d.toLowerCase(),keywords:c.toLowerCase()}})}i.data.topic==="dialects"&&a.postMessage({topic:"dialects",payload:{dialects:JSON.parse(g),dialect:"mysql"}})}})();
