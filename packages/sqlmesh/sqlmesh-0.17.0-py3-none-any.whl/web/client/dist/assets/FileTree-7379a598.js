import{r as a,a as w,j as n,g as p,i as k,z as P,a5 as S,a6 as B,a7 as M,a8 as _,a1 as U,a9 as W,aa as Y,B as z}from"./index-a7e106b5.js";import{C as H,M as E}from"./ModalConfirmation-f612a10a.js";import{u as $}from"./editor-7f8c8c07.js";import{X as I}from"./XCircleIcon-a7124a7b.js";import"./dialog-a5aacb2a.js";import"./transition-d28674b8.js";import"./_commonjs-dynamic-modules-302442b1.js";function q({title:e,titleId:l,...t},o){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":l},t),e?a.createElement("title",{id:l},e):null,a.createElement("path",{fillRule:"evenodd",d:"M6.97 2.47a.75.75 0 011.06 0l4.5 4.5a.75.75 0 01-1.06 1.06L8.25 4.81V16.5a.75.75 0 01-1.5 0V4.81L3.53 8.03a.75.75 0 01-1.06-1.06l4.5-4.5zm9.53 4.28a.75.75 0 01.75.75v11.69l3.22-3.22a.75.75 0 111.06 1.06l-4.5 4.5a.75.75 0 01-1.06 0l-4.5-4.5a.75.75 0 111.06-1.06l3.22 3.22V7.5a.75.75 0 01.75-.75z",clipRule:"evenodd"}))}const X=a.forwardRef(q),Z=X;function G({title:e,titleId:l,...t},o){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":l},t),e?a.createElement("title",{id:l},e):null,a.createElement("path",{fillRule:"evenodd",d:"M5.625 1.5H9a3.75 3.75 0 013.75 3.75v1.875c0 1.036.84 1.875 1.875 1.875H16.5a3.75 3.75 0 013.75 3.75v7.875c0 1.035-.84 1.875-1.875 1.875H5.625a1.875 1.875 0 01-1.875-1.875V3.375c0-1.036.84-1.875 1.875-1.875zM12.75 12a.75.75 0 00-1.5 0v2.25H9a.75.75 0 000 1.5h2.25V18a.75.75 0 001.5 0v-2.25H15a.75.75 0 000-1.5h-2.25V12z",clipRule:"evenodd"}),a.createElement("path",{d:"M14.25 5.25a5.23 5.23 0 00-1.279-3.434 9.768 9.768 0 016.963 6.963A5.23 5.23 0 0016.5 7.5h-1.875a.375.375 0 01-.375-.375V5.25z"}))}const J=a.forwardRef(G),K=J;function Q({title:e,titleId:l,...t},o){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":l},t),e?a.createElement("title",{id:l},e):null,a.createElement("path",{d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0016.5 9h-1.875a1.875 1.875 0 01-1.875-1.875V5.25A3.75 3.75 0 009 1.5H5.625z"}),a.createElement("path",{d:"M12.971 1.816A5.23 5.23 0 0114.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 013.434 1.279 9.768 9.768 0 00-6.963-6.963z"}))}const ee=a.forwardRef(Q),te=ee;function ne({title:e,titleId:l,...t},o){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":l},t),e?a.createElement("title",{id:l},e):null,a.createElement("path",{d:"M19.906 9c.382 0 .749.057 1.094.162V9a3 3 0 00-3-3h-3.879a.75.75 0 01-.53-.22L11.47 3.66A2.25 2.25 0 009.879 3H6a3 3 0 00-3 3v3.162A3.756 3.756 0 014.094 9h15.812zM4.094 10.5a2.25 2.25 0 00-2.227 2.568l.857 6A2.25 2.25 0 004.951 21H19.05a2.25 2.25 0 002.227-1.932l.857-6a2.25 2.25 0 00-2.227-2.568H4.094z"}))}const le=a.forwardRef(ne),ae=le;function se({title:e,titleId:l,...t},o){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":l},t),e?a.createElement("title",{id:l},e):null,a.createElement("path",{fillRule:"evenodd",d:"M19.5 21a3 3 0 003-3V9a3 3 0 00-3-3h-5.379a.75.75 0 01-.53-.22L11.47 3.66A2.25 2.25 0 009.879 3H4.5a3 3 0 00-3 3v12a3 3 0 003 3h15zm-6.75-10.5a.75.75 0 00-1.5 0v2.25H9a.75.75 0 000 1.5h2.25v2.25a.75.75 0 001.5 0v-2.25H15a.75.75 0 000-1.5h-2.25V10.5z",clipRule:"evenodd"}))}const oe=a.forwardRef(se),re=oe;function ie({title:e,titleId:l,...t},o){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":l},t),e?a.createElement("title",{id:l},e):null,a.createElement("path",{d:"M19.5 21a3 3 0 003-3v-4.5a3 3 0 00-3-3h-15a3 3 0 00-3 3V18a3 3 0 003 3h15zM1.5 10.146V6a3 3 0 013-3h5.379a2.25 2.25 0 011.59.659l2.122 2.121c.14.141.331.22.53.22H19.5a3 3 0 013 3v1.146A4.483 4.483 0 0019.5 9h-15a4.483 4.483 0 00-3 1.146z"}))}const ce=a.forwardRef(ie),ue=ce;function pe({title:e,titleId:l,...t},o){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":l},t),e?a.createElement("title",{id:l},e):null,a.createElement("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z",clipRule:"evenodd"}))}const he=a.forwardRef(pe),de=he;function me({title:e,titleId:l,...t},o){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:o,"aria-labelledby":l},t),e?a.createElement("title",{id:l},e):null,a.createElement("path",{fillRule:"evenodd",d:"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z",clipRule:"evenodd"}))}const fe=a.forwardRef(me),we=fe;function T(e){const l=e.files??[],t=e.directories??[];return[...l,...t.map(T).flat()]}function O(e,l){const t=(Date.now()%1e5).toString(16);return`${e==null?"":`${e}_`}${t}${l??""}`.toLowerCase()}function xe({file:e,setConfirmation:l}){const t=$(r=>r.tab),o=$(r=>r.tabs),i=$(r=>r.closeTab),h=w(r=>r.files),u=w(r=>r.selectedFile),c=w(r=>r.selectFile),d=w(r=>r.refreshProject),[x,m]=a.useState(!1),[v,C]=a.useState();a.useEffect(()=>{c(t==null?void 0:t.file)},[t]);function R(){x||(m(!0),B(e.path).then(r=>{var j;r.ok&&(i(e),(j=e.parent)==null||j.removeFile(e),d())}).catch(r=>{console.log(r)}).finally(()=>{m(!1)}))}function D(){l({headline:"Deleting File",description:`Are you sure you want to remove the file "${e.name}"?`,yesText:"Yes, Delete",noText:"No, Cancel",action:R})}function A(){if(x||e==null||P(v)||v==null){C(void 0);return}m(!0);const r=e.name,j=e.path;e.rename(v.trim()),S(j,{new_path:e.path}).then(N=>{e.update(N),h.set(e.path,e),h.delete(j)}).catch(N=>{console.log(N),e.rename(r)}).finally(()=>{C(void 0),m(!1),d()})}return n.jsx("span",{className:p("whitespace-nowrap group/file pl-3 pr-2 py-[0.125rem] flex rounded-md","hover:bg-neutral-100 dark:hover:bg-dark-lighter",e.is_supported&&"group hover:bg-neutral-100 dark:hover:bg-dark-lighter",k(P(v))&&"bg-primary-800",o.has(e)?"text-brand-500":"text-neutral-500 dark:text-neutral-100",e===u&&"bg-neutral-100 dark:bg-dark-lighter"),children:n.jsxs("span",{className:p("flex w-full items-center overflow-hidden overflow-ellipsis"),children:[n.jsx("div",{className:"flex items-center",children:n.jsx(te,{className:p("inline-block w-4 h-4 mr-2",e===u?"text-brand-500":"text-neutral-500 dark:text-neutral-100")})}),v==null?n.jsxs(n.Fragment,{children:[n.jsx(ve,{file:e,setNewName:C}),n.jsx(je,{removeWithConfirmation:D})]}):n.jsx(ge,{file:e,newName:v,setNewName:C,rename:A})]})})}function ve({file:e,setNewName:l}){const t=w(i=>i.selectedFile),o=w(i=>i.selectFile);return n.jsx("span",{title:`${e.name}${e.is_supported?"":" - unsupported format"}`,onClick:i=>{i.stopPropagation(),e!==t&&o(e)},onDoubleClick:i=>{i.stopPropagation(),l(e.name)},className:p("w-full overflow-hidden overflow-ellipsis cursor-default",!e.is_supported&&"opacity-50"),children:e.name})}function ge({file:e,newName:l,setNewName:t,rename:o}){return n.jsxs("div",{className:"w-full flex items-center",children:[n.jsx("input",{type:"text",className:"w-full overflow-hidden overflow-ellipsis bg-primary-900 text-primary-100",value:l,onInput:i=>{i.stopPropagation(),t(i.target.value)}}),n.jsx("div",{className:"flex",children:e.name===(l==null?void 0:l.trim())||l===""?n.jsx(I,{className:"inline-block w-4 h-4 ml-2 text-neutral-500 cursor-pointer",onClick:i=>{i.stopPropagation(),t(void 0)}}):n.jsx(H,{className:"inline-block w-4 h-4 ml-2 text-success-500 cursor-pointer",onClick:i=>{i.stopPropagation(),o()}})})]})}function je({removeWithConfirmation:e}){return n.jsx("span",{className:"flex items-center invisible group-hover/file:visible min-w-8",onClick:l=>{l.stopPropagation(),e()},children:n.jsx(I,{className:"inline-block w-4 h-4 ml-2 text-danger-500 cursor-pointer"})})}const F="w-4 h-4";function V({directory:e,setConfirmation:l}){const t=$(s=>s.tab),o=$(s=>s.closeTab),i=w(s=>s.selectFile),h=w(s=>s.refreshProject),[u,c]=a.useState(!1),[d,x]=a.useState(),[m,v]=a.useState(e.isOpen),C=m?de:we,R=m?ae:ue;a.useEffect(()=>{e.syncStateOpen=v},[]),a.useEffect(()=>{k(m)&&t!=null&&e.hasFile(t.file)&&e.open()},[t]);function D(s){if(s.stopPropagation(),u)return;c(!0);const g=O("new_directory");M(`${e.path}/${g}`,{}).then(f=>{if(k(f.ok)){console.warn([`Directory: ${e.path}`,f.detail]);return}e.addDirectory(new _(f,e)),e.open(),h()}).catch(f=>{console.log(f)}).finally(()=>{c(!1)})}function A(s){if(s.stopPropagation(),u)return;c(!0);const g=e.isModels?".sql":".py",f=O("new_file",g);S(`${e.path}/${f}`,{content:""}).then(b=>{if(k(b.ok)){console.warn([`File: ${e.path}`,b.detail]);return}const L=new U(b,e);e.addFile(L),e.open(),h()}).catch(b=>{console.log(b)}).finally(()=>{c(!1)})}function r(){u||(c(!0),W(e.path).then(s=>{var g;if(k(s.ok)){console.warn([`Directory: ${e.path}`,s.detail]);return}e.isNotEmpty&&T(e).forEach(b=>{o(b)}),(g=e.parent)==null||g.removeDirectory(e),h()}).catch(s=>{console.log({error:s})}).finally(()=>{c(!1)}))}function j(){l({headline:"Removing Directory",description:`Are you sure you want to remove the directory "${e.name}"?`,yesText:"Yes, Remove",noText:"No, Cancel",action:r})}function N(){if(u||e==null||P(d)||d==null)return;c(!0);const s=e.name,g=e.path;e.rename(d.trim()),M(g,{new_path:e.path}).catch(f=>{console.log(f),e.rename(s)}).finally(()=>{x(void 0),c(!1),t!=null&&e.hasFile(t.file)&&i(t.file)})}function y(){e.name===d?x(void 0):l({headline:"Renaming Directory",description:`Are you sure you want to rename the directory "${e.name}"?`,yesText:"Yes, Rename",noText:"No, Cancel",action:N,cancel:()=>{x(void 0)}})}return n.jsxs(n.Fragment,{children:[e.withParent&&n.jsxs("span",{className:p("w-full overflow-hidden group flex justify-between items-center rounded-md py-[0.125rem]","hover:bg-neutral-100 dark:hover:bg-dark-lighter text-neutral-600 dark:text-neutral-100",k(P(d))&&"bg-primary-800"),children:[n.jsxs("div",{className:p("mr-1 flex items-center",e.withDirectories||e.withFiles?"ml-0":"ml-3"),onClick:s=>{s.stopPropagation(),e.toggle()},children:[(e.withDirectories||e.withFiles)&&n.jsx(C,{className:p(`inline-block ${F} ml-1 mr-1`)}),n.jsx(R,{className:`inline-block ${F} mr-1 fill-primary-500`})]}),n.jsx("span",{className:"w-full overflow-hidden flex items-center justify-between pr-1",children:P(d)?n.jsxs("span",{className:"w-full flex overflow-hidden items-center cursor-default",children:[n.jsx("span",{className:"w-full overflow-hidden overflow-ellipsis justify-between",onClick:s=>{s.stopPropagation(),e.toggle()},onDoubleClick:s=>{s.stopPropagation(),x(e.name)},children:e.name}),n.jsxs("span",{className:"hidden w-full group-hover:flex items-center justify-end",children:[n.jsx(Z,{onClick:s=>{s.stopPropagation(),e.isCollapsed?e.expand():e.collapse()},className:p(`cursor-pointer inline-block ${F} mr-1`,e.isCollapsed&&"text-neutral-500 dark:text-neutral-100",e.isExpanded&&"text-secondary-500 dark:text-primary-500")}),n.jsx(K,{onClick:A,className:`cursor-pointer inline-block ${F} mr-1 text-neutral-500 dark:text-neutral-100`}),n.jsx(re,{onClick:D,className:`cursor-pointer inline-block ${F} mr-1 text-neutral-500 dark:text-neutral-100`}),n.jsx(I,{onClick:s=>{s.stopPropagation(),j()},className:`cursor-pointer inline-block ${F} ml-2 text-danger-500`})]})]}):n.jsxs("div",{className:"flex w-full items-center",children:[n.jsx("input",{type:"text",className:"w-full overflow-hidden overflow-ellipsis bg-primary-900 text-primary-100",value:d??e.name,onInput:s=>{s.stopPropagation(),x(s.target.value)}}),n.jsx("div",{className:"flex",children:n.jsx(H,{className:`inline-block ${F} ml-2 text-success-500 cursor-pointer`,onClick:s=>{s.stopPropagation(),y()}})})]})})]}),(m||!e.withParent)&&e.withDirectories&&n.jsx("ul",{className:p(e.withParent?"pl-3":"mt-1"),children:e.directories.map(s=>n.jsx("li",{title:s.name,children:n.jsx(V,{directory:s,setConfirmation:l})},s.id))}),(m||!e.withParent)&&e.withFiles&&n.jsx("ul",{className:p(e.withParent?"pl-3":"mt-1"),children:e.files.map(s=>n.jsx("li",{title:s.name,children:n.jsx(xe,{file:s,setConfirmation:l})},s.id))})]})}function $e({className:e}){const l=w(u=>u.project),[t,o]=a.useState(),[i,h]=a.useState(!1);return a.useEffect(()=>{h(Y(t))},[t]),n.jsxs("div",{className:p("py-2 px-1 overflow-hidden overflow-y-auto text-sm scrollbar scrollbar--vertical",e),children:[n.jsxs(E,{show:i,onClose:()=>{},children:[n.jsxs(E.Main,{children:[(t==null?void 0:t.headline)!=null&&n.jsx(E.Headline,{children:t==null?void 0:t.headline}),(t==null?void 0:t.description)!=null&&n.jsx(E.Description,{children:t==null?void 0:t.description})]}),n.jsxs(E.Actions,{children:[n.jsx(z,{className:"font-bold",size:"md",variant:"danger",onClick:u=>{var c;u.stopPropagation(),(c=t==null?void 0:t.action)==null||c.call(t),h(!1)},children:(t==null?void 0:t.yesText)??"Confirm"}),n.jsx(z,{size:"md",variant:"alternative",onClick:u=>{var c;u.stopPropagation(),(c=t==null?void 0:t.cancel)==null||c.call(t),h(!1)},children:(t==null?void 0:t.noText)??"Cancel"})]})]}),l!=null&&n.jsx(V,{directory:l,setConfirmation:o})]})}export{$e as default};
