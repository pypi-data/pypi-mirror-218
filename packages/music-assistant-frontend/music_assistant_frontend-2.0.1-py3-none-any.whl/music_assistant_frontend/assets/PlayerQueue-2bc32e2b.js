import{l as Y,J as Z,I as Q,r as M,c as k,o as ee,O as n,a6 as D,b as te,B as $,w as le,q as d,y as U,j as a,x as u,K as V,N as r,v as f,L as p,M as _,k as J,A as h,ap as T,S as ae}from"./index-80bdb4d5.js";import{_ as ue,s as ie}from"./ListviewItem.vue_vue_type_script_setup_true_lang-c34985e5.js";import{t as oe}from"./MediaItemThumb.vue_vue_type_style_index_0_lang-3e9c9745.js";import{V as O,a as ne}from"./VTabs-721777a9.js";import{V as P}from"./VAlert-47538902.js";import{V as F}from"./ProviderIcon.vue_vue_type_script_setup_true_lang-eb75f4ac.js";import{V as x,j as g}from"./VBtn-07e57703.js";import{c as se,V as q,a as y,g as re}from"./VCard-0c7966ae.js";import{V as de,b as G}from"./VToolbar-293a25f6.js";import{V as me}from"./VMenu-36bc3785.js";import{V as C}from"./VDivider-a05c2cc4.js";import{V as pe}from"./VDialog-e4104153.js";import"./VCheckboxBtn-cf366fff.js";import"./VLabel-3c22d87a.js";const ve=p("br",null,null,-1),fe={key:0},_e={key:0},ce={key:1},Ae=Y({__name:"PlayerQueue",setup(be){const{t:H}=Z(),B=Q(),E=M(0),s=M(),I=M(!1),c=M([]),e=k(()=>{if($.selectedPlayer)return n.queues[$.selectedPlayer.active_source]}),W=k(()=>{if(e.value)return e.value.current_item}),N=k(()=>e.value?c.value.slice(e.value.current_index):[]),S=k(()=>e.value?c.value.slice(0,e.value.current_index):[]),X=k(()=>E.value==1?S.value:N.value);ee(()=>{const t=n.subscribe_multi([D.QUEUE_UPDATED,D.QUEUE_ITEMS_UPDATED],l=>{var w;l.object_id==((w=e.value)==null?void 0:w.queue_id)&&(l.event==D.QUEUE_ITEMS_UPDATED?j():R())});te(t)});const j=async function(){e.value?($.topBarTitle=e.value.display_name,c.value=[],await n.getPlayerQueueItems(e.value.queue_id,t=>{console.log("chunk",t.length),c.value.push(...t)})):($.topBarTitle=void 0,c.value=[])},z=function(t){s.value=t,I.value=!0},L=function(t){A(),B.push({name:t.media_type,params:{itemId:t.item_id,provider:t.provider}})},b=function(t,l){A(),!(!t||!e.value)&&(l=="play_now"?n.queueCommandPlayIndex(e==null?void 0:e.value.queue_id,t.queue_item_id):l=="move_next"?n.queueCommandMoveNext(e==null?void 0:e.value.queue_id,t.queue_item_id):l=="up"?n.queueCommandMoveUp(e==null?void 0:e.value.queue_id,t.queue_item_id):l=="down"?n.queueCommandMoveDown(e==null?void 0:e.value.queue_id,t.queue_item_id):l=="delete"&&n.queueCommandDelete(e==null?void 0:e.value.queue_id,t.queue_item_id))},R=function(){$.topBarContextMenuItems=[{label:"settings.player_settings",labelArgs:[],action:()=>{B.push(`/settings/editplayer/${e.value.queue_id}`)},icon:"mdi-cog-outline"},{label:"queue_clear",labelArgs:[],action:()=>{n.queueCommandClear(e.value.queue_id)},icon:"mdi-cancel"},{label:e.value.shuffle_enabled?"shuffle_enabled":"shuffle_disabled",labelArgs:[],action:()=>{n.queueCommandShuffleToggle(e.value.queue_id)},icon:e.value.shuffle_enabled?"mdi-shuffle":"mdi-shuffle-disabled"},{label:"repeat_mode",labelArgs:[H(`repeatmode.${e.value.repeat_mode}`)],action:()=>{n.queueCommandRepeatToggle(e.value.queue_id)},icon:e.value.shuffle_enabled?"mdi-repeat":"mdi-repeat-off"},{label:e.value.crossfade_enabled?"crossfade_enabled":"crossfade_disabled",labelArgs:[],action:()=>{n.queueCommandCrossfadeToggle(e.value.queue_id)},icon:e.value.crossfade_enabled?"mdi-swap-horizontal-bold":"mdi-swap-horizontal"}]},A=function(){s.value=void 0,I.value=!1};return le(()=>e.value,t=>{t&&(j(),R())},{immediate:!0}),(t,l)=>{var w;return d(),U("section",null,[a(ne,{modelValue:E.value,"onUpdate:modelValue":l[0]||(l[0]=i=>E.value=i),"show-arrows":"",grow:""},{default:u(()=>[a(O,{value:0},{default:u(()=>[V(r(t.$t("queue_next_items")+" ("+N.value.length+")"),1)]),_:1}),a(O,{value:1},{default:u(()=>[V(r(t.$t("queue_previous_items")+" ("+S.value.length+")"),1)]),_:1})]),_:1},8,["modelValue"]),e.value&&((w=e.value)==null?void 0:w.radio_source.length)>0?(d(),f(P,{key:0,color:"primary",theme:"dark",icon:"mdi-radio-tower",prominent:"",style:{"margin-right":"10px"}},{default:u(()=>{var i,m,o,v;return[p("b",null,r(t.$t("queue_radio_enabled")),1),ve,V(" "+r(t.$t("queue_radio_based_on",[t.$t((i=e.value)==null?void 0:i.radio_source[0].media_type)]))+" ",1),p("b",null,[p("a",{onClick:l[1]||(l[1]=ge=>{var K;return e.value?L((K=e.value)==null?void 0:K.radio_source[0]):""})},r((m=e.value)==null?void 0:m.radio_source[0].name),1)]),((o=e.value)==null?void 0:o.radio_source.length)>1?(d(),U("span",fe," (+"+r(((v=e.value)==null?void 0:v.radio_source.length)-1)+")",1)):_("",!0)]}),_:1})):_("",!0),a(h(ie),{items:X.value,"item-size":60,"key-field":"queue_item_id","page-mode":""},{default:u(({item:i})=>{var m;return[(d(),f(ue,{key:i.uri,item:i.media_item,"show-disc-number":!1,"show-track-number":!1,"show-duration":!0,"show-library":!0,"show-menu":!0,"show-providers":!1,"show-album":!1,"show-checkboxes":!1,"is-selected":!1,"show-details":!1,"parent-item":i,"is-disabled":i.queue_item_id==((m=W.value)==null?void 0:m.queue_item_id),ripple:"",onMenu:o=>z(i),onClick:o=>b(i,"play_now"),onContextmenu:T(o=>z(i),["right","prevent"])},{append:u(()=>[t.$vuetify.display.mobile?_("",!0):(d(),U("div",_e,[a(F,{location:"bottom"},{activator:u(({props:o})=>[a(x,J({variant:"plain",ripple:""},o,{icon:"mdi-arrow-up",onClick:[v=>h(n).queueCommandMoveUp(e.value.queue_id,i.queue_item_id),l[2]||(l[2]=T(()=>{},["prevent"])),l[3]||(l[3]=T(()=>{},["stop"]))]}),null,16,["onClick"])]),default:u(()=>[p("span",null,r(t.$t("queue_move_up")),1)]),_:2},1024)])),t.$vuetify.display.mobile?_("",!0):(d(),U("div",ce,[a(F,{location:"bottom"},{activator:u(({props:o})=>[a(x,J({variant:"plain",ripple:""},o,{icon:"mdi-arrow-down",onClick:[v=>h(n).queueCommandMoveDown(e.value.queue_id,i.queue_item_id),l[4]||(l[4]=T(()=>{},["prevent"])),l[5]||(l[5]=T(()=>{},["stop"]))]}),null,16,["onClick"])]),default:u(()=>[p("span",null,r(t.$t("queue_move_down")),1)]),_:2},1024)]))]),_:2},1032,["item","parent-item","is-disabled","onMenu","onClick","onContextmenu"]))]}),_:1},8,["items"]),c.value.length==0?(d(),f(P,{key:1,type:"info",style:{margin:"20px"}},{default:u(()=>[V(r(t.$t("no_content")),1)]),_:1})):_("",!0),a(pe,{modelValue:I.value,"onUpdate:modelValue":l[13]||(l[13]=i=>I.value=i),fullscreen:t.$vuetify.display.mobile,"min-height":"80%",scrim:!0},{default:u(()=>[a(se,null,{default:u(()=>[a(de,{sense:"",dark:"",color:"primary"},{default:u(()=>[a(x,{icon:"mdi-play-circle-outline"}),s.value?(d(),f(G,{key:0,style:{"padding-left":"10px"}},{default:u(()=>{var i;return[p("b",null,r(h(oe)(((i=s.value)==null?void 0:i.name)||"",t.$vuetify.display.mobile?20:150)),1)]}),_:1})):(d(),f(G,{key:1,style:{"padding-left":"10px"}},{default:u(()=>{var i;return[p("b",null,r(t.$t("settings")),1),V(" | "+r((i=e.value)==null?void 0:i.display_name),1)]}),_:1})),a(x,{icon:"mdi-close",dark:"",onClick:l[6]||(l[6]=i=>A())})]),_:1}),s.value?(d(),f(re,{key:0},{default:u(()=>[a(me,null,{default:u(()=>{var i,m;return[a(q,{class:"list-item-main",title:t.$t("play_now"),onClick:l[7]||(l[7]=o=>b(s.value,"play_now"))},{prepend:u(()=>[a(y,{style:{"padding-right":"10px"}},{default:u(()=>[a(g,{icon:"mdi-play-circle-outline"})]),_:1})]),_:1},8,["title"]),a(C),a(q,{class:"list-item-main",title:t.$t("play_next"),onClick:l[8]||(l[8]=o=>b(s.value,"move_next"))},{prepend:u(()=>[a(y,{style:{"padding-right":"10px"}},{default:u(()=>[a(g,{icon:"mdi-skip-next-circle-outline"})]),_:1})]),_:1},8,["title"]),a(C),a(q,{class:"list-item-main",title:t.$t("queue_move_up"),onClick:l[9]||(l[9]=o=>b(s.value,"up"))},{prepend:u(()=>[a(y,{style:{"padding-right":"10px"}},{default:u(()=>[a(g,{icon:"mdi-arrow-up"})]),_:1})]),_:1},8,["title"]),a(C),a(q,{class:"list-item-main",title:t.$t("queue_move_down"),onClick:l[10]||(l[10]=o=>b(s.value,"down"))},{prepend:u(()=>[a(y,{style:{"padding-right":"10px"}},{default:u(()=>[a(g,{icon:"mdi-arrow-down"})]),_:1})]),_:1},8,["title"]),a(C),a(q,{class:"list-item-main",title:t.$t("queue_delete"),onClick:l[11]||(l[11]=o=>b(s.value,"delete"))},{prepend:u(()=>[a(y,{style:{"padding-right":"10px"}},{default:u(()=>[a(g,{icon:"mdi-delete"})]),_:1})]),_:1},8,["title"]),a(C),((m=(i=s.value)==null?void 0:i.media_item)==null?void 0:m.media_type)==h(ae).TRACK?(d(),f(q,{key:0,class:"list-item-main",title:t.$t("show_info"),onClick:l[12]||(l[12]=o=>{var v;return(v=s.value)!=null&&v.media_item?L(s.value.media_item):""})},{prepend:u(()=>[a(y,{style:{"padding-right":"10px"}},{default:u(()=>[a(g,{icon:"mdi-information-outline"})]),_:1})]),_:1},8,["title"])):_("",!0),a(C)]}),_:1})]),_:1})):_("",!0)]),_:1})]),_:1},8,["modelValue","fullscreen"])])}}});export{Ae as default};
