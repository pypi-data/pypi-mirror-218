{"version":3,"file":"c.963d45e5.js","sources":["../../../../src/compile/compile-dialog.ts"],"sourcesContent":["import { LitElement, html, css } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators.js\";\nimport \"@material/mwc-button\";\nimport \"../components/remote-process\";\nimport \"../components/process-dialog\";\nimport { openCompileDialog } from \".\";\nimport { getDownloadUrl } from \"../api/configuration\";\nimport { esphomeDialogStyles } from \"../styles\";\n\n@customElement(\"esphome-compile-dialog\")\nclass ESPHomeCompileDialog extends LitElement {\n  @property() public configuration!: string;\n\n  @property() public downloadFactoryFirmware = true;\n\n  @state() private _result?: number;\n\n  protected render() {\n    return html`\n      <esphome-process-dialog\n        .heading=${`Download ${this.configuration}`}\n        .type=${\"compile\"}\n        .spawnParams=${{ configuration: this.configuration }}\n        @closed=${this._handleClose}\n        @process-done=${this._handleProcessDone}\n      >\n        ${this._result === undefined\n          ? \"\"\n          : this._result === 0\n          ? html`\n              <a\n                slot=\"secondaryAction\"\n                href=\"${getDownloadUrl(\n                  this.configuration,\n                  this.downloadFactoryFirmware\n                )}\"\n              >\n                <mwc-button label=\"Download\"></mwc-button>\n              </a>\n            `\n          : html`\n              <mwc-button\n                slot=\"secondaryAction\"\n                dialogAction=\"close\"\n                label=\"Retry\"\n                @click=${this._handleRetry}\n              ></mwc-button>\n            `}\n      </esphome-process-dialog>\n    `;\n  }\n\n  private _handleProcessDone(ev: { detail: number }) {\n    this._result = ev.detail;\n\n    if (ev.detail !== 0) {\n      return;\n    }\n\n    const link = document.createElement(\"a\");\n    link.download = this.configuration + \".bin\";\n    link.href = getDownloadUrl(\n      this.configuration,\n      this.downloadFactoryFirmware\n    );\n    document.body.appendChild(link);\n    link.click();\n    link.remove();\n  }\n\n  private _handleRetry() {\n    openCompileDialog(this.configuration, this.downloadFactoryFirmware);\n  }\n\n  private _handleClose() {\n    this.parentNode!.removeChild(this);\n  }\n\n  static styles = [\n    esphomeDialogStyles,\n    css`\n      a {\n        text-decoration: none;\n      }\n    `,\n  ];\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"esphome-compile-dialog\": ESPHomeCompileDialog;\n  }\n}\n"],"names":["ESPHomeCompileDialog","LitElement","constructor","this","downloadFactoryFirmware","render","html","configuration","_handleClose","_handleProcessDone","undefined","_result","getDownloadUrl","_handleRetry","ev","detail","link","document","createElement","download","href","body","appendChild","click","remove","openCompileDialog","parentNode","removeChild","styles","esphomeDialogStyles","css","__decorate","property","prototype","state","customElement"],"mappings":"oRAUA,IAAMA,EAAN,cAAmCC,EAAnCC,kCAGqBC,KAAuBC,yBAAG,CAyE9C,CArEWC,SACR,OAAOC,CAAI;;mBAEI,YAAYH,KAAKI;gBACpB;uBACO,CAAEA,cAAeJ,KAAKI;kBAC3BJ,KAAKK;wBACCL,KAAKM;;eAEFC,IAAjBP,KAAKQ,QACH,GACiB,IAAjBR,KAAKQ,QACLL,CAAI;;;wBAGQM,EACNT,KAAKI,cACLJ,KAAKC;;;;cAMXE,CAAI;;;;;yBAKSH,KAAKU;;;;KAK3B,CAEOJ,mBAAmBK,GAGzB,GAFAX,KAAKQ,QAAUG,EAAGC,OAEA,IAAdD,EAAGC,OACL,OAGF,MAAMC,EAAOC,SAASC,cAAc,KACpCF,EAAKG,SAAWhB,KAAKI,cAAgB,OACrCS,EAAKI,KAAOR,EACVT,KAAKI,cACLJ,KAAKC,yBAEPa,SAASI,KAAKC,YAAYN,GAC1BA,EAAKO,QACLP,EAAKQ,QACN,CAEOX,eACNY,EAAkBtB,KAAKI,cAAeJ,KAAKC,wBAC5C,CAEOI,eACNL,KAAKuB,WAAYC,YAAYxB,KAC9B,GAEMH,EAAA4B,OAAS,CACdC,EACAC,CAAG;;;;OArEcC,EAAA,CAAlBC,KAAyChC,EAAAiC,UAAA,qBAAA,GAEvBF,EAAA,CAAlBC,KAAiDhC,EAAAiC,UAAA,+BAAA,GAEjCF,EAAA,CAAhBG,KAAiClC,EAAAiC,UAAA,eAAA,GAL9BjC,EAAoB+B,EAAA,CADzBI,EAAc,2BACTnC"}